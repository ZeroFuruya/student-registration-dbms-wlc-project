<!DOCTYPE html>
<html>
<head>
  <title>_8ae89d56._.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = ".next/server/chunks/_8ae89d56._.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#sourcemappingurl8ae89d56..js.map">sourceMappingURL=8ae89d56..js.map</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>_8ae89d56._.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-built_in">module</span>.exports=[<span class="hljs-number">64311</span>,e=&gt;{<span class="hljs-string">"use strict"</span>;<span class="hljs-keyword">var</span> t=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e,r</span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params">t=<span class="hljs-built_in">Object</span>.setPrototypeOf||({__proto__:[]}</span>)<span class="hljs-params">instanceof</span> <span class="hljs-params">Array</span>&amp;&amp;<span class="hljs-params">function</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">e</span>.<span class="hljs-params">__proto__</span>=<span class="hljs-params">t</span>}||<span class="hljs-params">function</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> r <span class="hljs-keyword">in</span> t</span>)<span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">hasOwnProperty</span>.<span class="hljs-params">call</span>(<span class="hljs-params">t,r</span>)&amp;&amp;(<span class="hljs-params">e[r]=t[r]</span>)})(<span class="hljs-params">e,r</span>)};<span class="hljs-params">function</span> <span class="hljs-params">r</span>(<span class="hljs-params">e,r</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"function"</span>!=<span class="hljs-keyword">typeof</span> r&amp;&amp;<span class="hljs-literal">null</span>!==r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Class extends value "</span>+<span class="hljs-built_in">String</span>(r</span>)+" <span class="hljs-params">is</span> <span class="hljs-params">not</span> <span class="hljs-params">a</span> <span class="hljs-params">constructor</span> <span class="hljs-params">or</span> <span class="hljs-params">null</span>");<span class="hljs-params">function</span> <span class="hljs-params">s</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">constructor</span>=<span class="hljs-params">e</span>}<span class="hljs-params">t</span>(<span class="hljs-params">e,r</span>),<span class="hljs-params">e</span>.<span class="hljs-params">prototype</span>=<span class="hljs-params">null</span>===<span class="hljs-params">r</span>?<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params">r</span>):(<span class="hljs-params">s.prototype=r.prototype,<span class="hljs-keyword">new</span> s</span>)}<span class="hljs-params">var</span> <span class="hljs-params">s</span>=<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>(<span class="hljs-params">s=<span class="hljs-built_in">Object</span>.assign||<span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> t,r=<span class="hljs-number">1</span>,s=<span class="hljs-built_in">arguments</span>.length;r&lt;s;r++</span>)<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> t=<span class="hljs-built_in">arguments</span>[r]</span>)<span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">hasOwnProperty</span>.<span class="hljs-params">call</span>(<span class="hljs-params">t,i</span>)&amp;&amp;(<span class="hljs-params">e[i]=t[i]</span>);<span class="hljs-params">return</span> <span class="hljs-params">e</span>}).<span class="hljs-params">apply</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span></span>)};<span class="hljs-params">function</span> <span class="hljs-params">i</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>={};<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> s <span class="hljs-keyword">in</span> e</span>)<span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">hasOwnProperty</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e,s</span>)&amp;&amp;0&gt;<span class="hljs-params">t</span>.<span class="hljs-params">indexOf</span>(<span class="hljs-params">s</span>)&amp;&amp;(<span class="hljs-params">r[s]=e[s]</span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>!=e&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Object</span>.getOwnPropertySymbols</span>)<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,s=<span class="hljs-built_in">Object</span>.getOwnPropertySymbols(e</span>);<span class="hljs-params">i</span>&lt;<span class="hljs-params">s</span>.<span class="hljs-params">length</span>;<span class="hljs-params">i</span>++)0&gt;<span class="hljs-params">t</span>.<span class="hljs-params">indexOf</span>(<span class="hljs-params">s[i]</span>)&amp;&amp;<span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">propertyIsEnumerable</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e,s[i]</span>)&amp;&amp;(<span class="hljs-params">r[s[i]]=e[s[i]]</span>);<span class="hljs-params">return</span> <span class="hljs-params">r</span>}<span class="hljs-params">function</span> <span class="hljs-params">n</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">var</span> <span class="hljs-params">i</span>,<span class="hljs-params">n</span>=<span class="hljs-params">arguments</span>.<span class="hljs-params">length</span>,<span class="hljs-params">a</span>=<span class="hljs-params">n</span>&lt;3?<span class="hljs-params">t</span>:<span class="hljs-params">null</span>===<span class="hljs-params">s</span>?<span class="hljs-params">s</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">getOwnPropertyDescriptor</span>(<span class="hljs-params">t,r</span>):<span class="hljs-params">s</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span>&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span>.decorate</span>)<span class="hljs-params">a</span>=<span class="hljs-params">Reflect</span>.<span class="hljs-params">decorate</span>(<span class="hljs-params">e,t,r,s</span>);<span class="hljs-params">else</span> <span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> o=e.length<span class="hljs-number">-1</span>;o&gt;=<span class="hljs-number">0</span>;o--</span>)(<span class="hljs-params">i=e[o]</span>)&amp;&amp;(<span class="hljs-params">a=(n&lt;<span class="hljs-number">3</span>?i(a</span>):<span class="hljs-params">n</span>&gt;3?<span class="hljs-params">i</span>(<span class="hljs-params">t,r,a</span>):<span class="hljs-params">i</span>(<span class="hljs-params">t,r</span>))||<span class="hljs-params">a</span>);<span class="hljs-params">return</span> <span class="hljs-params">n</span>&gt;3&amp;&amp;<span class="hljs-params">a</span>&amp;&amp;<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params">t,r,a</span>),<span class="hljs-params">a</span>}<span class="hljs-params">function</span> <span class="hljs-params">a</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span> <span class="hljs-params">function</span>(<span class="hljs-params">r,s</span>){<span class="hljs-params">t</span>(<span class="hljs-params">r,s,e</span>)}}<span class="hljs-params">function</span> <span class="hljs-params">o</span>(<span class="hljs-params">e,t,r,s,i,n</span>){<span class="hljs-params">function</span> <span class="hljs-params">a</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==e&amp;&amp;<span class="hljs-string">"function"</span>!=<span class="hljs-keyword">typeof</span> e</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Function expected"</span></span>);<span class="hljs-params">return</span> <span class="hljs-params">e</span>}<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> o,l=s.kind,h=<span class="hljs-string">"getter"</span>===l?<span class="hljs-string">"get"</span>:<span class="hljs-string">"setter"</span>===l?<span class="hljs-string">"set"</span>:<span class="hljs-string">"value"</span>,u=!t&amp;&amp;e?s.<span class="hljs-keyword">static</span>?e:e.prototype:<span class="hljs-literal">null</span>,c=t||(u?<span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(u,s.name</span>):{}),<span class="hljs-params">d</span>=!1,<span class="hljs-params">f</span>=<span class="hljs-params">r</span>.<span class="hljs-params">length</span>-1;<span class="hljs-params">f</span>&gt;=0;<span class="hljs-params">f</span>--){<span class="hljs-params">var</span> <span class="hljs-params">p</span>={};<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> g <span class="hljs-keyword">in</span> s</span>)<span class="hljs-params">p</span>[<span class="hljs-params">g</span>]="<span class="hljs-params">access</span>"===<span class="hljs-params">g</span>?{}:<span class="hljs-params">s</span>[<span class="hljs-params">g</span>];<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> g <span class="hljs-keyword">in</span> s.access</span>)<span class="hljs-params">p</span>.<span class="hljs-params">access</span>[<span class="hljs-params">g</span>]=<span class="hljs-params">s</span>.<span class="hljs-params">access</span>[<span class="hljs-params">g</span>];<span class="hljs-params">p</span>.<span class="hljs-params">addInitializer</span>=<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">d</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Cannot add initializers after decoration has completed"</span></span>);<span class="hljs-params">n</span>.<span class="hljs-params">push</span>(<span class="hljs-params">a(e||<span class="hljs-literal">null</span></span>))};<span class="hljs-params">var</span> <span class="hljs-params">y</span>=(<span class="hljs-params"><span class="hljs-number">0</span>,r[f]</span>)(<span class="hljs-params"><span class="hljs-string">"accessor"</span>===l?{get:c.get,set:c.set}:c[h],p</span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"accessor"</span>===l</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===y</span>)<span class="hljs-params">continue</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>===y||<span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> y</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Object expected"</span></span>);(<span class="hljs-params">o=a(y.get</span>))&amp;&amp;(<span class="hljs-params">c.get=o</span>),(<span class="hljs-params">o=a(y.set</span>))&amp;&amp;(<span class="hljs-params">c.set=o</span>),(<span class="hljs-params">o=a(y.init</span>))&amp;&amp;<span class="hljs-params">i</span>.<span class="hljs-params">unshift</span>(<span class="hljs-params">o</span>)}<span class="hljs-params">else</span>(<span class="hljs-params">o=a(y</span>))&amp;&amp;(<span class="hljs-params"><span class="hljs-string">"field"</span>===l?i.unshift(o</span>):<span class="hljs-params">c</span>[<span class="hljs-params">h</span>]=<span class="hljs-params">o</span>)}<span class="hljs-params">u</span>&amp;&amp;<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params">u,s.name,c</span>),<span class="hljs-params">d</span>=!0}<span class="hljs-params">function</span> <span class="hljs-params">l</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> s=<span class="hljs-built_in">arguments</span>.length&gt;<span class="hljs-number">2</span>,i=<span class="hljs-number">0</span>;i&lt;t.length;i++</span>)<span class="hljs-params">r</span>=<span class="hljs-params">s</span>?<span class="hljs-params">t</span>[<span class="hljs-params">i</span>].<span class="hljs-params">call</span>(<span class="hljs-params">e,r</span>):<span class="hljs-params">t</span>[<span class="hljs-params">i</span>].<span class="hljs-params">call</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span> <span class="hljs-params">s</span>?<span class="hljs-params">r</span>:<span class="hljs-params">void</span> 0}<span class="hljs-params">function</span> <span class="hljs-params">h</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">symbol</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>?<span class="hljs-params">e</span>:"".<span class="hljs-params">concat</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">function</span> <span class="hljs-params">u</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>"<span class="hljs-params">symbol</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">t</span>&amp;&amp;(<span class="hljs-params">t=t.description?<span class="hljs-string">"["</span>.concat(t.description,<span class="hljs-string">"]"</span></span>):""),<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params">e,<span class="hljs-string">"name"</span>,{configurable:!<span class="hljs-number">0</span>,value:r?<span class="hljs-string">""</span>.concat(r,<span class="hljs-string">" "</span>,t</span>):<span class="hljs-params">t</span>})}<span class="hljs-params">function</span> <span class="hljs-params">c</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span>&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Reflect</span>.metadata</span>)<span class="hljs-params">return</span> <span class="hljs-params">Reflect</span>.<span class="hljs-params">metadata</span>(<span class="hljs-params">e,t</span>)}<span class="hljs-params">function</span> <span class="hljs-params">d</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span>(<span class="hljs-params">r||(r=<span class="hljs-built_in">Promise</span></span>))(<span class="hljs-params"><span class="hljs-keyword">function</span>(i,n</span>){<span class="hljs-params">function</span> <span class="hljs-params">a</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">l</span>(<span class="hljs-params">s.next(e</span>))}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">n</span>(<span class="hljs-params">e</span>)}}<span class="hljs-params">function</span> <span class="hljs-params">o</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">l</span>(<span class="hljs-params">s.<span class="hljs-keyword">throw</span>(e</span>))}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">n</span>(<span class="hljs-params">e</span>)}}<span class="hljs-params">function</span> <span class="hljs-params">l</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">e</span>.<span class="hljs-params">done</span>?<span class="hljs-params">i</span>(<span class="hljs-params">e.value</span>):(<span class="hljs-params">(t=e.value</span>)<span class="hljs-params">instanceof</span> <span class="hljs-params">r</span>?<span class="hljs-params">t</span>:<span class="hljs-params">new</span> <span class="hljs-params">r</span>(<span class="hljs-params"><span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">e</span>(<span class="hljs-params">t</span>)})).<span class="hljs-params">then</span>(<span class="hljs-params">a,o</span>)}<span class="hljs-params">l</span>(<span class="hljs-params">(s=s.apply(e,t||[]</span>)).<span class="hljs-params">next</span><span class="hljs-params">()</span>)})}<span class="hljs-params">function</span> <span class="hljs-params">f</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>={<span class="hljs-params">label</span>:0,<span class="hljs-params">sent</span>:<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">1</span>&amp;i[<span class="hljs-number">0</span>]</span>)<span class="hljs-params">throw</span> <span class="hljs-params">i</span>[1];<span class="hljs-params">return</span> <span class="hljs-params">i</span>[1]},<span class="hljs-params">trys</span>:[],<span class="hljs-params">ops</span>:[]},<span class="hljs-params">a</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params">(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> Iterator?Iterator:<span class="hljs-built_in">Object</span></span>).<span class="hljs-params">prototype</span>);<span class="hljs-params">return</span> <span class="hljs-params">a</span>.<span class="hljs-params">next</span>=<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-number">0</span></span>),<span class="hljs-params">a</span>.<span class="hljs-params">throw</span>=<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>),<span class="hljs-params">a</span>.<span class="hljs-params">return</span>=<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-number">2</span></span>),"<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">Symbol</span>&amp;&amp;(<span class="hljs-params">a[<span class="hljs-built_in">Symbol</span>.iterator]=<span class="hljs-keyword">function</span>(</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>}),<span class="hljs-params">a</span>;<span class="hljs-params">function</span> <span class="hljs-params">o</span>(<span class="hljs-params">o</span>){<span class="hljs-params">return</span> <span class="hljs-params">function</span>(<span class="hljs-params">l</span>){<span class="hljs-params">var</span> <span class="hljs-params">h</span>=[<span class="hljs-params">o</span>,<span class="hljs-params">l</span>];<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Generator is already executing."</span></span>);<span class="hljs-params">for</span>(<span class="hljs-params">;a&amp;&amp;(a=<span class="hljs-number">0</span>,h[<span class="hljs-number">0</span>]&amp;&amp;(n=<span class="hljs-number">0</span></span>)),<span class="hljs-params">n</span>;)<span class="hljs-params">try</span>{<span class="hljs-params">if</span>(<span class="hljs-params">r=<span class="hljs-number">1</span>,s&amp;&amp;(i=<span class="hljs-number">2</span>&amp;h[<span class="hljs-number">0</span>]?s.<span class="hljs-keyword">return</span>:h[<span class="hljs-number">0</span>]?s.<span class="hljs-keyword">throw</span>||((i=s.<span class="hljs-keyword">return</span></span>)&amp;&amp;<span class="hljs-params">i</span>.<span class="hljs-params">call</span>(<span class="hljs-params">s</span>),0):<span class="hljs-params">s</span>.<span class="hljs-params">next</span>)&amp;&amp;!(<span class="hljs-params">i=i.call(s,h[<span class="hljs-number">1</span>]</span>)).<span class="hljs-params">done</span>)<span class="hljs-params">return</span> <span class="hljs-params">i</span>;<span class="hljs-params">switch</span>(<span class="hljs-params">s=<span class="hljs-number">0</span>,i&amp;&amp;(h=[<span class="hljs-number">2</span>&amp;h[<span class="hljs-number">0</span>],i.value]</span>),<span class="hljs-params">h</span>[0]){<span class="hljs-params">case</span> 0:<span class="hljs-params">case</span> 1:<span class="hljs-params">i</span>=<span class="hljs-params">h</span>;<span class="hljs-params">break</span>;<span class="hljs-params">case</span> 4:<span class="hljs-params">return</span> <span class="hljs-params">n</span>.<span class="hljs-params">label</span>++,{<span class="hljs-params">value</span>:<span class="hljs-params">h</span>[1],<span class="hljs-params">done</span>:!1};<span class="hljs-params">case</span> 5:<span class="hljs-params">n</span>.<span class="hljs-params">label</span>++,<span class="hljs-params">s</span>=<span class="hljs-params">h</span>[1],<span class="hljs-params">h</span>=[0];<span class="hljs-params">continue</span>;<span class="hljs-params">case</span> 7:<span class="hljs-params">h</span>=<span class="hljs-params">n</span>.<span class="hljs-params">ops</span>.<span class="hljs-params">pop</span><span class="hljs-params">()</span>,<span class="hljs-params">n</span>.<span class="hljs-params">trys</span>.<span class="hljs-params">pop</span><span class="hljs-params">()</span>;<span class="hljs-params">continue</span>;<span class="hljs-params">default</span>:<span class="hljs-params">if</span>(<span class="hljs-params">!(i=(i=n.trys</span>).<span class="hljs-params">length</span>&gt;0&amp;&amp;<span class="hljs-params">i</span>[<span class="hljs-params">i</span>.<span class="hljs-params">length</span>-1])&amp;&amp;(<span class="hljs-params"><span class="hljs-number">6</span>===h[<span class="hljs-number">0</span>]||<span class="hljs-number">2</span>===h[<span class="hljs-number">0</span>]</span>)){<span class="hljs-params">n</span>=0;<span class="hljs-params">continue</span>}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">3</span>===h[<span class="hljs-number">0</span>]&amp;&amp;(!i||h[<span class="hljs-number">1</span>]&gt;i[<span class="hljs-number">0</span>]&amp;&amp;h[<span class="hljs-number">1</span>]&lt;i[<span class="hljs-number">3</span>]</span>)){<span class="hljs-params">n</span>.<span class="hljs-params">label</span>=<span class="hljs-params">h</span>[1];<span class="hljs-params">break</span>}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">6</span>===h[<span class="hljs-number">0</span>]&amp;&amp;n.label&lt;i[<span class="hljs-number">1</span>]</span>){<span class="hljs-params">n</span>.<span class="hljs-params">label</span>=<span class="hljs-params">i</span>[1],<span class="hljs-params">i</span>=<span class="hljs-params">h</span>;<span class="hljs-params">break</span>}<span class="hljs-params">if</span>(<span class="hljs-params">i&amp;&amp;n.label&lt;i[<span class="hljs-number">2</span>]</span>){<span class="hljs-params">n</span>.<span class="hljs-params">label</span>=<span class="hljs-params">i</span>[2],<span class="hljs-params">n</span>.<span class="hljs-params">ops</span>.<span class="hljs-params">push</span>(<span class="hljs-params">h</span>);<span class="hljs-params">break</span>}<span class="hljs-params">i</span>[2]&amp;&amp;<span class="hljs-params">n</span>.<span class="hljs-params">ops</span>.<span class="hljs-params">pop</span><span class="hljs-params">()</span>,<span class="hljs-params">n</span>.<span class="hljs-params">trys</span>.<span class="hljs-params">pop</span><span class="hljs-params">()</span>;<span class="hljs-params">continue</span>}<span class="hljs-params">h</span>=<span class="hljs-params">t</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e,n</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">h</span>=[6,<span class="hljs-params">e</span>],<span class="hljs-params">s</span>=0}<span class="hljs-params">finally</span>{<span class="hljs-params">r</span>=<span class="hljs-params">i</span>=0}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">5</span>&amp;h[<span class="hljs-number">0</span>]</span>)<span class="hljs-params">throw</span> <span class="hljs-params">h</span>[1];<span class="hljs-params">return</span>{<span class="hljs-params">value</span>:<span class="hljs-params">h</span>[0]?<span class="hljs-params">h</span>[1]:<span class="hljs-params">void</span> 0,<span class="hljs-params">done</span>:!0}}}}<span class="hljs-params">var</span> <span class="hljs-params">p</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>?<span class="hljs-params">function</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">void</span> 0===<span class="hljs-params">s</span>&amp;&amp;(<span class="hljs-params">s=r</span>);<span class="hljs-params">var</span> <span class="hljs-params">i</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">getOwnPropertyDescriptor</span>(<span class="hljs-params">t,r</span>);(<span class="hljs-params">!i||(<span class="hljs-string">"get"</span><span class="hljs-keyword">in</span> i?!t.__esModule:i.writable||i.configurable</span>))&amp;&amp;(<span class="hljs-params">i={enumerable:!<span class="hljs-number">0</span>,get:<span class="hljs-keyword">function</span>(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>[<span class="hljs-params">r</span>]}}),<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params">e,s,i</span>)}:<span class="hljs-params">function</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">void</span> 0===<span class="hljs-params">s</span>&amp;&amp;(<span class="hljs-params">s=r</span>),<span class="hljs-params">e</span>[<span class="hljs-params">s</span>]=<span class="hljs-params">t</span>[<span class="hljs-params">r</span>]};<span class="hljs-params">function</span> <span class="hljs-params">g</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> r <span class="hljs-keyword">in</span> e</span>)"<span class="hljs-params">default</span>"===<span class="hljs-params">r</span>||<span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">hasOwnProperty</span>.<span class="hljs-params">call</span>(<span class="hljs-params">t,r</span>)||<span class="hljs-params">p</span>(<span class="hljs-params">t,e,r</span>)}<span class="hljs-params">function</span> <span class="hljs-params">y</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>="<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">Symbol</span>&amp;&amp;<span class="hljs-params">Symbol</span>.<span class="hljs-params">iterator</span>,<span class="hljs-params">r</span>=<span class="hljs-params">t</span>&amp;&amp;<span class="hljs-params">e</span>[<span class="hljs-params">t</span>],<span class="hljs-params">s</span>=0;<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">return</span> <span class="hljs-params">r</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">e&amp;&amp;<span class="hljs-string">"number"</span>==<span class="hljs-keyword">typeof</span> e.length</span>)<span class="hljs-params">return</span>{<span class="hljs-params">next</span>:<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">s</span>&gt;=<span class="hljs-params">e</span>.<span class="hljs-params">length</span>&amp;&amp;(<span class="hljs-params">e=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>),{<span class="hljs-params">value</span>:<span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">e</span>[<span class="hljs-params">s</span>++],<span class="hljs-params">done</span>:!<span class="hljs-params">e</span>}}};<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params">t?<span class="hljs-string">"Object is not iterable."</span>:<span class="hljs-string">"Symbol.iterator is not defined."</span></span>)}<span class="hljs-params">function</span> <span class="hljs-params">_</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>="<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">Symbol</span>&amp;&amp;<span class="hljs-params">e</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">iterator</span>];<span class="hljs-params">if</span>(<span class="hljs-params">!r</span>)<span class="hljs-params">return</span> <span class="hljs-params">e</span>;<span class="hljs-params">var</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>=<span class="hljs-params">r</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e</span>),<span class="hljs-params">a</span>=[];<span class="hljs-params">try</span>{<span class="hljs-params">for</span>(<span class="hljs-params">;(<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===t||t-- &gt;<span class="hljs-number">0</span></span>)&amp;&amp;!(<span class="hljs-params">s=n.next(</span>)).<span class="hljs-params">done</span>;)<span class="hljs-params">a</span>.<span class="hljs-params">push</span>(<span class="hljs-params">s.value</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">i</span>={<span class="hljs-params">error</span>:<span class="hljs-params">e</span>}}<span class="hljs-params">finally</span>{<span class="hljs-params">try</span>{<span class="hljs-params">s</span>&amp;&amp;!<span class="hljs-params">s</span>.<span class="hljs-params">done</span>&amp;&amp;(<span class="hljs-params">r=n.<span class="hljs-keyword">return</span></span>)&amp;&amp;<span class="hljs-params">r</span>.<span class="hljs-params">call</span>(<span class="hljs-params">n</span>)}<span class="hljs-params">finally</span>{<span class="hljs-params">if</span>(<span class="hljs-params">i</span>)<span class="hljs-params">throw</span> <span class="hljs-params">i</span>.<span class="hljs-params">error</span>}}<span class="hljs-params">return</span> <span class="hljs-params">a</span>}<span class="hljs-params">function</span> <span class="hljs-params">w</span><span class="hljs-params">()</span>{<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> e=[],t=<span class="hljs-number">0</span>;t&lt;<span class="hljs-built_in">arguments</span>.length;t++</span>)<span class="hljs-params">e</span>=<span class="hljs-params">e</span>.<span class="hljs-params">concat</span>(<span class="hljs-params">_(<span class="hljs-built_in">arguments</span>[t]</span>));<span class="hljs-params">return</span> <span class="hljs-params">e</span>}<span class="hljs-params">function</span> <span class="hljs-params">m</span><span class="hljs-params">()</span>{<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> e=<span class="hljs-number">0</span>,t=<span class="hljs-number">0</span>,r=<span class="hljs-built_in">arguments</span>.length;t&lt;r;t++</span>)<span class="hljs-params">e</span>+=<span class="hljs-params">arguments</span>[<span class="hljs-params">t</span>].<span class="hljs-params">length</span>;<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> s=<span class="hljs-built_in">Array</span>(e</span>),<span class="hljs-params">i</span>=0,<span class="hljs-params">t</span>=0;<span class="hljs-params">t</span>&lt;<span class="hljs-params">r</span>;<span class="hljs-params">t</span>++)<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> n=<span class="hljs-built_in">arguments</span>[t],a=<span class="hljs-number">0</span>,o=n.length;a&lt;o;a++,i++</span>)<span class="hljs-params">s</span>[<span class="hljs-params">i</span>]=<span class="hljs-params">n</span>[<span class="hljs-params">a</span>];<span class="hljs-params">return</span> <span class="hljs-params">s</span>}<span class="hljs-params">function</span> <span class="hljs-params">b</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">if</span>(<span class="hljs-params">r||<span class="hljs-number">2</span>==<span class="hljs-built_in">arguments</span>.length</span>)<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> s,i=<span class="hljs-number">0</span>,n=t.length;i&lt;n;i++</span>)!<span class="hljs-params">s</span>&amp;&amp;<span class="hljs-params">i</span> <span class="hljs-params">in</span> <span class="hljs-params">t</span>||(<span class="hljs-params">s||(s=<span class="hljs-built_in">Array</span>.prototype.slice.call(t,<span class="hljs-number">0</span>,i</span>)),<span class="hljs-params">s</span>[<span class="hljs-params">i</span>]=<span class="hljs-params">t</span>[<span class="hljs-params">i</span>]);<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">concat</span>(<span class="hljs-params">s||<span class="hljs-built_in">Array</span>.prototype.slice.call(t</span>))}<span class="hljs-params">function</span> <span class="hljs-params">v</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">v</span>?(<span class="hljs-params"><span class="hljs-keyword">this</span>.v=e,<span class="hljs-keyword">this</span></span>):<span class="hljs-params">new</span> <span class="hljs-params">v</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">function</span> <span class="hljs-params">S</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!<span class="hljs-built_in">Symbol</span>.asyncIterator</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Symbol.asyncIterator is not defined."</span></span>);<span class="hljs-params">var</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>=<span class="hljs-params">r</span>.<span class="hljs-params">apply</span>(<span class="hljs-params">e,t||[]</span>),<span class="hljs-params">n</span>=[];<span class="hljs-params">return</span> <span class="hljs-params">s</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params">(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> AsyncIterator?AsyncIterator:<span class="hljs-built_in">Object</span></span>).<span class="hljs-params">prototype</span>),<span class="hljs-params">a</span>(<span class="hljs-params"><span class="hljs-string">"next"</span></span>),<span class="hljs-params">a</span>(<span class="hljs-params"><span class="hljs-string">"throw"</span></span>),<span class="hljs-params">a</span>(<span class="hljs-params"><span class="hljs-string">"return"</span>,<span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">return</span> <span class="hljs-params">function</span>(<span class="hljs-params">t</span>){<span class="hljs-params">return</span> <span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span>(<span class="hljs-params">t</span>).<span class="hljs-params">then</span>(<span class="hljs-params">e,h</span>)}}),<span class="hljs-params">s</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">asyncIterator</span>]=<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>},<span class="hljs-params">s</span>;<span class="hljs-params">function</span> <span class="hljs-params">a</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">i</span>[<span class="hljs-params">e</span>]&amp;&amp;(<span class="hljs-params">s[e]=<span class="hljs-keyword">function</span>(t</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Promise</span>(<span class="hljs-params"><span class="hljs-keyword">function</span>(r,s</span>){<span class="hljs-params">n</span>.<span class="hljs-params">push</span>(<span class="hljs-params">[e,t,r,s]</span>)&gt;1||<span class="hljs-params">o</span>(<span class="hljs-params">e,t</span>)})},<span class="hljs-params">t</span>&amp;&amp;(<span class="hljs-params">s[e]=t(s[e]</span>)))}<span class="hljs-params">function</span> <span class="hljs-params">o</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">try</span>{<span class="hljs-params">var</span> <span class="hljs-params">r</span>;(<span class="hljs-params">r=i[e](t</span>)).<span class="hljs-params">value</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">v</span>?<span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span>(<span class="hljs-params">r.value.v</span>).<span class="hljs-params">then</span>(<span class="hljs-params">l,h</span>):<span class="hljs-params">u</span>(<span class="hljs-params">n[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>],r</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">u</span>(<span class="hljs-params">n[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>],e</span>)}}<span class="hljs-params">function</span> <span class="hljs-params">l</span>(<span class="hljs-params">e</span>){<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-string">"next"</span>,e</span>)}<span class="hljs-params">function</span> <span class="hljs-params">h</span>(<span class="hljs-params">e</span>){<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-string">"throw"</span>,e</span>)}<span class="hljs-params">function</span> <span class="hljs-params">u</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">e</span>(<span class="hljs-params">t</span>),<span class="hljs-params">n</span>.<span class="hljs-params">shift</span><span class="hljs-params">()</span>,<span class="hljs-params">n</span>.<span class="hljs-params">length</span>&amp;&amp;<span class="hljs-params">o</span>(<span class="hljs-params">n[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],n[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]</span>)}}<span class="hljs-params">function</span> <span class="hljs-params">k</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>;<span class="hljs-params">return</span> <span class="hljs-params">t</span>={},<span class="hljs-params">s</span>(<span class="hljs-params"><span class="hljs-string">"next"</span></span>),<span class="hljs-params">s</span>(<span class="hljs-params"><span class="hljs-string">"throw"</span>,<span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}),<span class="hljs-params">s</span>(<span class="hljs-params"><span class="hljs-string">"return"</span></span>),<span class="hljs-params">t</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">iterator</span>]=<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>},<span class="hljs-params">t</span>;<span class="hljs-params">function</span> <span class="hljs-params">s</span>(<span class="hljs-params">s,i</span>){<span class="hljs-params">t</span>[<span class="hljs-params">s</span>]=<span class="hljs-params">e</span>[<span class="hljs-params">s</span>]?<span class="hljs-params">function</span>(<span class="hljs-params">t</span>){<span class="hljs-params">return</span>(<span class="hljs-params">r=!r</span>)?{<span class="hljs-params">value</span>:<span class="hljs-params">v</span>(<span class="hljs-params">e[s](t</span>)),<span class="hljs-params">done</span>:!1}:<span class="hljs-params">i</span>?<span class="hljs-params">i</span>(<span class="hljs-params">t</span>):<span class="hljs-params">t</span>}:<span class="hljs-params">i</span>}}<span class="hljs-params">function</span> <span class="hljs-params">E</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!<span class="hljs-built_in">Symbol</span>.asyncIterator</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Symbol.asyncIterator is not defined."</span></span>);<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>=<span class="hljs-params">e</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">asyncIterator</span>];<span class="hljs-params">return</span> <span class="hljs-params">r</span>?<span class="hljs-params">r</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e</span>):(<span class="hljs-params">e=y(e</span>),<span class="hljs-params">t</span>={},<span class="hljs-params">s</span>(<span class="hljs-params"><span class="hljs-string">"next"</span></span>),<span class="hljs-params">s</span>(<span class="hljs-params"><span class="hljs-string">"throw"</span></span>),<span class="hljs-params">s</span>(<span class="hljs-params"><span class="hljs-string">"return"</span></span>),<span class="hljs-params">t</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">asyncIterator</span>]=<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>},<span class="hljs-params">t</span>);<span class="hljs-params">function</span> <span class="hljs-params">s</span>(<span class="hljs-params">r</span>){<span class="hljs-params">t</span>[<span class="hljs-params">r</span>]=<span class="hljs-params">e</span>[<span class="hljs-params">r</span>]&amp;&amp;<span class="hljs-params">function</span>(<span class="hljs-params">t</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Promise</span>(<span class="hljs-params"><span class="hljs-keyword">function</span>(s,i</span>){<span class="hljs-params">var</span> <span class="hljs-params">n</span>,<span class="hljs-params">a</span>,<span class="hljs-params">o</span>;<span class="hljs-params">n</span>=<span class="hljs-params">s</span>,<span class="hljs-params">a</span>=<span class="hljs-params">i</span>,<span class="hljs-params">o</span>=(<span class="hljs-params">t=e[r](t</span>)).<span class="hljs-params">done</span>,<span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span>(<span class="hljs-params">t.value</span>).<span class="hljs-params">then</span>(<span class="hljs-params"><span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">n</span>(<span class="hljs-params">{value:e,done:o}</span>)},<span class="hljs-params">a</span>)})}}}<span class="hljs-params">function</span> <span class="hljs-params">O</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span> <span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>?<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params">e,<span class="hljs-string">"raw"</span>,{value:t}</span>):<span class="hljs-params">e</span>.<span class="hljs-params">raw</span>=<span class="hljs-params">t</span>,<span class="hljs-params">e</span>}<span class="hljs-params">var</span> <span class="hljs-params">T</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>?<span class="hljs-params">function</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params">e,<span class="hljs-string">"default"</span>,{enumerable:!<span class="hljs-number">0</span>,value:t}</span>)}:<span class="hljs-params">function</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">e</span>.<span class="hljs-params">default</span>=<span class="hljs-params">t</span>},<span class="hljs-params">j</span>=<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params">j=<span class="hljs-built_in">Object</span>.getOwnPropertyNames||<span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>=[];<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> r <span class="hljs-keyword">in</span> e</span>)<span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">hasOwnProperty</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e,r</span>)&amp;&amp;(<span class="hljs-params">t[t.length]=r</span>);<span class="hljs-params">return</span> <span class="hljs-params">t</span>})(<span class="hljs-params">e</span>)};<span class="hljs-params">function</span> <span class="hljs-params">R</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">e&amp;&amp;e.__esModule</span>)<span class="hljs-params">return</span> <span class="hljs-params">e</span>;<span class="hljs-params">var</span> <span class="hljs-params">t</span>={};<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>!=e</span>)<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">var</span> r=j(e</span>),<span class="hljs-params">s</span>=0;<span class="hljs-params">s</span>&lt;<span class="hljs-params">r</span>.<span class="hljs-params">length</span>;<span class="hljs-params">s</span>++)"<span class="hljs-params">default</span>"!==<span class="hljs-params">r</span>[<span class="hljs-params">s</span>]&amp;&amp;<span class="hljs-params">p</span>(<span class="hljs-params">t,e,r[s]</span>);<span class="hljs-params">return</span> <span class="hljs-params">T</span>(<span class="hljs-params">t,e</span>),<span class="hljs-params">t</span>}<span class="hljs-params">function</span> <span class="hljs-params">A</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">__esModule</span>?<span class="hljs-params">e</span>:{<span class="hljs-params">default</span>:<span class="hljs-params">e</span>}}<span class="hljs-params">function</span> <span class="hljs-params">P</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"a"</span>===r&amp;&amp;!s</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Private accessor was defined without a getter"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> t?e!==t||!s:!t.has(e</span>))<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Cannot read private member from an object whose class did not declare it"</span></span>);<span class="hljs-params">return</span>"<span class="hljs-params">m</span>"===<span class="hljs-params">r</span>?<span class="hljs-params">s</span>:"<span class="hljs-params">a</span>"===<span class="hljs-params">r</span>?<span class="hljs-params">s</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e</span>):<span class="hljs-params">s</span>?<span class="hljs-params">s</span>.<span class="hljs-params">value</span>:<span class="hljs-params">t</span>.<span class="hljs-params">get</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">function</span> <span class="hljs-params">I</span>(<span class="hljs-params">e,t,r,s,i</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"m"</span>===s</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Private method is not writable"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"a"</span>===s&amp;&amp;!i</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Private accessor was defined without a setter"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> t?e!==t||!i:!t.has(e</span>))<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Cannot write private member to an object whose class did not declare it"</span></span>);<span class="hljs-params">return</span>"<span class="hljs-params">a</span>"===<span class="hljs-params">s</span>?<span class="hljs-params">i</span>.<span class="hljs-params">call</span>(<span class="hljs-params">e,r</span>):<span class="hljs-params">i</span>?<span class="hljs-params">i</span>.<span class="hljs-params">value</span>=<span class="hljs-params">r</span>:<span class="hljs-params">t</span>.<span class="hljs-params">set</span>(<span class="hljs-params">e,r</span>),<span class="hljs-params">r</span>}<span class="hljs-params">function</span> <span class="hljs-params">$</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>===t||<span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> t&amp;&amp;<span class="hljs-string">"function"</span>!=<span class="hljs-keyword">typeof</span> t</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Cannot use 'in' operator on non-object"</span></span>);<span class="hljs-params">return</span>"<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>?<span class="hljs-params">t</span>===<span class="hljs-params">e</span>:<span class="hljs-params">e</span>.<span class="hljs-params">has</span>(<span class="hljs-params">t</span>)}<span class="hljs-params">function</span> <span class="hljs-params">C</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>!=t</span>){<span class="hljs-params">var</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> t&amp;&amp;<span class="hljs-string">"function"</span>!=<span class="hljs-keyword">typeof</span> t</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Object expected."</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params">r</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!<span class="hljs-built_in">Symbol</span>.asyncDispose</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Symbol.asyncDispose is not defined."</span></span>);<span class="hljs-params">s</span>=<span class="hljs-params">t</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">asyncDispose</span>]}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===s</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!<span class="hljs-built_in">Symbol</span>.dispose</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Symbol.dispose is not defined."</span></span>);<span class="hljs-params">s</span>=<span class="hljs-params">t</span>[<span class="hljs-params">Symbol</span>.<span class="hljs-params">dispose</span>],<span class="hljs-params">r</span>&amp;&amp;(<span class="hljs-params">i=s</span>)}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"function"</span>!=<span class="hljs-keyword">typeof</span> s</span>)<span class="hljs-params">throw</span> <span class="hljs-params">TypeError</span>(<span class="hljs-params"><span class="hljs-string">"Object not disposable."</span></span>);<span class="hljs-params">i</span>&amp;&amp;(<span class="hljs-params">s=<span class="hljs-keyword">function</span>(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">i</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">Promise</span>.<span class="hljs-params">reject</span>(<span class="hljs-params">e</span>)}}),<span class="hljs-params">e</span>.<span class="hljs-params">stack</span>.<span class="hljs-params">push</span>(<span class="hljs-params">{value:t,dispose:s,<span class="hljs-keyword">async</span>:r}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">r</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">stack</span>.<span class="hljs-params">push</span>(<span class="hljs-params">{<span class="hljs-keyword">async</span>:!<span class="hljs-number">0</span>}</span>);<span class="hljs-params">return</span> <span class="hljs-params">t</span>}<span class="hljs-params">var</span> <span class="hljs-params">x</span>="<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">SuppressedError</span>?<span class="hljs-params">SuppressedError</span>:<span class="hljs-params">function</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">var</span> <span class="hljs-params">s</span>=<span class="hljs-params">Error</span>(<span class="hljs-params">r</span>);<span class="hljs-params">return</span> <span class="hljs-params">s</span>.<span class="hljs-params">name</span>="<span class="hljs-params">SuppressedError</span>",<span class="hljs-params">s</span>.<span class="hljs-params">error</span>=<span class="hljs-params">e</span>,<span class="hljs-params">s</span>.<span class="hljs-params">suppressed</span>=<span class="hljs-params">t</span>,<span class="hljs-params">s</span>};<span class="hljs-params">function</span> <span class="hljs-params">U</span>(<span class="hljs-params">e</span>){<span class="hljs-params">function</span> <span class="hljs-params">t</span>(<span class="hljs-params">t</span>){<span class="hljs-params">e</span>.<span class="hljs-params">error</span>=<span class="hljs-params">e</span>.<span class="hljs-params">hasError</span>?<span class="hljs-params">new</span> <span class="hljs-params">x</span>(<span class="hljs-params">t,e.error,<span class="hljs-string">"An error was suppressed during disposal."</span></span>):<span class="hljs-params">t</span>,<span class="hljs-params">e</span>.<span class="hljs-params">hasError</span>=!0}<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>=0;<span class="hljs-params">return</span> <span class="hljs-params">function</span> <span class="hljs-params">i</span><span class="hljs-params">()</span>{<span class="hljs-params">for</span>(<span class="hljs-params">;r=e.stack.pop(</span>);)<span class="hljs-params">try</span>{<span class="hljs-params">if</span>(<span class="hljs-params">!r.<span class="hljs-keyword">async</span>&amp;&amp;<span class="hljs-number">1</span>===s</span>)<span class="hljs-params">return</span> <span class="hljs-params">s</span>=0,<span class="hljs-params">e</span>.<span class="hljs-params">stack</span>.<span class="hljs-params">push</span>(<span class="hljs-params">r</span>),<span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">i</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r.dispose</span>){<span class="hljs-params">var</span> <span class="hljs-params">n</span>=<span class="hljs-params">r</span>.<span class="hljs-params">dispose</span>.<span class="hljs-params">call</span>(<span class="hljs-params">r.value</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r.<span class="hljs-keyword">async</span></span>)<span class="hljs-params">return</span> <span class="hljs-params">s</span>|=2,<span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span>(<span class="hljs-params">n</span>).<span class="hljs-params">then</span>(<span class="hljs-params">i,<span class="hljs-keyword">function</span>(e</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>(<span class="hljs-params">e</span>),<span class="hljs-params">i</span><span class="hljs-params">()</span>})}<span class="hljs-params">else</span> <span class="hljs-params">s</span>|=1}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">t</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">1</span>===s</span>)<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">hasError</span>?<span class="hljs-params">Promise</span>.<span class="hljs-params">reject</span>(<span class="hljs-params">e.error</span>):<span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">e.hasError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>.<span class="hljs-params">error</span>}<span class="hljs-params">()</span>}<span class="hljs-params">function</span> <span class="hljs-params">N</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span>"<span class="hljs-params">string</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>&amp;&amp;/^\.\.?\//.<span class="hljs-params">test</span>(<span class="hljs-params">e</span>)?<span class="hljs-params">e</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i</span>,<span class="hljs-keyword">function</span>(e,r,s,i,n</span>){<span class="hljs-params">return</span> <span class="hljs-params">r</span>?<span class="hljs-params">t</span>?".<span class="hljs-params">jsx</span>":".<span class="hljs-params">js</span>":!<span class="hljs-params">s</span>||<span class="hljs-params">i</span>&amp;&amp;<span class="hljs-params">n</span>?<span class="hljs-params">s</span>+<span class="hljs-params">i</span>+"."+<span class="hljs-params">n</span>.<span class="hljs-params">toLowerCase</span><span class="hljs-params">()</span>+"<span class="hljs-params">js</span>":<span class="hljs-params">e</span>}):<span class="hljs-params">e</span>}<span class="hljs-params">let</span> <span class="hljs-params">D</span>={<span class="hljs-params">__extends</span>:<span class="hljs-params">r</span>,<span class="hljs-params">__assign</span>:<span class="hljs-params">s</span>,<span class="hljs-params">__rest</span>:<span class="hljs-params">i</span>,<span class="hljs-params">__decorate</span>:<span class="hljs-params">n</span>,<span class="hljs-params">__param</span>:<span class="hljs-params">a</span>,<span class="hljs-params">__esDecorate</span>:<span class="hljs-params">o</span>,<span class="hljs-params">__runInitializers</span>:<span class="hljs-params">l</span>,<span class="hljs-params">__propKey</span>:<span class="hljs-params">h</span>,<span class="hljs-params">__setFunctionName</span>:<span class="hljs-params">u</span>,<span class="hljs-params">__metadata</span>:<span class="hljs-params">c</span>,<span class="hljs-params">__awaiter</span>:<span class="hljs-params">d</span>,<span class="hljs-params">__generator</span>:<span class="hljs-params">f</span>,<span class="hljs-params">__createBinding</span>:<span class="hljs-params">p</span>,<span class="hljs-params">__exportStar</span>:<span class="hljs-params">g</span>,<span class="hljs-params">__values</span>:<span class="hljs-params">y</span>,<span class="hljs-params">__read</span>:<span class="hljs-params">_</span>,<span class="hljs-params">__spread</span>:<span class="hljs-params">w</span>,<span class="hljs-params">__spreadArrays</span>:<span class="hljs-params">m</span>,<span class="hljs-params">__spreadArray</span>:<span class="hljs-params">b</span>,<span class="hljs-params">__await</span>:<span class="hljs-params">v</span>,<span class="hljs-params">__asyncGenerator</span>:<span class="hljs-params">S</span>,<span class="hljs-params">__asyncDelegator</span>:<span class="hljs-params">k</span>,<span class="hljs-params">__asyncValues</span>:<span class="hljs-params">E</span>,<span class="hljs-params">__makeTemplateObject</span>:<span class="hljs-params">O</span>,<span class="hljs-params">__importStar</span>:<span class="hljs-params">R</span>,<span class="hljs-params">__importDefault</span>:<span class="hljs-params">A</span>,<span class="hljs-params">__classPrivateFieldGet</span>:<span class="hljs-params">P</span>,<span class="hljs-params">__classPrivateFieldSet</span>:<span class="hljs-params">I</span>,<span class="hljs-params">__classPrivateFieldIn</span>:<span class="hljs-params">$</span>,<span class="hljs-params">__addDisposableResource</span>:<span class="hljs-params">C</span>,<span class="hljs-params">__disposeResources</span>:<span class="hljs-params">U</span>,<span class="hljs-params">__rewriteRelativeImportExtension</span>:<span class="hljs-params">N</span>};<span class="hljs-params">e</span>.<span class="hljs-params">s</span>(<span class="hljs-params">[<span class="hljs-string">"__addDisposableResource"</span>,(</span>)=&gt;</span>C,<span class="hljs-string">"__assign"</span>,()=&gt;s,<span class="hljs-string">"__asyncDelegator"</span>,()=&gt;k,<span class="hljs-string">"__asyncGenerator"</span>,()=&gt;S,<span class="hljs-string">"__asyncValues"</span>,()=&gt;E,<span class="hljs-string">"__await"</span>,()=&gt;v,<span class="hljs-string">"__awaiter"</span>,()=&gt;d,<span class="hljs-string">"__classPrivateFieldGet"</span>,()=&gt;P,<span class="hljs-string">"__classPrivateFieldIn"</span>,()=&gt;$,<span class="hljs-string">"__classPrivateFieldSet"</span>,()=&gt;I,<span class="hljs-string">"__createBinding"</span>,()=&gt;p,<span class="hljs-string">"__decorate"</span>,()=&gt;n,<span class="hljs-string">"__disposeResources"</span>,()=&gt;U,<span class="hljs-string">"__esDecorate"</span>,()=&gt;o,<span class="hljs-string">"__exportStar"</span>,()=&gt;g,<span class="hljs-string">"__extends"</span>,()=&gt;r,<span class="hljs-string">"__generator"</span>,()=&gt;f,<span class="hljs-string">"__importDefault"</span>,()=&gt;A,<span class="hljs-string">"__importStar"</span>,()=&gt;R,<span class="hljs-string">"__makeTemplateObject"</span>,()=&gt;O,<span class="hljs-string">"__metadata"</span>,()=&gt;c,<span class="hljs-string">"__param"</span>,()=&gt;a,<span class="hljs-string">"__propKey"</span>,()=&gt;h,<span class="hljs-string">"__read"</span>,()=&gt;_,<span class="hljs-string">"__rest"</span>,()=&gt;i,<span class="hljs-string">"__rewriteRelativeImportExtension"</span>,()=&gt;N,<span class="hljs-string">"__runInitializers"</span>,()=&gt;l,<span class="hljs-string">"__setFunctionName"</span>,()=&gt;u,<span class="hljs-string">"__spread"</span>,()=&gt;w,<span class="hljs-string">"__spreadArray"</span>,()=&gt;b,<span class="hljs-string">"__spreadArrays"</span>,()=&gt;m,<span class="hljs-string">"__values"</span>,()=&gt;y,<span class="hljs-string">"default"</span>,<span class="hljs-number">0</span>,D])},<span class="hljs-number">74779</span>,(e,t,r)=&gt;{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>}),r.default=<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">super</span>(e.message),<span class="hljs-keyword">this</span>.name=<span class="hljs-string">"PostgrestError"</span>,<span class="hljs-keyword">this</span>.details=e.details,<span class="hljs-keyword">this</span>.hint=e.hint,<span class="hljs-keyword">this</span>.code=e.code}}},<span class="hljs-number">66558</span>,(e,t,r)=&gt;{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>});<span class="hljs-keyword">let</span> s=e.r(<span class="hljs-number">64311</span>).__importDefault(e.r(<span class="hljs-number">74779</span>));r.default=<span class="hljs-class"><span class="hljs-keyword">class</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">var</span> t,r;<span class="hljs-keyword">this</span>.shouldThrowOnError=!<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.method=e.method,<span class="hljs-keyword">this</span>.url=e.url,<span class="hljs-keyword">this</span>.headers=<span class="hljs-keyword">new</span> Headers(e.headers),<span class="hljs-keyword">this</span>.schema=e.schema,<span class="hljs-keyword">this</span>.body=e.body,<span class="hljs-keyword">this</span>.shouldThrowOnError=<span class="hljs-literal">null</span>!=(t=e.shouldThrowOnError)&amp;&amp;t,<span class="hljs-keyword">this</span>.signal=e.signal,<span class="hljs-keyword">this</span>.isMaybeSingle=<span class="hljs-literal">null</span>!=(r=e.isMaybeSingle)&amp;&amp;r,e.fetch?<span class="hljs-keyword">this</span>.fetch=e.fetch:<span class="hljs-keyword">this</span>.fetch=fetch}throwOnError(){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.shouldThrowOnError=!<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>}setHeader(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.headers=<span class="hljs-keyword">new</span> Headers(<span class="hljs-keyword">this</span>.headers),<span class="hljs-keyword">this</span>.headers.set(e,t),<span class="hljs-keyword">this</span>}then(e,t){<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===<span class="hljs-keyword">this</span>.schema||([<span class="hljs-string">"GET"</span>,<span class="hljs-string">"HEAD"</span>].includes(<span class="hljs-keyword">this</span>.method)?<span class="hljs-keyword">this</span>.headers.set(<span class="hljs-string">"Accept-Profile"</span>,<span class="hljs-keyword">this</span>.schema):<span class="hljs-keyword">this</span>.headers.set(<span class="hljs-string">"Content-Profile"</span>,<span class="hljs-keyword">this</span>.schema)),<span class="hljs-string">"GET"</span>!==<span class="hljs-keyword">this</span>.method&amp;&amp;<span class="hljs-string">"HEAD"</span>!==<span class="hljs-keyword">this</span>.method&amp;&amp;<span class="hljs-keyword">this</span>.headers.set(<span class="hljs-string">"Content-Type"</span>,<span class="hljs-string">"application/json"</span>);<span class="hljs-keyword">let</span> r=(<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.fetch)(<span class="hljs-keyword">this</span>.url.toString(),{<span class="hljs-attr">method</span>:<span class="hljs-keyword">this</span>.method,<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">body</span>:<span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.body),<span class="hljs-attr">signal</span>:<span class="hljs-keyword">this</span>.signal}).then(<span class="hljs-keyword">async</span> e=&gt;{<span class="hljs-keyword">var</span> t,r,i,n;<span class="hljs-keyword">let</span> a=<span class="hljs-literal">null</span>,o=<span class="hljs-literal">null</span>,l=<span class="hljs-literal">null</span>,h=e.status,u=e.statusText;<span class="hljs-keyword">if</span>(e.ok){<span class="hljs-keyword">if</span>(<span class="hljs-string">"HEAD"</span>!==<span class="hljs-keyword">this</span>.method){<span class="hljs-keyword">let</span> r=<span class="hljs-keyword">await</span> e.text();<span class="hljs-string">""</span>===r||(o=<span class="hljs-string">"text/csv"</span>===<span class="hljs-keyword">this</span>.headers.get(<span class="hljs-string">"Accept"</span>)||<span class="hljs-keyword">this</span>.headers.get(<span class="hljs-string">"Accept"</span>)&amp;&amp;(<span class="hljs-literal">null</span>==(t=<span class="hljs-keyword">this</span>.headers.get(<span class="hljs-string">"Accept"</span>))?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.includes(<span class="hljs-string">"application/vnd.pgrst.plan+text"</span>))?r:<span class="hljs-built_in">JSON</span>.parse(r))}<span class="hljs-keyword">let</span> s=<span class="hljs-literal">null</span>==(r=<span class="hljs-keyword">this</span>.headers.get(<span class="hljs-string">"Prefer"</span>))?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.match(<span class="hljs-regexp">/count=(exact|planned|estimated)/</span>),n=<span class="hljs-literal">null</span>==(i=e.headers.get(<span class="hljs-string">"content-range"</span>))?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.split(<span class="hljs-string">"/"</span>);s&amp;&amp;n&amp;&amp;n.length&gt;<span class="hljs-number">1</span>&amp;&amp;(l=<span class="hljs-built_in">parseInt</span>(n[<span class="hljs-number">1</span>])),<span class="hljs-keyword">this</span>.isMaybeSingle&amp;&amp;<span class="hljs-string">"GET"</span>===<span class="hljs-keyword">this</span>.method&amp;&amp;<span class="hljs-built_in">Array</span>.isArray(o)&amp;&amp;(o.length&gt;<span class="hljs-number">1</span>?(a={<span class="hljs-attr">code</span>:<span class="hljs-string">"PGRST116"</span>,<span class="hljs-attr">details</span>:<span class="hljs-string">`Results contain <span class="hljs-subst">${o.length}</span> rows, application/vnd.pgrst.object+json requires 1 row`</span>,<span class="hljs-attr">hint</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">message</span>:<span class="hljs-string">"JSON object requested, multiple (or no) rows returned"</span>},o=<span class="hljs-literal">null</span>,l=<span class="hljs-literal">null</span>,h=<span class="hljs-number">406</span>,u=<span class="hljs-string">"Not Acceptable"</span>):o=<span class="hljs-number">1</span>===o.length?o[<span class="hljs-number">0</span>]:<span class="hljs-literal">null</span>)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">let</span> t=<span class="hljs-keyword">await</span> e.text();<span class="hljs-keyword">try</span>{a=<span class="hljs-built_in">JSON</span>.parse(t),<span class="hljs-built_in">Array</span>.isArray(a)&amp;&amp;<span class="hljs-number">404</span>===e.status&amp;&amp;(o=[],a=<span class="hljs-literal">null</span>,h=<span class="hljs-number">200</span>,u=<span class="hljs-string">"OK"</span>)}<span class="hljs-keyword">catch</span>(r){<span class="hljs-number">404</span>===e.status&amp;&amp;<span class="hljs-string">""</span>===t?(h=<span class="hljs-number">204</span>,u=<span class="hljs-string">"No Content"</span>):a={<span class="hljs-attr">message</span>:t}}<span class="hljs-keyword">if</span>(a&amp;&amp;<span class="hljs-keyword">this</span>.isMaybeSingle&amp;&amp;(<span class="hljs-literal">null</span>==(n=<span class="hljs-literal">null</span>==a?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:a.details)?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.includes(<span class="hljs-string">"0 rows"</span>))&amp;&amp;(a=<span class="hljs-literal">null</span>,h=<span class="hljs-number">200</span>,u=<span class="hljs-string">"OK"</span>),a&amp;&amp;<span class="hljs-keyword">this</span>.shouldThrowOnError)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> s.default(a)}<span class="hljs-keyword">return</span>{<span class="hljs-attr">error</span>:a,<span class="hljs-attr">data</span>:o,<span class="hljs-attr">count</span>:l,<span class="hljs-attr">status</span>:h,<span class="hljs-attr">statusText</span>:u}});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.shouldThrowOnError||(r=r.catch(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">var</span> t,r,s,i,n,a;<span class="hljs-keyword">let</span> o=<span class="hljs-string">""</span>,l=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.cause;<span class="hljs-keyword">if</span>(l){<span class="hljs-keyword">let</span> n=<span class="hljs-literal">null</span>!=(t=<span class="hljs-literal">null</span>==l?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:l.message)?t:<span class="hljs-string">""</span>,a=<span class="hljs-literal">null</span>!=(r=<span class="hljs-literal">null</span>==l?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:l.code)?r:<span class="hljs-string">""</span>;o=<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-literal">null</span>!=(s=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.name)?s:<span class="hljs-string">"FetchError"</span>}</span>: <span class="hljs-subst">${<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.message}</span>

Caused by: <span class="hljs-subst">${<span class="hljs-literal">null</span>!=(i=<span class="hljs-literal">null</span>==l?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:l.name)?i:<span class="hljs-string">"Error"</span>}</span>: <span class="hljs-subst">${n}</span>`</span>,a&amp;&amp;(o+=<span class="hljs-string">` (<span class="hljs-subst">${a}</span>)`</span>),(<span class="hljs-literal">null</span>==l?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:l.stack)&amp;&amp;(o+=<span class="hljs-string">`
<span class="hljs-subst">${l.stack}</span>`</span>)}<span class="hljs-keyword">else</span> o=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">n=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.stack</span>)?<span class="hljs-params">n</span>:"";<span class="hljs-params">return</span>{<span class="hljs-params">error</span>:{<span class="hljs-params">message</span>:`<span class="hljs-params">$</span>{<span class="hljs-params">null</span>!=(<span class="hljs-params">a=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.name</span>)?<span class="hljs-params">a</span>:"<span class="hljs-params">FetchError</span>"}: <span class="hljs-params">$</span>{<span class="hljs-params">null</span>==<span class="hljs-params">e</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">e</span>.<span class="hljs-params">message</span>}`,<span class="hljs-params">details</span>:<span class="hljs-params">o</span>,<span class="hljs-params">hint</span>:"",<span class="hljs-params">code</span>:""},<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">count</span>:<span class="hljs-params">null</span>,<span class="hljs-params">status</span>:0,<span class="hljs-params">statusText</span>:""}})),<span class="hljs-params">r</span>.<span class="hljs-params">then</span>(<span class="hljs-params">e,t</span>)}<span class="hljs-params">returns</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>}<span class="hljs-params">overrideTypes</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>}}},50972,(<span class="hljs-params">e,t,r</span>)=&gt;</span>{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>});<span class="hljs-keyword">let</span> s=e.r(<span class="hljs-number">64311</span>).__importDefault(e.r(<span class="hljs-number">66558</span>));<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">i</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">s</span>.<span class="hljs-title">default</span></span>{select(e){<span class="hljs-keyword">let</span> t=!<span class="hljs-number">1</span>,r=<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>!=e?e:<span class="hljs-string">"*"</span></span>).<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>).<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;<span class="hljs-regexp">/\s/</span>.test(e</span>)&amp;&amp;!<span class="hljs-params">t</span>?"":(<span class="hljs-params"><span class="hljs-string">'"'</span>===e&amp;&amp;(t=!t</span>),<span class="hljs-params">e</span>)).<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>);<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"select"</span>,r</span>),<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">"return=representation"</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">order</span>(<span class="hljs-params">e,{ascending:t=!<span class="hljs-number">0</span>,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}</span>){<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">i</span>?`<span class="hljs-params">$</span>{<span class="hljs-params">i</span>}.<span class="hljs-params">order</span>`:"<span class="hljs-params">order</span>",<span class="hljs-params">a</span>=<span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">get</span>(<span class="hljs-params">n</span>);<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params">n,<span class="hljs-string">`<span class="hljs-subst">${a?<span class="hljs-string">`<span class="hljs-subst">${a}</span>,`</span>:<span class="hljs-string">""</span>}</span><span class="hljs-subst">${e}</span>.<span class="hljs-subst">${t?<span class="hljs-string">"asc"</span>:<span class="hljs-string">"desc"</span>}</span><span class="hljs-subst">${<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===r?<span class="hljs-string">""</span>:r?<span class="hljs-string">".nullsfirst"</span>:<span class="hljs-string">".nullslast"</span>}</span>`</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">limit</span>(<span class="hljs-params">e,{foreignTable:t,referencedTable:r=t}={}</span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">void</span> 0===<span class="hljs-params">r</span>?"<span class="hljs-params">limit</span>":`<span class="hljs-params">$</span>{<span class="hljs-params">r</span>}.<span class="hljs-params">limit</span>`;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params">s,<span class="hljs-string">`<span class="hljs-subst">${e}</span>`</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">range</span>(<span class="hljs-params">e,t,{foreignTable:r,referencedTable:s=r}={}</span>){<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">void</span> 0===<span class="hljs-params">s</span>?"<span class="hljs-params">offset</span>":`<span class="hljs-params">$</span>{<span class="hljs-params">s</span>}.<span class="hljs-params">offset</span>`,<span class="hljs-params">n</span>=<span class="hljs-params">void</span> 0===<span class="hljs-params">s</span>?"<span class="hljs-params">limit</span>":`<span class="hljs-params">$</span>{<span class="hljs-params">s</span>}.<span class="hljs-params">limit</span>`;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params">i,<span class="hljs-string">`<span class="hljs-subst">${e}</span>`</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params">n,<span class="hljs-string">`<span class="hljs-subst">${t-e+<span class="hljs-number">1</span>}</span>`</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">abortSignal</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">signal</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>}<span class="hljs-params">single</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Accept"</span>,<span class="hljs-string">"application/vnd.pgrst.object+json"</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">maybeSingle</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>"<span class="hljs-params">GET</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">method</span>?<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Accept"</span>,<span class="hljs-string">"application/json"</span></span>):<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Accept"</span>,<span class="hljs-string">"application/vnd.pgrst.object+json"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">isMaybeSingle</span>=!0,<span class="hljs-params">this</span>}<span class="hljs-params">csv</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Accept"</span>,<span class="hljs-string">"text/csv"</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">geojson</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Accept"</span>,<span class="hljs-string">"application/geo+json"</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">explain</span>(<span class="hljs-params">{analyze:e=!<span class="hljs-number">1</span>,verbose:t=!<span class="hljs-number">1</span>,settings:r=!<span class="hljs-number">1</span>,buffers:s=!<span class="hljs-number">1</span>,wal:i=!<span class="hljs-number">1</span>,format:n=<span class="hljs-string">"text"</span>}={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">a</span>;<span class="hljs-params">let</span> <span class="hljs-params">o</span>=[<span class="hljs-params">e</span>?"<span class="hljs-params">analyze</span>":<span class="hljs-params">null</span>,<span class="hljs-params">t</span>?"<span class="hljs-params">verbose</span>":<span class="hljs-params">null</span>,<span class="hljs-params">r</span>?"<span class="hljs-params">settings</span>":<span class="hljs-params">null</span>,<span class="hljs-params">s</span>?"<span class="hljs-params">buffers</span>":<span class="hljs-params">null</span>,<span class="hljs-params">i</span>?"<span class="hljs-params">wal</span>":<span class="hljs-params">null</span>].<span class="hljs-params">filter</span>(<span class="hljs-params"><span class="hljs-built_in">Boolean</span></span>).<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">"|"</span></span>),<span class="hljs-params">l</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">a=<span class="hljs-keyword">this</span>.headers.get(<span class="hljs-string">"Accept"</span></span>))?<span class="hljs-params">a</span>:"<span class="hljs-params">application</span>/<span class="hljs-params">json</span>";<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Accept"</span>,<span class="hljs-string">`application/vnd.pgrst.plan+<span class="hljs-subst">${n}</span>; for="<span class="hljs-subst">${l}</span>"; options=<span class="hljs-subst">${o}</span>;`</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">rollback</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">"tx=rollback"</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">returns</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>}<span class="hljs-params">maxAffected</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">"handling=strict"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`max-affected=<span class="hljs-subst">${e}</span>`</span></span>),<span class="hljs-params">this</span>}}<span class="hljs-params">r</span>.<span class="hljs-params">default</span>=<span class="hljs-params">i</span>},78577,(<span class="hljs-params">e,t,r</span>)=&gt;</span>{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>});<span class="hljs-keyword">let</span> s=e.r(<span class="hljs-number">64311</span>).__importDefault(e.r(<span class="hljs-number">50972</span>)),i=<span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"[,()]"</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">n</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">s</span>.<span class="hljs-title">default</span></span>{eq(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`eq.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}neq(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`neq.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}gt(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`gt.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}gte(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`gte.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}lt(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`lt.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}lte(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`lte.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}like(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`like.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}likeAllOf(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`like(all).{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>),<span class="hljs-keyword">this</span>}likeAnyOf(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`like(any).{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>),<span class="hljs-keyword">this</span>}ilike(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`ilike.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}ilikeAllOf(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`ilike(all).{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>),<span class="hljs-keyword">this</span>}ilikeAnyOf(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`ilike(any).{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>),<span class="hljs-keyword">this</span>}is(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`is.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}<span class="hljs-keyword">in</span>(e,t){<span class="hljs-keyword">let</span> r=<span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(t)).map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e&amp;&amp;i.test(e)?<span class="hljs-string">`"<span class="hljs-subst">${e}</span>"`</span>:<span class="hljs-string">`<span class="hljs-subst">${e}</span>`</span>).join(<span class="hljs-string">","</span>);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`in.(<span class="hljs-subst">${r}</span>)`</span>),<span class="hljs-keyword">this</span>}contains(e,t){<span class="hljs-keyword">return</span><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> t?<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`cs.<span class="hljs-subst">${t}</span>`</span>):<span class="hljs-built_in">Array</span>.isArray(t)?<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`cs.{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>):<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`cs.<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(t)}</span>`</span>),<span class="hljs-keyword">this</span>}containedBy(e,t){<span class="hljs-keyword">return</span><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> t?<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`cd.<span class="hljs-subst">${t}</span>`</span>):<span class="hljs-built_in">Array</span>.isArray(t)?<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`cd.{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>):<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`cd.<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(t)}</span>`</span>),<span class="hljs-keyword">this</span>}rangeGt(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`sr.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}rangeGte(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`nxl.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}rangeLt(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`sl.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}rangeLte(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`nxr.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}rangeAdjacent(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`adj.<span class="hljs-subst">${t}</span>`</span>),<span class="hljs-keyword">this</span>}overlaps(e,t){<span class="hljs-keyword">return</span><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> t?<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`ov.<span class="hljs-subst">${t}</span>`</span>):<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`ov.{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>),<span class="hljs-keyword">this</span>}textSearch(e,t,{<span class="hljs-attr">config</span>:r,<span class="hljs-attr">type</span>:s}={}){<span class="hljs-keyword">let</span> i=<span class="hljs-string">""</span>;<span class="hljs-string">"plain"</span>===s?i=<span class="hljs-string">"pl"</span>:<span class="hljs-string">"phrase"</span>===s?i=<span class="hljs-string">"ph"</span>:<span class="hljs-string">"websearch"</span>===s&amp;&amp;<span class="hljs-function">(<span class="hljs-params">i=<span class="hljs-string">"w"</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">void</span> 0===<span class="hljs-params">r</span>?"":`(<span class="hljs-params">${r}</span>)`;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">append</span>(<span class="hljs-params">e,<span class="hljs-string">`<span class="hljs-subst">${i}</span>fts<span class="hljs-subst">${n}</span>.<span class="hljs-subst">${t}</span>`</span></span>),<span class="hljs-params">this</span>}<span class="hljs-params">match</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">Object</span>.<span class="hljs-params">entries</span>(<span class="hljs-params">e</span>).<span class="hljs-params">forEach</span>(<span class="hljs-params">([e,t]</span>)=&gt;</span>{<span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`eq.<span class="hljs-subst">${t}</span>`</span>)}),<span class="hljs-keyword">this</span>}not(e,t,r){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`not.<span class="hljs-subst">${t}</span>.<span class="hljs-subst">${r}</span>`</span>),<span class="hljs-keyword">this</span>}or(e,{<span class="hljs-attr">foreignTable</span>:t,<span class="hljs-attr">referencedTable</span>:r=t}={}){<span class="hljs-keyword">let</span> s=r?<span class="hljs-string">`<span class="hljs-subst">${r}</span>.or`</span>:<span class="hljs-string">"or"</span>;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(s,<span class="hljs-string">`(<span class="hljs-subst">${e}</span>)`</span>),<span class="hljs-keyword">this</span>}filter(e,t,r){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.url.searchParams.append(e,<span class="hljs-string">`<span class="hljs-subst">${t}</span>.<span class="hljs-subst">${r}</span>`</span>),<span class="hljs-keyword">this</span>}}r.default=n},<span class="hljs-number">16643</span>,(e,t,r)=&gt;{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>});<span class="hljs-keyword">let</span> s=e.r(<span class="hljs-number">64311</span>).__importDefault(e.r(<span class="hljs-number">78577</span>));r.default=<span class="hljs-class"><span class="hljs-keyword">class</span></span>{<span class="hljs-keyword">constructor</span>(e,{headers:t={},<span class="hljs-attr">schema</span>:r,<span class="hljs-attr">fetch</span>:s}){<span class="hljs-keyword">this</span>.url=e,<span class="hljs-keyword">this</span>.headers=<span class="hljs-keyword">new</span> Headers(t),<span class="hljs-keyword">this</span>.schema=r,<span class="hljs-keyword">this</span>.fetch=s}select(e,t){<span class="hljs-keyword">let</span>{<span class="hljs-attr">head</span>:r=!<span class="hljs-number">1</span>,<span class="hljs-attr">count</span>:i}=<span class="hljs-literal">null</span>!=t?t:{},n=!<span class="hljs-number">1</span>,a=<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>!=e?e:<span class="hljs-string">"*"</span></span>).<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>).<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;<span class="hljs-regexp">/\s/</span>.test(e</span>)&amp;&amp;!<span class="hljs-params">n</span>?"":(<span class="hljs-params"><span class="hljs-string">'"'</span>===e&amp;&amp;(n=!n</span>),<span class="hljs-params">e</span>)).<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>);<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"select"</span>,a</span>),<span class="hljs-params">i</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`count=<span class="hljs-subst">${i}</span>`</span></span>),<span class="hljs-params">new</span> <span class="hljs-params">s</span>.<span class="hljs-params">default</span>(<span class="hljs-params">{method:r?<span class="hljs-string">"HEAD"</span>:<span class="hljs-string">"GET"</span>,url:<span class="hljs-keyword">this</span>.url,headers:<span class="hljs-keyword">this</span>.headers,schema:<span class="hljs-keyword">this</span>.schema,fetch:<span class="hljs-keyword">this</span>.fetch}</span>)}<span class="hljs-params">insert</span>(<span class="hljs-params">e,{count:t,defaultToNull:r=!<span class="hljs-number">0</span>}={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params">t&amp;&amp;<span class="hljs-keyword">this</span>.headers.append(<span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`count=<span class="hljs-subst">${t}</span>`</span></span>),<span class="hljs-params">r</span>||<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">"missing=default"</span></span>),<span class="hljs-params">Array</span>.<span class="hljs-params">isArray</span>(<span class="hljs-params">e</span>)){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">reduce</span>(<span class="hljs-params">(e,t</span>)=&gt;</span>e.concat(<span class="hljs-built_in">Object</span>.keys(t)),[]);<span class="hljs-keyword">if</span>(t.length&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">let</span> e=[...new <span class="hljs-built_in">Set</span>(t)].map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-string">`"<span class="hljs-subst">${e}</span>"`</span>);<span class="hljs-keyword">this</span>.url.searchParams.set(<span class="hljs-string">"columns"</span>,e.join(<span class="hljs-string">","</span>))}}<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> s.default({<span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-attr">url</span>:<span class="hljs-keyword">this</span>.url,<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">schema</span>:<span class="hljs-keyword">this</span>.schema,<span class="hljs-attr">body</span>:e,<span class="hljs-attr">fetch</span>:<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">i=<span class="hljs-keyword">this</span>.fetch</span>)?<span class="hljs-params">i</span>:<span class="hljs-params">fetch</span>})}<span class="hljs-params">upsert</span>(<span class="hljs-params">e,{onConflict:t,ignoreDuplicates:r=!<span class="hljs-number">1</span>,count:i,defaultToNull:n=!<span class="hljs-number">0</span>}={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">a</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.headers.append(<span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`resolution=<span class="hljs-subst">${r?<span class="hljs-string">"ignore"</span>:<span class="hljs-string">"merge"</span>}</span>-duplicates`</span></span>),<span class="hljs-params">void</span> 0!==<span class="hljs-params">t</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">url</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"on_conflict"</span>,t</span>),<span class="hljs-params">i</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`count=<span class="hljs-subst">${i}</span>`</span></span>),<span class="hljs-params">n</span>||<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">"missing=default"</span></span>),<span class="hljs-params">Array</span>.<span class="hljs-params">isArray</span>(<span class="hljs-params">e</span>)){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">reduce</span>(<span class="hljs-params">(e,t</span>)=&gt;</span>e.concat(<span class="hljs-built_in">Object</span>.keys(t)),[]);<span class="hljs-keyword">if</span>(t.length&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">let</span> e=[...new <span class="hljs-built_in">Set</span>(t)].map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-string">`"<span class="hljs-subst">${e}</span>"`</span>);<span class="hljs-keyword">this</span>.url.searchParams.set(<span class="hljs-string">"columns"</span>,e.join(<span class="hljs-string">","</span>))}}<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> s.default({<span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-attr">url</span>:<span class="hljs-keyword">this</span>.url,<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">schema</span>:<span class="hljs-keyword">this</span>.schema,<span class="hljs-attr">body</span>:e,<span class="hljs-attr">fetch</span>:<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">a=<span class="hljs-keyword">this</span>.fetch</span>)?<span class="hljs-params">a</span>:<span class="hljs-params">fetch</span>})}<span class="hljs-params">update</span>(<span class="hljs-params">e,{count:t}={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>;<span class="hljs-params">return</span> <span class="hljs-params">t</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`count=<span class="hljs-subst">${t}</span>`</span></span>),<span class="hljs-params">new</span> <span class="hljs-params">s</span>.<span class="hljs-params">default</span>(<span class="hljs-params">{method:<span class="hljs-string">"PATCH"</span>,url:<span class="hljs-keyword">this</span>.url,headers:<span class="hljs-keyword">this</span>.headers,schema:<span class="hljs-keyword">this</span>.schema,body:e,fetch:<span class="hljs-literal">null</span>!=(r=<span class="hljs-keyword">this</span>.fetch</span>)?<span class="hljs-params">r</span>:<span class="hljs-params">fetch</span>})}<span class="hljs-params">delete</span>(<span class="hljs-params">{count:e}={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">return</span> <span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`count=<span class="hljs-subst">${e}</span>`</span></span>),<span class="hljs-params">new</span> <span class="hljs-params">s</span>.<span class="hljs-params">default</span>(<span class="hljs-params">{method:<span class="hljs-string">"DELETE"</span>,url:<span class="hljs-keyword">this</span>.url,headers:<span class="hljs-keyword">this</span>.headers,schema:<span class="hljs-keyword">this</span>.schema,fetch:<span class="hljs-literal">null</span>!=(t=<span class="hljs-keyword">this</span>.fetch</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">fetch</span>})}}},25790,(<span class="hljs-params">e,t,r</span>)=&gt;</span>{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>});<span class="hljs-keyword">let</span> s=e.r(<span class="hljs-number">64311</span>),i=s.__importDefault(e.r(<span class="hljs-number">16643</span>)),n=s.__importDefault(e.r(<span class="hljs-number">78577</span>));<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span>{<span class="hljs-keyword">constructor</span>(e,{headers:t={},<span class="hljs-attr">schema</span>:r,<span class="hljs-attr">fetch</span>:s}={}){<span class="hljs-keyword">this</span>.url=e,<span class="hljs-keyword">this</span>.headers=<span class="hljs-keyword">new</span> Headers(t),<span class="hljs-keyword">this</span>.schemaName=r,<span class="hljs-keyword">this</span>.fetch=s}<span class="hljs-keyword">from</span>(e){<span class="hljs-keyword">let</span> t=<span class="hljs-keyword">new</span> URL(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/<span class="hljs-subst">${e}</span>`</span>);<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> i.default(t,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">new</span> Headers(<span class="hljs-keyword">this</span>.headers),<span class="hljs-attr">schema</span>:<span class="hljs-keyword">this</span>.schemaName,<span class="hljs-attr">fetch</span>:<span class="hljs-keyword">this</span>.fetch})}schema(e){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> a(<span class="hljs-keyword">this</span>.url,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">schema</span>:e,<span class="hljs-attr">fetch</span>:<span class="hljs-keyword">this</span>.fetch})}rpc(e,t={},{<span class="hljs-attr">head</span>:r=!<span class="hljs-number">1</span>,<span class="hljs-attr">get</span>:s=!<span class="hljs-number">1</span>,<span class="hljs-attr">count</span>:i}={}){<span class="hljs-keyword">var</span> a;<span class="hljs-keyword">let</span> o,l,h=<span class="hljs-keyword">new</span> URL(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/rpc/<span class="hljs-subst">${e}</span>`</span>);r||s?<span class="hljs-function">(<span class="hljs-params">o=r?<span class="hljs-string">"HEAD"</span>:<span class="hljs-string">"GET"</span>,<span class="hljs-built_in">Object</span>.entries(t</span>).<span class="hljs-params">filter</span>(<span class="hljs-params">([e,t]</span>)=&gt;</span><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==t).map(<span class="hljs-function">(<span class="hljs-params">[e,t]</span>)=&gt;</span>[e,<span class="hljs-built_in">Array</span>.isArray(t)?<span class="hljs-string">`{<span class="hljs-subst">${t.join(<span class="hljs-string">","</span>)}</span>}`</span>:<span class="hljs-string">`<span class="hljs-subst">${t}</span>`</span>]).forEach(<span class="hljs-function">(<span class="hljs-params">[e,t]</span>)=&gt;</span>{h.searchParams.append(e,t)})):<span class="hljs-function">(<span class="hljs-params">o=<span class="hljs-string">"POST"</span>,l=t</span>);<span class="hljs-params">let</span> <span class="hljs-params">u</span>=<span class="hljs-params">new</span> <span class="hljs-params">Headers</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.headers</span>);<span class="hljs-params">return</span> <span class="hljs-params">i</span>&amp;&amp;<span class="hljs-params">u</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Prefer"</span>,<span class="hljs-string">`count=<span class="hljs-subst">${i}</span>`</span></span>),<span class="hljs-params">new</span> <span class="hljs-params">n</span>.<span class="hljs-params">default</span>(<span class="hljs-params">{method:o,url:h,headers:u,schema:<span class="hljs-keyword">this</span>.schemaName,body:l,fetch:<span class="hljs-literal">null</span>!=(a=<span class="hljs-keyword">this</span>.fetch</span>)?<span class="hljs-params">a</span>:<span class="hljs-params">fetch</span>})}}<span class="hljs-params">r</span>.<span class="hljs-params">default</span>=<span class="hljs-params">a</span>},306,(<span class="hljs-params">e,t,r</span>)=&gt;</span>{<span class="hljs-string">"use strict"</span>;<span class="hljs-built_in">Object</span>.defineProperty(r,<span class="hljs-string">"__esModule"</span>,{<span class="hljs-attr">value</span>:!<span class="hljs-number">0</span>}),r.PostgrestError=r.PostgrestBuilder=r.PostgrestTransformBuilder=r.PostgrestFilterBuilder=r.PostgrestQueryBuilder=r.PostgrestClient=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> s=e.r(<span class="hljs-number">64311</span>),i=s.__importDefault(e.r(<span class="hljs-number">25790</span>));r.PostgrestClient=i.default;<span class="hljs-keyword">let</span> n=s.__importDefault(e.r(<span class="hljs-number">16643</span>));r.PostgrestQueryBuilder=n.default;<span class="hljs-keyword">let</span> a=s.__importDefault(e.r(<span class="hljs-number">78577</span>));r.PostgrestFilterBuilder=a.default;<span class="hljs-keyword">let</span> o=s.__importDefault(e.r(<span class="hljs-number">50972</span>));r.PostgrestTransformBuilder=o.default;<span class="hljs-keyword">let</span> l=s.__importDefault(e.r(<span class="hljs-number">66558</span>));r.PostgrestBuilder=l.default;<span class="hljs-keyword">let</span> h=s.__importDefault(e.r(<span class="hljs-number">74779</span>));r.PostgrestError=h.default,r.default={<span class="hljs-attr">PostgrestClient</span>:i.default,<span class="hljs-attr">PostgrestQueryBuilder</span>:n.default,<span class="hljs-attr">PostgrestFilterBuilder</span>:a.default,<span class="hljs-attr">PostgrestTransformBuilder</span>:o.default,<span class="hljs-attr">PostgrestBuilder</span>:l.default,<span class="hljs-attr">PostgrestError</span>:h.default}},<span class="hljs-number">1950</span>,e=&gt;{<span class="hljs-string">"use strict"</span>;<span class="hljs-keyword">let</span> t;<span class="hljs-keyword">var</span> r,s,i,n,a,o,l,h,u,c,d,f,p,g,y,_,w,m,b,v,S,k,E,O,T=e.i(<span class="hljs-number">64311</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">j</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>{<span class="hljs-keyword">constructor</span>(e,t="FunctionsError",r){<span class="hljs-keyword">super</span>(e),<span class="hljs-keyword">this</span>.name=t,<span class="hljs-keyword">this</span>.context=r}}<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">j</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">super</span>(<span class="hljs-string">"Failed to send a request to the Edge Function"</span>,<span class="hljs-string">"FunctionsFetchError"</span>,e)}}<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">j</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">super</span>(<span class="hljs-string">"Relay Error invoking the Edge Function"</span>,<span class="hljs-string">"FunctionsRelayError"</span>,e)}}<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">j</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">super</span>(<span class="hljs-string">"Edge Function returned a non-2xx status code"</span>,<span class="hljs-string">"FunctionsHttpError"</span>,e)}}(r=f||<span class="hljs-function">(<span class="hljs-params">f={}</span>)).<span class="hljs-params">Any</span>="<span class="hljs-params">any</span>",<span class="hljs-params">r</span>.<span class="hljs-params">ApNortheast1</span>="<span class="hljs-params">ap</span>-<span class="hljs-params">northeast</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">ApNortheast2</span>="<span class="hljs-params">ap</span>-<span class="hljs-params">northeast</span>-2",<span class="hljs-params">r</span>.<span class="hljs-params">ApSouth1</span>="<span class="hljs-params">ap</span>-<span class="hljs-params">south</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">ApSoutheast1</span>="<span class="hljs-params">ap</span>-<span class="hljs-params">southeast</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">ApSoutheast2</span>="<span class="hljs-params">ap</span>-<span class="hljs-params">southeast</span>-2",<span class="hljs-params">r</span>.<span class="hljs-params">CaCentral1</span>="<span class="hljs-params">ca</span>-<span class="hljs-params">central</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">EuCentral1</span>="<span class="hljs-params">eu</span>-<span class="hljs-params">central</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">EuWest1</span>="<span class="hljs-params">eu</span>-<span class="hljs-params">west</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">EuWest2</span>="<span class="hljs-params">eu</span>-<span class="hljs-params">west</span>-2",<span class="hljs-params">r</span>.<span class="hljs-params">EuWest3</span>="<span class="hljs-params">eu</span>-<span class="hljs-params">west</span>-3",<span class="hljs-params">r</span>.<span class="hljs-params">SaEast1</span>="<span class="hljs-params">sa</span>-<span class="hljs-params">east</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">UsEast1</span>="<span class="hljs-params">us</span>-<span class="hljs-params">east</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">UsWest1</span>="<span class="hljs-params">us</span>-<span class="hljs-params">west</span>-1",<span class="hljs-params">r</span>.<span class="hljs-params">UsWest2</span>="<span class="hljs-params">us</span>-<span class="hljs-params">west</span>-2";<span class="hljs-params">class</span> <span class="hljs-params">I</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,{headers:t={},customFetch:r,region:s=f.Any}={}</span>){<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">region</span>=<span class="hljs-params">s</span>,<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=(<span class="hljs-params">e=&gt;e?(...t</span>)=&gt;</span>e(...t):<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>fetch(...e))(r)}setAuth(e){<span class="hljs-keyword">this</span>.headers.Authorization=<span class="hljs-string">`Bearer <span class="hljs-subst">${e}</span>`</span>}invoke(e){<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(e,t={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>;<span class="hljs-params">let</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">n</span>,{<span class="hljs-params">headers</span>:<span class="hljs-params">a</span>,<span class="hljs-params">method</span>:<span class="hljs-params">o</span>,<span class="hljs-params">body</span>:<span class="hljs-params">l</span>,<span class="hljs-params">signal</span>:<span class="hljs-params">h</span>,<span class="hljs-params">timeout</span>:<span class="hljs-params">u</span>}=<span class="hljs-params">t</span>,<span class="hljs-params">c</span>={},{<span class="hljs-params">region</span>:<span class="hljs-params">d</span>}=<span class="hljs-params">t</span>;<span class="hljs-params">d</span>||(<span class="hljs-params">d=<span class="hljs-keyword">this</span>.region</span>);<span class="hljs-params">let</span> <span class="hljs-params">f</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/<span class="hljs-subst">${e}</span>`</span></span>);<span class="hljs-params">d</span>&amp;&amp;"<span class="hljs-params">any</span>"!==<span class="hljs-params">d</span>&amp;&amp;(<span class="hljs-params">c[<span class="hljs-string">"x-region"</span>]=d,f.searchParams.set(<span class="hljs-string">"forceFunctionRegion"</span>,d</span>)),<span class="hljs-params">l</span>&amp;&amp;(<span class="hljs-params">a&amp;&amp;!<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(a,<span class="hljs-string">"Content-Type"</span></span>)||!<span class="hljs-params">a</span>)?"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">Blob</span>&amp;&amp;<span class="hljs-params">l</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">Blob</span>||<span class="hljs-params">l</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">ArrayBuffer</span>?(<span class="hljs-params">c[<span class="hljs-string">"Content-Type"</span>]=<span class="hljs-string">"application/octet-stream"</span>,n=l</span>):"<span class="hljs-params">string</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">l</span>?(<span class="hljs-params">c[<span class="hljs-string">"Content-Type"</span>]=<span class="hljs-string">"text/plain"</span>,n=l</span>):"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">FormData</span>&amp;&amp;<span class="hljs-params">l</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">FormData</span>?<span class="hljs-params">n</span>=<span class="hljs-params">l</span>:(<span class="hljs-params">c[<span class="hljs-string">"Content-Type"</span>]=<span class="hljs-string">"application/json"</span>,n=<span class="hljs-built_in">JSON</span>.stringify(l</span>)):<span class="hljs-params">n</span>=<span class="hljs-params">l</span>;<span class="hljs-params">let</span> <span class="hljs-params">p</span>=<span class="hljs-params">h</span>;<span class="hljs-params">u</span>&amp;&amp;(<span class="hljs-params">i=<span class="hljs-keyword">new</span> AbortController,s=setTimeout((</span>)=&gt;</span>i.abort(),u),h?<span class="hljs-function">(<span class="hljs-params">p=i.signal,h.addEventListener(<span class="hljs-string">"abort"</span>,(</span>)=&gt;</span>i.abort())):p=i.signal);<span class="hljs-keyword">let</span> g=<span class="hljs-keyword">yield</span> <span class="hljs-keyword">this</span>.fetch(f.toString(),{<span class="hljs-attr">method</span>:o||<span class="hljs-string">"POST"</span>,<span class="hljs-attr">headers</span>:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},c),<span class="hljs-keyword">this</span>.headers),a),<span class="hljs-attr">body</span>:n,<span class="hljs-attr">signal</span>:p}).catch(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> R(e)}),y=g.headers.get(<span class="hljs-string">"x-relay-error"</span>);<span class="hljs-keyword">if</span>(y&amp;&amp;<span class="hljs-string">"true"</span>===y)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> A(g);<span class="hljs-keyword">if</span>(!g.ok)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> P(g);<span class="hljs-keyword">let</span> _=(<span class="hljs-literal">null</span>!=(r=g.headers.get(<span class="hljs-string">"Content-Type"</span>))?r:<span class="hljs-string">"text/plain"</span>).split(<span class="hljs-string">";"</span>)[<span class="hljs-number">0</span>].trim();<span class="hljs-keyword">return</span>{<span class="hljs-attr">data</span>:<span class="hljs-string">"application/json"</span>===_?<span class="hljs-keyword">yield</span> g.json():<span class="hljs-string">"application/octet-stream"</span>===_||<span class="hljs-string">"application/pdf"</span>===_?<span class="hljs-keyword">yield</span> g.blob():<span class="hljs-string">"text/event-stream"</span>===_?g:<span class="hljs-string">"multipart/form-data"</span>===_?<span class="hljs-keyword">yield</span> g.formData():<span class="hljs-keyword">yield</span> g.text(),<span class="hljs-attr">error</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">response</span>:g}}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span>{<span class="hljs-attr">data</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">error</span>:e,<span class="hljs-attr">response</span>:e <span class="hljs-keyword">instanceof</span> P||e <span class="hljs-keyword">instanceof</span> A?e.context:<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>}}<span class="hljs-keyword">finally</span>{s&amp;&amp;clearTimeout(s)}})}}<span class="hljs-keyword">var</span> $=e.i(<span class="hljs-number">306</span>);<span class="hljs-keyword">let</span>{<span class="hljs-attr">PostgrestClient</span>:C,<span class="hljs-attr">PostgrestQueryBuilder</span>:x,<span class="hljs-attr">PostgrestFilterBuilder</span>:U,<span class="hljs-attr">PostgrestTransformBuilder</span>:N,<span class="hljs-attr">PostgrestBuilder</span>:D,<span class="hljs-attr">PostgrestError</span>:B}=$.<span class="hljs-keyword">default</span>||$,L=<span class="hljs-class"><span class="hljs-keyword">class</span></span>{<span class="hljs-keyword">constructor</span>(){}<span class="hljs-keyword">static</span> detectEnvironment(){<span class="hljs-keyword">var</span> t;<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> WebSocket)<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:<span class="hljs-string">"native"</span>,<span class="hljs-attr">constructor</span>:WebSocket};<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> globalThis&amp;&amp;<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==globalThis.WebSocket)<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:<span class="hljs-string">"native"</span>,<span class="hljs-attr">constructor</span>:globalThis.WebSocket};<span class="hljs-keyword">if</span>(<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==e.g.WebSocket)<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:<span class="hljs-string">"native"</span>,<span class="hljs-attr">constructor</span>:e.g.WebSocket};<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> globalThis&amp;&amp;<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==globalThis.WebSocketPair&amp;&amp;<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===globalThis.WebSocket)<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:<span class="hljs-string">"cloudflare"</span>,<span class="hljs-attr">error</span>:<span class="hljs-string">"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers."</span>,<span class="hljs-attr">workaround</span>:<span class="hljs-string">"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."</span>};<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> globalThis&amp;&amp;globalThis.EdgeRuntime||<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> navigator&amp;&amp;(<span class="hljs-literal">null</span>==(t=navigator.userAgent)?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.includes(<span class="hljs-string">"Vercel-Edge"</span>)))<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:<span class="hljs-string">"unsupported"</span>,<span class="hljs-attr">error</span>:<span class="hljs-string">"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions."</span>,<span class="hljs-attr">workaround</span>:<span class="hljs-string">"Use serverless functions or a different deployment target for WebSocket functionality."</span>};<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> process){<span class="hljs-keyword">let</span> e=process.versions;<span class="hljs-keyword">if</span>(e&amp;&amp;e.node){<span class="hljs-keyword">let</span> t=<span class="hljs-built_in">parseInt</span>(e.node.replace(<span class="hljs-regexp">/^v/</span>,<span class="hljs-string">""</span>).split(<span class="hljs-string">"."</span>)[<span class="hljs-number">0</span>]);<span class="hljs-keyword">return</span> t&gt;=<span class="hljs-number">22</span>?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==globalThis.WebSocket?{<span class="hljs-attr">type</span>:<span class="hljs-string">"native"</span>,<span class="hljs-attr">constructor</span>:globalThis.WebSocket}:{<span class="hljs-attr">type</span>:<span class="hljs-string">"unsupported"</span>,<span class="hljs-attr">error</span>:<span class="hljs-string">`Node.js <span class="hljs-subst">${t}</span> detected but native WebSocket not found.`</span>,<span class="hljs-attr">workaround</span>:<span class="hljs-string">"Provide a WebSocket implementation via the transport option."</span>}:{<span class="hljs-attr">type</span>:<span class="hljs-string">"unsupported"</span>,<span class="hljs-attr">error</span>:<span class="hljs-string">`Node.js <span class="hljs-subst">${t}</span> detected without native WebSocket support.`</span>,<span class="hljs-attr">workaround</span>:<span class="hljs-string">'For Node.js &lt; 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'</span>}}}<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:<span class="hljs-string">"unsupported"</span>,<span class="hljs-attr">error</span>:<span class="hljs-string">"Unknown JavaScript runtime without WebSocket support."</span>,<span class="hljs-attr">workaround</span>:<span class="hljs-string">"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."</span>}}<span class="hljs-keyword">static</span> getWebSocketConstructor(){<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">this</span>.detectEnvironment();<span class="hljs-keyword">if</span>(e.constructor)<span class="hljs-keyword">return</span> e.constructor;<span class="hljs-keyword">let</span> t=e.error||<span class="hljs-string">"WebSocket not supported in this environment."</span>;<span class="hljs-keyword">throw</span> e.workaround&amp;&amp;(t+=<span class="hljs-string">`

Suggested solution: <span class="hljs-subst">${e.workaround}</span>`</span>),<span class="hljs-built_in">Error</span>(t)}<span class="hljs-keyword">static</span> createWebSocket(e,t){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span>(<span class="hljs-keyword">this</span>.getWebSocketConstructor())(e,t)}<span class="hljs-keyword">static</span> isWebSocketSupported(){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">this</span>.detectEnvironment();<span class="hljs-keyword">return</span><span class="hljs-string">"native"</span>===e.type||<span class="hljs-string">"ws"</span>===e.type}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span>!<span class="hljs-number">1</span>}}},q=<span class="hljs-string">"1.0.0"</span>;<span class="hljs-function">(<span class="hljs-params">s=p||(p={}</span>))[<span class="hljs-params">s</span>.<span class="hljs-params">connecting</span>=0]="<span class="hljs-params">connecting</span>",<span class="hljs-params">s</span>[<span class="hljs-params">s</span>.<span class="hljs-params">open</span>=1]="<span class="hljs-params">open</span>",<span class="hljs-params">s</span>[<span class="hljs-params">s</span>.<span class="hljs-params">closing</span>=2]="<span class="hljs-params">closing</span>",<span class="hljs-params">s</span>[<span class="hljs-params">s</span>.<span class="hljs-params">closed</span>=3]="<span class="hljs-params">closed</span>",(<span class="hljs-params">i=g||(g={}</span>)).<span class="hljs-params">closed</span>="<span class="hljs-params">closed</span>",<span class="hljs-params">i</span>.<span class="hljs-params">errored</span>="<span class="hljs-params">errored</span>",<span class="hljs-params">i</span>.<span class="hljs-params">joined</span>="<span class="hljs-params">joined</span>",<span class="hljs-params">i</span>.<span class="hljs-params">joining</span>="<span class="hljs-params">joining</span>",<span class="hljs-params">i</span>.<span class="hljs-params">leaving</span>="<span class="hljs-params">leaving</span>",(<span class="hljs-params">n=y||(y={}</span>)).<span class="hljs-params">close</span>="<span class="hljs-params">phx_close</span>",<span class="hljs-params">n</span>.<span class="hljs-params">error</span>="<span class="hljs-params">phx_error</span>",<span class="hljs-params">n</span>.<span class="hljs-params">join</span>="<span class="hljs-params">phx_join</span>",<span class="hljs-params">n</span>.<span class="hljs-params">reply</span>="<span class="hljs-params">phx_reply</span>",<span class="hljs-params">n</span>.<span class="hljs-params">leave</span>="<span class="hljs-params">phx_leave</span>",<span class="hljs-params">n</span>.<span class="hljs-params">access_token</span>="<span class="hljs-params">access_token</span>",(<span class="hljs-params">_||(_={}</span>)).<span class="hljs-params">websocket</span>="<span class="hljs-params">websocket</span>",(<span class="hljs-params">a=w||(w={}</span>)).<span class="hljs-params">Connecting</span>="<span class="hljs-params">connecting</span>",<span class="hljs-params">a</span>.<span class="hljs-params">Open</span>="<span class="hljs-params">open</span>",<span class="hljs-params">a</span>.<span class="hljs-params">Closing</span>="<span class="hljs-params">closing</span>",<span class="hljs-params">a</span>.<span class="hljs-params">Closed</span>="<span class="hljs-params">closed</span>";<span class="hljs-params">class</span> <span class="hljs-params">K</span>{<span class="hljs-params">constructor</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">HEADER_LENGTH</span>=1,<span class="hljs-params">this</span>.<span class="hljs-params">META_LENGTH</span>=4,<span class="hljs-params">this</span>.<span class="hljs-params">USER_BROADCAST_PUSH_META_LENGTH</span>=5,<span class="hljs-params">this</span>.<span class="hljs-params">KINDS</span>={<span class="hljs-params">push</span>:0,<span class="hljs-params">reply</span>:1,<span class="hljs-params">broadcast</span>:2,<span class="hljs-params">userBroadcastPush</span>:3,<span class="hljs-params">userBroadcast</span>:4},<span class="hljs-params">this</span>.<span class="hljs-params">BINARY_ENCODING</span>=0,<span class="hljs-params">this</span>.<span class="hljs-params">JSON_ENCODING</span>=1,<span class="hljs-params">this</span>.<span class="hljs-params">BROADCAST</span>="<span class="hljs-params">broadcast</span>"}<span class="hljs-params">encode</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_isArrayBuffer</span>(<span class="hljs-params">e.payload</span>)?<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._binaryEncodePush(e</span>)):<span class="hljs-params">e</span>.<span class="hljs-params">event</span>!==<span class="hljs-params">this</span>.<span class="hljs-params">BROADCAST</span>||<span class="hljs-params">e</span>.<span class="hljs-params">payload</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">ArrayBuffer</span>||"<span class="hljs-params">string</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>.<span class="hljs-params">payload</span>.<span class="hljs-params">event</span>?<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-built_in">JSON</span>.stringify([e.join_ref,e.ref,e.topic,e.event,e.payload]</span>)):<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._binaryEncodeUserBroadcastPush(e</span>))}<span class="hljs-params">_binaryEncodePush</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">event</span>:<span class="hljs-params">t</span>,<span class="hljs-params">topic</span>:<span class="hljs-params">r</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">s</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">i</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">u=e.ref</span>)?<span class="hljs-params">u</span>:"",<span class="hljs-params">n</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">c=e.join_ref</span>)?<span class="hljs-params">c</span>:"",<span class="hljs-params">a</span>=<span class="hljs-params">this</span>.<span class="hljs-params">META_LENGTH</span>+<span class="hljs-params">n</span>.<span class="hljs-params">length</span>+<span class="hljs-params">i</span>.<span class="hljs-params">length</span>+<span class="hljs-params">r</span>.<span class="hljs-params">length</span>+<span class="hljs-params">t</span>.<span class="hljs-params">length</span>,<span class="hljs-params">o</span>=<span class="hljs-params">new</span> <span class="hljs-params">ArrayBuffer</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.HEADER_LENGTH+a</span>),<span class="hljs-params">l</span>=<span class="hljs-params">new</span> <span class="hljs-params">DataView</span>(<span class="hljs-params">o</span>),<span class="hljs-params">h</span>=0;<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,<span class="hljs-keyword">this</span>.KINDS.push</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,n.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,i.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,r.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,t.length</span>),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">n,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">i,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">r,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">t,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>)));<span class="hljs-params">var</span> <span class="hljs-params">u</span>,<span class="hljs-params">c</span>,<span class="hljs-params">d</span>=<span class="hljs-params">new</span> <span class="hljs-params">Uint8Array</span>(<span class="hljs-params">o.byteLength+s.byteLength</span>);<span class="hljs-params">return</span> <span class="hljs-params">d</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(o</span>),0),<span class="hljs-params">d</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s</span>),<span class="hljs-params">o</span>.<span class="hljs-params">byteLength</span>),<span class="hljs-params">d</span>.<span class="hljs-params">buffer</span>}<span class="hljs-params">_binaryEncodeUserBroadcastPush</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_isArrayBuffer</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==(t=e.payload</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">payload</span>)?<span class="hljs-params">this</span>.<span class="hljs-params">_encodeBinaryUserBroadcastPush</span>(<span class="hljs-params">e</span>):<span class="hljs-params">this</span>.<span class="hljs-params">_encodeJsonUserBroadcastPush</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">_encodeBinaryUserBroadcastPush</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">topic</span>,<span class="hljs-params">r</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">u=e.ref</span>)?<span class="hljs-params">u</span>:"",<span class="hljs-params">s</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">c=e.join_ref</span>)?<span class="hljs-params">c</span>:"",<span class="hljs-params">i</span>=<span class="hljs-params">e</span>.<span class="hljs-params">payload</span>.<span class="hljs-params">event</span>,<span class="hljs-params">n</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">f=<span class="hljs-literal">null</span>==(d=e.payload</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">d</span>.<span class="hljs-params">payload</span>)?<span class="hljs-params">f</span>:<span class="hljs-params">new</span> <span class="hljs-params">ArrayBuffer</span>(<span class="hljs-params"><span class="hljs-number">0</span></span>),<span class="hljs-params">a</span>=<span class="hljs-params">this</span>.<span class="hljs-params">USER_BROADCAST_PUSH_META_LENGTH</span>+<span class="hljs-params">s</span>.<span class="hljs-params">length</span>+<span class="hljs-params">r</span>.<span class="hljs-params">length</span>+<span class="hljs-params">t</span>.<span class="hljs-params">length</span>+<span class="hljs-params">i</span>.<span class="hljs-params">length</span>,<span class="hljs-params">o</span>=<span class="hljs-params">new</span> <span class="hljs-params">ArrayBuffer</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.HEADER_LENGTH+a</span>),<span class="hljs-params">l</span>=<span class="hljs-params">new</span> <span class="hljs-params">DataView</span>(<span class="hljs-params">o</span>),<span class="hljs-params">h</span>=0;<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,<span class="hljs-keyword">this</span>.KINDS.userBroadcastPush</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,s.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,r.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,t.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,i.length</span>),<span class="hljs-params">l</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">h++,<span class="hljs-keyword">this</span>.BINARY_ENCODING</span>),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">s,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">r,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">t,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">i,e=&gt;l.setUint8(h++,e.charCodeAt(<span class="hljs-number">0</span></span>)));<span class="hljs-params">var</span> <span class="hljs-params">u</span>,<span class="hljs-params">c</span>,<span class="hljs-params">d</span>,<span class="hljs-params">f</span>,<span class="hljs-params">p</span>=<span class="hljs-params">new</span> <span class="hljs-params">Uint8Array</span>(<span class="hljs-params">o.byteLength+n.byteLength</span>);<span class="hljs-params">return</span> <span class="hljs-params">p</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(o</span>),0),<span class="hljs-params">p</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(n</span>),<span class="hljs-params">o</span>.<span class="hljs-params">byteLength</span>),<span class="hljs-params">p</span>.<span class="hljs-params">buffer</span>}<span class="hljs-params">_encodeJsonUserBroadcastPush</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">topic</span>,<span class="hljs-params">r</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">c=e.ref</span>)?<span class="hljs-params">c</span>:"",<span class="hljs-params">s</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">d=e.join_ref</span>)?<span class="hljs-params">d</span>:"",<span class="hljs-params">i</span>=<span class="hljs-params">e</span>.<span class="hljs-params">payload</span>.<span class="hljs-params">event</span>,<span class="hljs-params">n</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">p=<span class="hljs-literal">null</span>==(f=e.payload</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">f</span>.<span class="hljs-params">payload</span>)?<span class="hljs-params">p</span>:{},<span class="hljs-params">a</span>=<span class="hljs-params">new</span> <span class="hljs-params">TextEncoder</span><span class="hljs-params">()</span>.<span class="hljs-params">encode</span>(<span class="hljs-params"><span class="hljs-built_in">JSON</span>.stringify(n</span>)).<span class="hljs-params">buffer</span>,<span class="hljs-params">o</span>=<span class="hljs-params">this</span>.<span class="hljs-params">USER_BROADCAST_PUSH_META_LENGTH</span>+<span class="hljs-params">s</span>.<span class="hljs-params">length</span>+<span class="hljs-params">r</span>.<span class="hljs-params">length</span>+<span class="hljs-params">t</span>.<span class="hljs-params">length</span>+<span class="hljs-params">i</span>.<span class="hljs-params">length</span>,<span class="hljs-params">l</span>=<span class="hljs-params">new</span> <span class="hljs-params">ArrayBuffer</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.HEADER_LENGTH+o</span>),<span class="hljs-params">h</span>=<span class="hljs-params">new</span> <span class="hljs-params">DataView</span>(<span class="hljs-params">l</span>),<span class="hljs-params">u</span>=0;<span class="hljs-params">h</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">u++,<span class="hljs-keyword">this</span>.KINDS.userBroadcastPush</span>),<span class="hljs-params">h</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">u++,s.length</span>),<span class="hljs-params">h</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">u++,r.length</span>),<span class="hljs-params">h</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">u++,t.length</span>),<span class="hljs-params">h</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">u++,i.length</span>),<span class="hljs-params">h</span>.<span class="hljs-params">setUint8</span>(<span class="hljs-params">u++,<span class="hljs-keyword">this</span>.JSON_ENCODING</span>),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">s,e=&gt;h.setUint8(u++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">r,e=&gt;h.setUint8(u++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">t,e=&gt;h.setUint8(u++,e.charCodeAt(<span class="hljs-number">0</span></span>))),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">i,e=&gt;h.setUint8(u++,e.charCodeAt(<span class="hljs-number">0</span></span>)));<span class="hljs-params">var</span> <span class="hljs-params">c</span>,<span class="hljs-params">d</span>,<span class="hljs-params">f</span>,<span class="hljs-params">p</span>,<span class="hljs-params">g</span>=<span class="hljs-params">new</span> <span class="hljs-params">Uint8Array</span>(<span class="hljs-params">l.byteLength+a.byteLength</span>);<span class="hljs-params">return</span> <span class="hljs-params">g</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(l</span>),0),<span class="hljs-params">g</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(a</span>),<span class="hljs-params">l</span>.<span class="hljs-params">byteLength</span>),<span class="hljs-params">g</span>.<span class="hljs-params">buffer</span>}<span class="hljs-params">decode</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._isArrayBuffer(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._binaryDecode(e</span>));<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e</span>){<span class="hljs-params">let</span>[<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>,<span class="hljs-params">a</span>]=<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span> <span class="hljs-params">t</span>(<span class="hljs-params">{join_ref:r,ref:s,topic:i,event:n,payload:a}</span>)}<span class="hljs-params">return</span> <span class="hljs-params">t</span>(<span class="hljs-params">{}</span>)}<span class="hljs-params">_binaryDecode</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">new</span> <span class="hljs-params">DataView</span>(<span class="hljs-params">e</span>),<span class="hljs-params">r</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">0</span></span>),<span class="hljs-params">s</span>=<span class="hljs-params">new</span> <span class="hljs-params">TextDecoder</span>;<span class="hljs-params">switch</span>(<span class="hljs-params">r</span>){<span class="hljs-params">case</span> <span class="hljs-params">this</span>.<span class="hljs-params">KINDS</span>.<span class="hljs-params">push</span>:<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_decodePush</span>(<span class="hljs-params">e,t,s</span>);<span class="hljs-params">case</span> <span class="hljs-params">this</span>.<span class="hljs-params">KINDS</span>.<span class="hljs-params">reply</span>:<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_decodeReply</span>(<span class="hljs-params">e,t,s</span>);<span class="hljs-params">case</span> <span class="hljs-params">this</span>.<span class="hljs-params">KINDS</span>.<span class="hljs-params">broadcast</span>:<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_decodeBroadcast</span>(<span class="hljs-params">e,t,s</span>);<span class="hljs-params">case</span> <span class="hljs-params">this</span>.<span class="hljs-params">KINDS</span>.<span class="hljs-params">userBroadcast</span>:<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_decodeUserBroadcast</span>(<span class="hljs-params">e,t,s</span>)}}<span class="hljs-params">_decodePush</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>),<span class="hljs-params">i</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">2</span></span>),<span class="hljs-params">n</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">3</span></span>),<span class="hljs-params">a</span>=<span class="hljs-params">this</span>.<span class="hljs-params">HEADER_LENGTH</span>+<span class="hljs-params">this</span>.<span class="hljs-params">META_LENGTH</span>-1,<span class="hljs-params">o</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(a,a+s</span>));<span class="hljs-params">a</span>+=<span class="hljs-params">s</span>;<span class="hljs-params">let</span> <span class="hljs-params">l</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(a,a+i</span>));<span class="hljs-params">a</span>+=<span class="hljs-params">i</span>;<span class="hljs-params">let</span> <span class="hljs-params">h</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(a,a+n</span>));<span class="hljs-params">return</span> <span class="hljs-params">a</span>+=<span class="hljs-params">n</span>,{<span class="hljs-params">join_ref</span>:<span class="hljs-params">o</span>,<span class="hljs-params">ref</span>:<span class="hljs-params">null</span>,<span class="hljs-params">topic</span>:<span class="hljs-params">l</span>,<span class="hljs-params">event</span>:<span class="hljs-params">h</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">r.decode(e.slice(a,e.byteLength</span>)))}}<span class="hljs-params">_decodeReply</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>),<span class="hljs-params">i</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">2</span></span>),<span class="hljs-params">n</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">3</span></span>),<span class="hljs-params">a</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">4</span></span>),<span class="hljs-params">o</span>=<span class="hljs-params">this</span>.<span class="hljs-params">HEADER_LENGTH</span>+<span class="hljs-params">this</span>.<span class="hljs-params">META_LENGTH</span>,<span class="hljs-params">l</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+s</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">s</span>;<span class="hljs-params">let</span> <span class="hljs-params">h</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+i</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">i</span>;<span class="hljs-params">let</span> <span class="hljs-params">u</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+n</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">n</span>;<span class="hljs-params">let</span> <span class="hljs-params">c</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+a</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">a</span>;<span class="hljs-params">let</span> <span class="hljs-params">d</span>=<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">r.decode(e.slice(o,e.byteLength</span>)));<span class="hljs-params">return</span>{<span class="hljs-params">join_ref</span>:<span class="hljs-params">l</span>,<span class="hljs-params">ref</span>:<span class="hljs-params">h</span>,<span class="hljs-params">topic</span>:<span class="hljs-params">u</span>,<span class="hljs-params">event</span>:<span class="hljs-params">y</span>.<span class="hljs-params">reply</span>,<span class="hljs-params">payload</span>:{<span class="hljs-params">status</span>:<span class="hljs-params">c</span>,<span class="hljs-params">response</span>:<span class="hljs-params">d</span>}}}<span class="hljs-params">_decodeBroadcast</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>),<span class="hljs-params">i</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">2</span></span>),<span class="hljs-params">n</span>=<span class="hljs-params">this</span>.<span class="hljs-params">HEADER_LENGTH</span>+2,<span class="hljs-params">a</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(n,n+s</span>));<span class="hljs-params">n</span>+=<span class="hljs-params">s</span>;<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(n,n+i</span>));<span class="hljs-params">return</span> <span class="hljs-params">n</span>+=<span class="hljs-params">i</span>,{<span class="hljs-params">join_ref</span>:<span class="hljs-params">null</span>,<span class="hljs-params">ref</span>:<span class="hljs-params">null</span>,<span class="hljs-params">topic</span>:<span class="hljs-params">a</span>,<span class="hljs-params">event</span>:<span class="hljs-params">o</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">r.decode(e.slice(n,e.byteLength</span>)))}}<span class="hljs-params">_decodeUserBroadcast</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>),<span class="hljs-params">i</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">2</span></span>),<span class="hljs-params">n</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">3</span></span>),<span class="hljs-params">a</span>=<span class="hljs-params">t</span>.<span class="hljs-params">getUint8</span>(<span class="hljs-params"><span class="hljs-number">4</span></span>),<span class="hljs-params">o</span>=<span class="hljs-params">this</span>.<span class="hljs-params">HEADER_LENGTH</span>+4,<span class="hljs-params">l</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+s</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">s</span>;<span class="hljs-params">let</span> <span class="hljs-params">h</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+i</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">i</span>;<span class="hljs-params">let</span> <span class="hljs-params">u</span>=<span class="hljs-params">r</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.slice(o,o+n</span>));<span class="hljs-params">o</span>+=<span class="hljs-params">n</span>;<span class="hljs-params">let</span> <span class="hljs-params">c</span>=<span class="hljs-params">e</span>.<span class="hljs-params">slice</span>(<span class="hljs-params">o,e.byteLength</span>),<span class="hljs-params">d</span>=<span class="hljs-params">a</span>===<span class="hljs-params">this</span>.<span class="hljs-params">JSON_ENCODING</span>?<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">r.decode(c</span>)):<span class="hljs-params">c</span>,<span class="hljs-params">f</span>={<span class="hljs-params">type</span>:<span class="hljs-params">this</span>.<span class="hljs-params">BROADCAST</span>,<span class="hljs-params">event</span>:<span class="hljs-params">h</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">d</span>};<span class="hljs-params">return</span> <span class="hljs-params">n</span>&gt;0&amp;&amp;(<span class="hljs-params">f.meta=<span class="hljs-built_in">JSON</span>.parse(u</span>)),{<span class="hljs-params">join_ref</span>:<span class="hljs-params">null</span>,<span class="hljs-params">ref</span>:<span class="hljs-params">null</span>,<span class="hljs-params">topic</span>:<span class="hljs-params">l</span>,<span class="hljs-params">event</span>:<span class="hljs-params">this</span>.<span class="hljs-params">BROADCAST</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">f</span>}}<span class="hljs-params">_isArrayBuffer</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">return</span> <span class="hljs-params">e</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">ArrayBuffer</span>||(<span class="hljs-params"><span class="hljs-literal">null</span>==(t=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.constructor</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">name</span>)==="<span class="hljs-params">ArrayBuffer</span>"}}<span class="hljs-params">class</span> <span class="hljs-params">W</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">this</span>.<span class="hljs-params">callback</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">timerCalc</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">timer</span>=<span class="hljs-params">void</span> 0,<span class="hljs-params">this</span>.<span class="hljs-params">tries</span>=0,<span class="hljs-params">this</span>.<span class="hljs-params">callback</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">timerCalc</span>=<span class="hljs-params">t</span>}<span class="hljs-params">reset</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">tries</span>=0,<span class="hljs-params">clearTimeout</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.timer</span>),<span class="hljs-params">this</span>.<span class="hljs-params">timer</span>=<span class="hljs-params">void</span> 0}<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>{<span class="hljs-params">clearTimeout</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.timer</span>),<span class="hljs-params">this</span>.<span class="hljs-params">timer</span>=<span class="hljs-params">setTimeout</span>(<span class="hljs-params">(</span>)=&gt;</span>{<span class="hljs-keyword">this</span>.tries=<span class="hljs-keyword">this</span>.tries+<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.callback()},<span class="hljs-keyword">this</span>.timerCalc(<span class="hljs-keyword">this</span>.tries+<span class="hljs-number">1</span>))}}(o=m||<span class="hljs-function">(<span class="hljs-params">m={}</span>)).<span class="hljs-params">abstime</span>="<span class="hljs-params">abstime</span>",<span class="hljs-params">o</span>.<span class="hljs-params">bool</span>="<span class="hljs-params">bool</span>",<span class="hljs-params">o</span>.<span class="hljs-params">date</span>="<span class="hljs-params">date</span>",<span class="hljs-params">o</span>.<span class="hljs-params">daterange</span>="<span class="hljs-params">daterange</span>",<span class="hljs-params">o</span>.<span class="hljs-params">float4</span>="<span class="hljs-params">float4</span>",<span class="hljs-params">o</span>.<span class="hljs-params">float8</span>="<span class="hljs-params">float8</span>",<span class="hljs-params">o</span>.<span class="hljs-params">int2</span>="<span class="hljs-params">int2</span>",<span class="hljs-params">o</span>.<span class="hljs-params">int4</span>="<span class="hljs-params">int4</span>",<span class="hljs-params">o</span>.<span class="hljs-params">int4range</span>="<span class="hljs-params">int4range</span>",<span class="hljs-params">o</span>.<span class="hljs-params">int8</span>="<span class="hljs-params">int8</span>",<span class="hljs-params">o</span>.<span class="hljs-params">int8range</span>="<span class="hljs-params">int8range</span>",<span class="hljs-params">o</span>.<span class="hljs-params">json</span>="<span class="hljs-params">json</span>",<span class="hljs-params">o</span>.<span class="hljs-params">jsonb</span>="<span class="hljs-params">jsonb</span>",<span class="hljs-params">o</span>.<span class="hljs-params">money</span>="<span class="hljs-params">money</span>",<span class="hljs-params">o</span>.<span class="hljs-params">numeric</span>="<span class="hljs-params">numeric</span>",<span class="hljs-params">o</span>.<span class="hljs-params">oid</span>="<span class="hljs-params">oid</span>",<span class="hljs-params">o</span>.<span class="hljs-params">reltime</span>="<span class="hljs-params">reltime</span>",<span class="hljs-params">o</span>.<span class="hljs-params">text</span>="<span class="hljs-params">text</span>",<span class="hljs-params">o</span>.<span class="hljs-params">time</span>="<span class="hljs-params">time</span>",<span class="hljs-params">o</span>.<span class="hljs-params">timestamp</span>="<span class="hljs-params">timestamp</span>",<span class="hljs-params">o</span>.<span class="hljs-params">timestamptz</span>="<span class="hljs-params">timestamptz</span>",<span class="hljs-params">o</span>.<span class="hljs-params">timetz</span>="<span class="hljs-params">timetz</span>",<span class="hljs-params">o</span>.<span class="hljs-params">tsrange</span>="<span class="hljs-params">tsrange</span>",<span class="hljs-params">o</span>.<span class="hljs-params">tstzrange</span>="<span class="hljs-params">tstzrange</span>";<span class="hljs-params">let</span> <span class="hljs-params">V</span>=(<span class="hljs-params">e,t,r={}</span>)=&gt;</span>{<span class="hljs-keyword">var</span> s;<span class="hljs-keyword">let</span> i=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">s=r.skipTypes</span>)?<span class="hljs-params">s</span>:[];<span class="hljs-params">return</span> <span class="hljs-params">t</span>?<span class="hljs-params">Object</span>.<span class="hljs-params">keys</span>(<span class="hljs-params">t</span>).<span class="hljs-params">reduce</span>(<span class="hljs-params">(r,s</span>)=&gt;</span><span class="hljs-function">(<span class="hljs-params">r[s]=H(s,e,t,i</span>),<span class="hljs-params">r</span>),{}):{}},<span class="hljs-params">H</span>=(<span class="hljs-params">e,t,r,s</span>)=&gt;</span>{<span class="hljs-keyword">let</span> i=t.find(<span class="hljs-function"><span class="hljs-params">t</span>=&gt;</span>t.name===e),n=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.type,a=r[e];<span class="hljs-keyword">return</span> n&amp;&amp;!s.includes(n)?M(n,a):J(a)},M=<span class="hljs-function">(<span class="hljs-params">e,t</span>)=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"_"</span>===e.charAt(<span class="hljs-number">0</span>))<span class="hljs-keyword">return</span> Y(t,e.slice(<span class="hljs-number">1</span>,e.length));<span class="hljs-keyword">switch</span>(e){<span class="hljs-keyword">case</span> m.bool:<span class="hljs-keyword">return</span> G(t);<span class="hljs-keyword">case</span> m.float4:<span class="hljs-keyword">case</span> m.float8:<span class="hljs-keyword">case</span> m.int2:<span class="hljs-keyword">case</span> m.int4:<span class="hljs-keyword">case</span> m.int8:<span class="hljs-keyword">case</span> m.numeric:<span class="hljs-keyword">case</span> m.oid:<span class="hljs-keyword">return</span> F(t);<span class="hljs-keyword">case</span> m.json:<span class="hljs-keyword">case</span> m.jsonb:<span class="hljs-keyword">return</span> z(t);<span class="hljs-keyword">case</span> m.timestamp:<span class="hljs-keyword">return</span> Q(t);<span class="hljs-keyword">case</span> m.abstime:<span class="hljs-keyword">case</span> m.date:<span class="hljs-keyword">case</span> m.daterange:<span class="hljs-keyword">case</span> m.int4range:<span class="hljs-keyword">case</span> m.int8range:<span class="hljs-keyword">case</span> m.money:<span class="hljs-keyword">case</span> m.reltime:<span class="hljs-keyword">case</span> m.text:<span class="hljs-keyword">case</span> m.time:<span class="hljs-keyword">case</span> m.timestamptz:<span class="hljs-keyword">case</span> m.timetz:<span class="hljs-keyword">case</span> m.tsrange:<span class="hljs-keyword">case</span> m.tstzrange:<span class="hljs-keyword">default</span>:<span class="hljs-keyword">return</span> J(t)}},J=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e,G=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">switch</span>(e){<span class="hljs-keyword">case</span><span class="hljs-string">"t"</span>:<span class="hljs-keyword">return</span>!<span class="hljs-number">0</span>;<span class="hljs-keyword">case</span><span class="hljs-string">"f"</span>:<span class="hljs-keyword">return</span>!<span class="hljs-number">1</span>;<span class="hljs-keyword">default</span>:<span class="hljs-keyword">return</span> e}},F=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e){<span class="hljs-keyword">let</span> t=<span class="hljs-built_in">parseFloat</span>(e);<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">Number</span>.isNaN(t))<span class="hljs-keyword">return</span> t}<span class="hljs-keyword">return</span> e},z=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e)<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(e)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`JSON parse error: <span class="hljs-subst">${e}</span>`</span>)}<span class="hljs-keyword">return</span> e},Y=<span class="hljs-function">(<span class="hljs-params">e,t</span>)=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>!=<span class="hljs-keyword">typeof</span> e)<span class="hljs-keyword">return</span> e;<span class="hljs-keyword">let</span> r=e.length<span class="hljs-number">-1</span>,s=e[r];<span class="hljs-keyword">if</span>(<span class="hljs-string">"{"</span>===e[<span class="hljs-number">0</span>]&amp;&amp;<span class="hljs-string">"}"</span>===s){<span class="hljs-keyword">let</span> s,i=e.slice(<span class="hljs-number">1</span>,r);<span class="hljs-keyword">try</span>{s=<span class="hljs-built_in">JSON</span>.parse(<span class="hljs-string">"["</span>+i+<span class="hljs-string">"]"</span>)}<span class="hljs-keyword">catch</span>(e){s=i?i.split(<span class="hljs-string">","</span>):[]}<span class="hljs-keyword">return</span> s.map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>M(t,e))}<span class="hljs-keyword">return</span> e},Q=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e?e.replace(<span class="hljs-string">" "</span>,<span class="hljs-string">"T"</span>):e,X=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">let</span> t=<span class="hljs-keyword">new</span> URL(e);<span class="hljs-keyword">return</span> t.protocol=t.protocol.replace(<span class="hljs-regexp">/^ws/i</span>,<span class="hljs-string">"http"</span>),t.pathname=t.pathname.replace(<span class="hljs-regexp">/\/+$/</span>,<span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/\/socket\/websocket$/i</span>,<span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/\/socket$/i</span>,<span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/\/websocket$/i</span>,<span class="hljs-string">""</span>),<span class="hljs-string">""</span>===t.pathname||<span class="hljs-string">"/"</span>===t.pathname?t.pathname=<span class="hljs-string">"/api/broadcast"</span>:t.pathname=t.pathname+<span class="hljs-string">"/api/broadcast"</span>,t.href};<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Z</span></span>{<span class="hljs-keyword">constructor</span>(e,t,r={},s=<span class="hljs-number">1e4</span>){<span class="hljs-keyword">this</span>.channel=e,<span class="hljs-keyword">this</span>.event=t,<span class="hljs-keyword">this</span>.payload=r,<span class="hljs-keyword">this</span>.timeout=s,<span class="hljs-keyword">this</span>.sent=!<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.timeoutTimer=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.ref=<span class="hljs-string">""</span>,<span class="hljs-keyword">this</span>.receivedResp=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.recHooks=[],<span class="hljs-keyword">this</span>.refEvent=<span class="hljs-literal">null</span>}resend(e){<span class="hljs-keyword">this</span>.timeout=e,<span class="hljs-keyword">this</span>._cancelRefEvent(),<span class="hljs-keyword">this</span>.ref=<span class="hljs-string">""</span>,<span class="hljs-keyword">this</span>.refEvent=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.receivedResp=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.sent=!<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.send()}send(){<span class="hljs-keyword">this</span>._hasReceived(<span class="hljs-string">"timeout"</span>)||<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">this</span>.startTimeout(</span>),<span class="hljs-params">this</span>.<span class="hljs-params">sent</span>=!0,<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">push</span>(<span class="hljs-params">{topic:<span class="hljs-keyword">this</span>.channel.topic,event:<span class="hljs-keyword">this</span>.event,payload:<span class="hljs-keyword">this</span>.payload,ref:<span class="hljs-keyword">this</span>.ref,join_ref:<span class="hljs-keyword">this</span>.channel._joinRef(</span>)}))}<span class="hljs-params">updatePayload</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">payload</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},<span class="hljs-keyword">this</span>.payload</span>),<span class="hljs-params">e</span>)}<span class="hljs-params">receive</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_hasReceived</span>(<span class="hljs-params">e</span>)&amp;&amp;<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==(r=<span class="hljs-keyword">this</span>.receivedResp</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">response</span>),<span class="hljs-params">this</span>.<span class="hljs-params">recHooks</span>.<span class="hljs-params">push</span>(<span class="hljs-params">{status:e,callback:t}</span>),<span class="hljs-params">this</span>}<span class="hljs-params">startTimeout</span><span class="hljs-params">()</span>{<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.timeoutTimer</span>)<span class="hljs-params">return</span>;<span class="hljs-params">this</span>.<span class="hljs-params">ref</span>=<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">_makeRef</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">refEvent</span>=<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>.<span class="hljs-params">_replyEventName</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.ref</span>);<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">this</span>._cancelRefEvent(),<span class="hljs-keyword">this</span>._cancelTimeout(),<span class="hljs-keyword">this</span>.receivedResp=e,<span class="hljs-keyword">this</span>._matchReceive(e)};<span class="hljs-keyword">this</span>.channel._on(<span class="hljs-keyword">this</span>.refEvent,{},e),<span class="hljs-keyword">this</span>.timeoutTimer=setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"timeout"</span>,{})},<span class="hljs-keyword">this</span>.timeout)}trigger(e,t){<span class="hljs-keyword">this</span>.refEvent&amp;&amp;<span class="hljs-keyword">this</span>.channel._trigger(<span class="hljs-keyword">this</span>.refEvent,{<span class="hljs-attr">status</span>:e,<span class="hljs-attr">response</span>:t})}destroy(){<span class="hljs-keyword">this</span>._cancelRefEvent(),<span class="hljs-keyword">this</span>._cancelTimeout()}_cancelRefEvent(){<span class="hljs-keyword">this</span>.refEvent&amp;&amp;<span class="hljs-keyword">this</span>.channel._off(<span class="hljs-keyword">this</span>.refEvent,{})}_cancelTimeout(){clearTimeout(<span class="hljs-keyword">this</span>.timeoutTimer),<span class="hljs-keyword">this</span>.timeoutTimer=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>}_matchReceive({<span class="hljs-attr">status</span>:e,<span class="hljs-attr">response</span>:t}){<span class="hljs-keyword">this</span>.recHooks.filter(<span class="hljs-function"><span class="hljs-params">t</span>=&gt;</span>t.status===e).forEach(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.callback(t))}_hasReceived(e){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.receivedResp&amp;&amp;<span class="hljs-keyword">this</span>.receivedResp.status===e}}(l=b||<span class="hljs-function">(<span class="hljs-params">b={}</span>)).<span class="hljs-params">SYNC</span>="<span class="hljs-params">sync</span>",<span class="hljs-params">l</span>.<span class="hljs-params">JOIN</span>="<span class="hljs-params">join</span>",<span class="hljs-params">l</span>.<span class="hljs-params">LEAVE</span>="<span class="hljs-params">leave</span>";<span class="hljs-params">class</span> <span class="hljs-params">ee</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">state</span>={},<span class="hljs-params">this</span>.<span class="hljs-params">pendingDiffs</span>=[],<span class="hljs-params">this</span>.<span class="hljs-params">joinRef</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">enabled</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">caller</span>={<span class="hljs-params">onJoin</span>:<span class="hljs-params">()</span>=&gt;</span>{},<span class="hljs-attr">onLeave</span>:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{},<span class="hljs-attr">onSync</span>:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{}};<span class="hljs-keyword">const</span> r=<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.events</span>)||{<span class="hljs-params">state</span>:"<span class="hljs-params">presence_state</span>",<span class="hljs-params">diff</span>:"<span class="hljs-params">presence_diff</span>"};<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>.<span class="hljs-params">_on</span>(<span class="hljs-params">r.state,{},e=&gt;{<span class="hljs-keyword">let</span>{onJoin:t,onLeave:r,onSync:s}=<span class="hljs-keyword">this</span>.caller;<span class="hljs-keyword">this</span>.joinRef=<span class="hljs-keyword">this</span>.channel._joinRef(</span>),<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">ee</span>.<span class="hljs-params">syncState</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.state,e,t,r</span>),<span class="hljs-params">this</span>.<span class="hljs-params">pendingDiffs</span>.<span class="hljs-params">forEach</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">this</span>.state=ee.syncDiff(<span class="hljs-keyword">this</span>.state,e,t,r</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">pendingDiffs</span>=[],<span class="hljs-params">s</span><span class="hljs-params">()</span>}),<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>.<span class="hljs-params">_on</span>(<span class="hljs-params">r.diff,{},e=&gt;{<span class="hljs-keyword">let</span>{onJoin:t,onLeave:r,onSync:s}=<span class="hljs-keyword">this</span>.caller;<span class="hljs-keyword">this</span>.inPendingSyncState(</span>)?<span class="hljs-params">this</span>.<span class="hljs-params">pendingDiffs</span>.<span class="hljs-params">push</span>(<span class="hljs-params">e</span>):(<span class="hljs-params"><span class="hljs-keyword">this</span>.state=ee.syncDiff(<span class="hljs-keyword">this</span>.state,e,t,r</span>),<span class="hljs-params">s</span><span class="hljs-params">()</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">onJoin</span>(<span class="hljs-params">(e,t,r</span>)=&gt;</span>{<span class="hljs-keyword">this</span>.channel._trigger(<span class="hljs-string">"presence"</span>,{<span class="hljs-attr">event</span>:<span class="hljs-string">"join"</span>,<span class="hljs-attr">key</span>:e,<span class="hljs-attr">currentPresences</span>:t,<span class="hljs-attr">newPresences</span>:r})}),<span class="hljs-keyword">this</span>.onLeave(<span class="hljs-function">(<span class="hljs-params">e,t,r</span>)=&gt;</span>{<span class="hljs-keyword">this</span>.channel._trigger(<span class="hljs-string">"presence"</span>,{<span class="hljs-attr">event</span>:<span class="hljs-string">"leave"</span>,<span class="hljs-attr">key</span>:e,<span class="hljs-attr">currentPresences</span>:t,<span class="hljs-attr">leftPresences</span>:r})}),<span class="hljs-keyword">this</span>.onSync(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>.channel._trigger(<span class="hljs-string">"presence"</span>,{<span class="hljs-attr">event</span>:<span class="hljs-string">"sync"</span>})})}<span class="hljs-keyword">static</span> syncState(e,t,r,s){<span class="hljs-keyword">let</span> i=<span class="hljs-keyword">this</span>.cloneDeep(e),n=<span class="hljs-keyword">this</span>.transformState(t),a={},o={};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.map(i,(e,t)=&gt;{n[e]||<span class="hljs-function">(<span class="hljs-params">o[e]=t</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">map</span>(<span class="hljs-params">n,(e,t</span>)=&gt;</span>{<span class="hljs-keyword">let</span> r=i[e];<span class="hljs-keyword">if</span>(r){<span class="hljs-keyword">let</span> s=t.map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.presence_ref),i=r.map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.presence_ref),n=t.filter(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-number">0</span>&gt;i.indexOf(e.presence_ref)),l=r.filter(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-number">0</span>&gt;s.indexOf(e.presence_ref));n.length&gt;<span class="hljs-number">0</span>&amp;&amp;<span class="hljs-function">(<span class="hljs-params">a[e]=n</span>),<span class="hljs-params">l</span>.<span class="hljs-params">length</span>&gt;0&amp;&amp;(<span class="hljs-params">o[e]=l</span>)}<span class="hljs-params">else</span> <span class="hljs-params">a</span>[<span class="hljs-params">e</span>]=<span class="hljs-params">t</span>}),<span class="hljs-params">this</span>.<span class="hljs-params">syncDiff</span>(<span class="hljs-params">i,{joins:a,leaves:o},r,s</span>)}<span class="hljs-params">static</span> <span class="hljs-params">syncDiff</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">let</span>{<span class="hljs-params">joins</span>:<span class="hljs-params">i</span>,<span class="hljs-params">leaves</span>:<span class="hljs-params">n</span>}={<span class="hljs-params">joins</span>:<span class="hljs-params">this</span>.<span class="hljs-params">transformState</span>(<span class="hljs-params">t.joins</span>),<span class="hljs-params">leaves</span>:<span class="hljs-params">this</span>.<span class="hljs-params">transformState</span>(<span class="hljs-params">t.leaves</span>)};<span class="hljs-params">return</span> <span class="hljs-params">r</span>||(<span class="hljs-params">r=(</span>)=&gt;</span>{}),s||<span class="hljs-function">(<span class="hljs-params">s=(</span>)=&gt;</span>{}),<span class="hljs-keyword">this</span>.map(i,(t,s)=&gt;{<span class="hljs-keyword">var</span> i;<span class="hljs-keyword">let</span> n=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">i=e[t]</span>)?<span class="hljs-params">i</span>:[];<span class="hljs-params">if</span>(<span class="hljs-params">e[t]=<span class="hljs-keyword">this</span>.cloneDeep(s</span>),<span class="hljs-params">n</span>.<span class="hljs-params">length</span>&gt;0){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">e</span>[<span class="hljs-params">t</span>].<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;e.presence_ref</span>),<span class="hljs-params">s</span>=<span class="hljs-params">n</span>.<span class="hljs-params">filter</span>(<span class="hljs-params">e=&gt;<span class="hljs-number">0</span>&gt;r.indexOf(e.presence_ref</span>));<span class="hljs-params">e</span>[<span class="hljs-params">t</span>].<span class="hljs-params">unshift</span>(<span class="hljs-params">...s</span>)}<span class="hljs-params">r</span>(<span class="hljs-params">t,n,s</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">map</span>(<span class="hljs-params">n,(t,r</span>)=&gt;</span>{<span class="hljs-keyword">let</span> i=e[t];<span class="hljs-keyword">if</span>(!i)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">let</span> n=r.map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.presence_ref);i=i.filter(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-number">0</span>&gt;n.indexOf(e.presence_ref)),e[t]=i,s(t,i,r),<span class="hljs-number">0</span>===i.length&amp;&amp;<span class="hljs-keyword">delete</span> e[t]}),e}<span class="hljs-keyword">static</span> map(e,t){<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.getOwnPropertyNames(e).map(<span class="hljs-function"><span class="hljs-params">r</span>=&gt;</span>t(r,e[r]))}<span class="hljs-keyword">static</span> transformState(e){<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.getOwnPropertyNames(e=<span class="hljs-keyword">this</span>.cloneDeep(e)).reduce(<span class="hljs-function">(<span class="hljs-params">t,r</span>)=&gt;</span>{<span class="hljs-keyword">let</span> s=e[r];<span class="hljs-keyword">return</span><span class="hljs-string">"metas"</span><span class="hljs-keyword">in</span> s?t[r]=s.metas.map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-function">(<span class="hljs-params">e.presence_ref=e.phx_ref,<span class="hljs-keyword">delete</span> e.phx_ref,<span class="hljs-keyword">delete</span> e.phx_ref_prev,e</span>)):<span class="hljs-params">t</span>[<span class="hljs-params">r</span>]=<span class="hljs-params">s</span>,<span class="hljs-params">t</span>},{})}<span class="hljs-params">static</span> <span class="hljs-params">cloneDeep</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params"><span class="hljs-built_in">JSON</span>.stringify(e</span>))}<span class="hljs-params">onJoin</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">caller</span>.<span class="hljs-params">onJoin</span>=<span class="hljs-params">e</span>}<span class="hljs-params">onLeave</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">caller</span>.<span class="hljs-params">onLeave</span>=<span class="hljs-params">e</span>}<span class="hljs-params">onSync</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">caller</span>.<span class="hljs-params">onSync</span>=<span class="hljs-params">e</span>}<span class="hljs-params">inPendingSyncState</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>!<span class="hljs-params">this</span>.<span class="hljs-params">joinRef</span>||<span class="hljs-params">this</span>.<span class="hljs-params">joinRef</span>!==<span class="hljs-params">this</span>.<span class="hljs-params">channel</span>.<span class="hljs-params">_joinRef</span><span class="hljs-params">()</span>}}(<span class="hljs-params">h=v||(v={}</span>)).<span class="hljs-params">ALL</span>="*",<span class="hljs-params">h</span>.<span class="hljs-params">INSERT</span>="<span class="hljs-params">INSERT</span>",<span class="hljs-params">h</span>.<span class="hljs-params">UPDATE</span>="<span class="hljs-params">UPDATE</span>",<span class="hljs-params">h</span>.<span class="hljs-params">DELETE</span>="<span class="hljs-params">DELETE</span>",(<span class="hljs-params">u=S||(S={}</span>)).<span class="hljs-params">BROADCAST</span>="<span class="hljs-params">broadcast</span>",<span class="hljs-params">u</span>.<span class="hljs-params">PRESENCE</span>="<span class="hljs-params">presence</span>",<span class="hljs-params">u</span>.<span class="hljs-params">POSTGRES_CHANGES</span>="<span class="hljs-params">postgres_changes</span>",<span class="hljs-params">u</span>.<span class="hljs-params">SYSTEM</span>="<span class="hljs-params">system</span>",(<span class="hljs-params">c=k||(k={}</span>)).<span class="hljs-params">SUBSCRIBED</span>="<span class="hljs-params">SUBSCRIBED</span>",<span class="hljs-params">c</span>.<span class="hljs-params">TIMED_OUT</span>="<span class="hljs-params">TIMED_OUT</span>",<span class="hljs-params">c</span>.<span class="hljs-params">CLOSED</span>="<span class="hljs-params">CLOSED</span>",<span class="hljs-params">c</span>.<span class="hljs-params">CHANNEL_ERROR</span>="<span class="hljs-params">CHANNEL_ERROR</span>";<span class="hljs-params">class</span> <span class="hljs-params">et</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={config:{}},r</span>){<span class="hljs-params">var</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.topic=e,<span class="hljs-keyword">this</span>.params=t,<span class="hljs-keyword">this</span>.socket=r,<span class="hljs-keyword">this</span>.bindings={},<span class="hljs-keyword">this</span>.state=g.closed,<span class="hljs-keyword">this</span>.joinedOnce=!<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.pushBuffer=[],<span class="hljs-keyword">this</span>.subTopic=e.replace(<span class="hljs-regexp">/^realtime:/i</span>,<span class="hljs-string">""</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">params</span>.<span class="hljs-params">config</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{broadcast:{ack:!<span class="hljs-number">1</span>,self:!<span class="hljs-number">1</span>},presence:{key:<span class="hljs-string">""</span>,enabled:!<span class="hljs-number">1</span>},private:!<span class="hljs-number">1</span>},t.config</span>),<span class="hljs-params">this</span>.<span class="hljs-params">timeout</span>=<span class="hljs-params">this</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">timeout</span>,<span class="hljs-params">this</span>.<span class="hljs-params">joinPush</span>=<span class="hljs-params">new</span> <span class="hljs-params">Z</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,y.join,<span class="hljs-keyword">this</span>.params,<span class="hljs-keyword">this</span>.timeout</span>),<span class="hljs-params">this</span>.<span class="hljs-params">rejoinTimer</span>=<span class="hljs-params">new</span> <span class="hljs-params">W</span>(<span class="hljs-params">(</span>)=&gt;</span><span class="hljs-keyword">this</span>._rejoinUntilConnected(),<span class="hljs-keyword">this</span>.socket.reconnectAfterMs),<span class="hljs-keyword">this</span>.joinPush.receive(<span class="hljs-string">"ok"</span>,()=&gt;{<span class="hljs-keyword">this</span>.state=g.joined,<span class="hljs-keyword">this</span>.rejoinTimer.reset(),<span class="hljs-keyword">this</span>.pushBuffer.forEach(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.send()),<span class="hljs-keyword">this</span>.pushBuffer=[]}),<span class="hljs-keyword">this</span>._onClose(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>.rejoinTimer.reset(),<span class="hljs-keyword">this</span>.socket.log(<span class="hljs-string">"channel"</span>,<span class="hljs-string">`close <span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>._joinRef()}</span>`</span>),<span class="hljs-keyword">this</span>.state=g.closed,<span class="hljs-keyword">this</span>.socket._remove(<span class="hljs-keyword">this</span>)}),<span class="hljs-keyword">this</span>._onError(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">this</span>._isLeaving()||<span class="hljs-keyword">this</span>._isClosed()||<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">this</span>.socket.log(<span class="hljs-string">"channel"</span>,<span class="hljs-string">`error <span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span>`</span>,e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">g</span>.<span class="hljs-params">errored</span>,<span class="hljs-params">this</span>.<span class="hljs-params">rejoinTimer</span>.<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">joinPush</span>.<span class="hljs-params">receive</span>(<span class="hljs-params"><span class="hljs-string">"timeout"</span>,(</span>)=&gt;</span>{<span class="hljs-keyword">this</span>._isJoining()&amp;&amp;<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">this</span>.socket.log(<span class="hljs-string">"channel"</span>,<span class="hljs-string">`timeout <span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span>`</span>,<span class="hljs-keyword">this</span>.joinPush.timeout</span>),<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">g</span>.<span class="hljs-params">errored</span>,<span class="hljs-params">this</span>.<span class="hljs-params">rejoinTimer</span>.<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">joinPush</span>.<span class="hljs-params">receive</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,e=&gt;{<span class="hljs-keyword">this</span>._isLeaving(</span>)||<span class="hljs-params">this</span>.<span class="hljs-params">_isClosed</span><span class="hljs-params">()</span>||(<span class="hljs-params"><span class="hljs-keyword">this</span>.socket.log(<span class="hljs-string">"channel"</span>,<span class="hljs-string">`error <span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span>`</span>,e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">g</span>.<span class="hljs-params">errored</span>,<span class="hljs-params">this</span>.<span class="hljs-params">rejoinTimer</span>.<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>)}),<span class="hljs-params">this</span>.<span class="hljs-params">_on</span>(<span class="hljs-params">y.reply,{},(e,t</span>)=&gt;</span>{<span class="hljs-keyword">this</span>._trigger(<span class="hljs-keyword">this</span>._replyEventName(t),e)}),<span class="hljs-keyword">this</span>.presence=<span class="hljs-keyword">new</span> ee(<span class="hljs-keyword">this</span>),<span class="hljs-keyword">this</span>.broadcastEndpointURL=X(<span class="hljs-keyword">this</span>.socket.endPoint),<span class="hljs-keyword">this</span>.private=<span class="hljs-keyword">this</span>.params.config.private||!<span class="hljs-number">1</span>,!<span class="hljs-keyword">this</span>.private&amp;&amp;<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==(i=<span class="hljs-literal">null</span>==(s=<span class="hljs-keyword">this</span>.params.config</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">broadcast</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">replay</span>))<span class="hljs-params">throw</span>`<span class="hljs-params">tried</span> <span class="hljs-params">to</span> <span class="hljs-params">use</span> <span class="hljs-params">replay</span> <span class="hljs-params">on</span> <span class="hljs-params">public</span> <span class="hljs-params">channel</span> '<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">topic</span>}'. <span class="hljs-params">It</span> <span class="hljs-params">must</span> <span class="hljs-params">be</span> <span class="hljs-params">a</span> <span class="hljs-params">private</span> <span class="hljs-params">channel</span>.`}<span class="hljs-params">subscribe</span>(<span class="hljs-params">e,t=<span class="hljs-keyword">this</span>.timeout</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.socket.isConnected(</span>)||<span class="hljs-params">this</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">connect</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">state</span>==<span class="hljs-params">g</span>.<span class="hljs-params">closed</span>){<span class="hljs-params">let</span>{<span class="hljs-params">config</span>:{<span class="hljs-params">broadcast</span>:<span class="hljs-params">n</span>,<span class="hljs-params">presence</span>:<span class="hljs-params">a</span>,<span class="hljs-params">private</span>:<span class="hljs-params">o</span>}}=<span class="hljs-params">this</span>.<span class="hljs-params">params</span>,<span class="hljs-params">l</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">s=<span class="hljs-literal">null</span>==(r=<span class="hljs-keyword">this</span>.bindings.postgres_changes</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;e.filter</span>))?<span class="hljs-params">s</span>:[],<span class="hljs-params">h</span>=!!<span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>[<span class="hljs-params">S</span>.<span class="hljs-params">PRESENCE</span>]&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>[<span class="hljs-params">S</span>.<span class="hljs-params">PRESENCE</span>].<span class="hljs-params">length</span>&gt;0||(<span class="hljs-params"><span class="hljs-literal">null</span>==(i=<span class="hljs-keyword">this</span>.params.config.presence</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">enabled</span>)===!0,<span class="hljs-params">u</span>={},<span class="hljs-params">c</span>={<span class="hljs-params">broadcast</span>:<span class="hljs-params">n</span>,<span class="hljs-params">presence</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a</span>),{<span class="hljs-params">enabled</span>:<span class="hljs-params">h</span>}),<span class="hljs-params">postgres_changes</span>:<span class="hljs-params">l</span>,<span class="hljs-params">private</span>:<span class="hljs-params">o</span>};<span class="hljs-params">this</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">accessTokenValue</span>&amp;&amp;(<span class="hljs-params">u.access_token=<span class="hljs-keyword">this</span>.socket.accessTokenValue</span>),<span class="hljs-params">this</span>.<span class="hljs-params">_onError</span>(<span class="hljs-params">t=&gt;<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e(k.CHANNEL_ERROR,t</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_onClose</span>(<span class="hljs-params">(</span>)=&gt;</span><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e(k.CLOSED)),<span class="hljs-keyword">this</span>.updateJoinPayload(<span class="hljs-built_in">Object</span>.assign({<span class="hljs-attr">config</span>:c},u)),<span class="hljs-keyword">this</span>.joinedOnce=!<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>._rejoin(t),<span class="hljs-keyword">this</span>.joinPush.receive(<span class="hljs-string">"ok"</span>,<span class="hljs-keyword">async</span>({<span class="hljs-attr">postgres_changes</span>:t})=&gt;{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.socket.setAuth(),<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>===t){<span class="hljs-literal">null</span>==e||e(k.SUBSCRIBED);<span class="hljs-keyword">return</span>}{<span class="hljs-keyword">let</span> s=<span class="hljs-keyword">this</span>.bindings.postgres_changes,i=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">r=<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.length</span>)?<span class="hljs-params">r</span>:0,<span class="hljs-params">n</span>=[];<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> r=<span class="hljs-number">0</span>;r&lt;i;r++</span>){<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">s</span>[<span class="hljs-params">r</span>],{<span class="hljs-params">filter</span>:{<span class="hljs-params">event</span>:<span class="hljs-params">a</span>,<span class="hljs-params">schema</span>:<span class="hljs-params">o</span>,<span class="hljs-params">table</span>:<span class="hljs-params">l</span>,<span class="hljs-params">filter</span>:<span class="hljs-params">h</span>}}=<span class="hljs-params">i</span>,<span class="hljs-params">u</span>=<span class="hljs-params">t</span>&amp;&amp;<span class="hljs-params">t</span>[<span class="hljs-params">r</span>];<span class="hljs-params">if</span>(<span class="hljs-params">u&amp;&amp;u.event===a&amp;&amp;u.schema===o&amp;&amp;u.table===l&amp;&amp;u.filter===h</span>)<span class="hljs-params">n</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},i</span>),{<span class="hljs-params">id</span>:<span class="hljs-params">u</span>.<span class="hljs-params">id</span>}));<span class="hljs-params">else</span>{<span class="hljs-params">this</span>.<span class="hljs-params">unsubscribe</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">g</span>.<span class="hljs-params">errored</span>,<span class="hljs-params">null</span>==<span class="hljs-params">e</span>||<span class="hljs-params">e</span>(<span class="hljs-params">k.CHANNEL_ERROR,<span class="hljs-built_in">Error</span>(<span class="hljs-string">"mismatch between server and client bindings for postgres changes"</span></span>));<span class="hljs-params">return</span>}}<span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>.<span class="hljs-params">postgres_changes</span>=<span class="hljs-params">n</span>,<span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">e</span>(<span class="hljs-params">k.SUBSCRIBED</span>);<span class="hljs-params">return</span>}}).<span class="hljs-params">receive</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,t=&gt;{<span class="hljs-keyword">this</span>.state=g.errored,<span class="hljs-literal">null</span>==e||e(k.CHANNEL_ERROR,<span class="hljs-built_in">Error</span>(<span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-built_in">Object</span>.values(t</span>).<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">", "</span></span>)||"<span class="hljs-params">error</span>")))}).<span class="hljs-params">receive</span>(<span class="hljs-params"><span class="hljs-string">"timeout"</span>,(</span>)=&gt;</span>{<span class="hljs-literal">null</span>==e||e(k.TIMED_OUT)})}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}presenceState(){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.presence.state}<span class="hljs-keyword">async</span> track(e,t={}){<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.send({<span class="hljs-attr">type</span>:<span class="hljs-string">"presence"</span>,<span class="hljs-attr">event</span>:<span class="hljs-string">"track"</span>,<span class="hljs-attr">payload</span>:e},t.timeout||<span class="hljs-keyword">this</span>.timeout)}<span class="hljs-keyword">async</span> untrack(e={}){<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.send({<span class="hljs-attr">type</span>:<span class="hljs-string">"presence"</span>,<span class="hljs-attr">event</span>:<span class="hljs-string">"untrack"</span>},e)}on(e,t,r){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state===g.joined&amp;&amp;e===S.PRESENCE&amp;&amp;<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">this</span>.socket.log(<span class="hljs-string">"channel"</span>,<span class="hljs-string">`resubscribe to <span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span> due to change in presence callbacks on joined channel`</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">unsubscribe</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">(</span>)=&gt;</span><span class="hljs-keyword">this</span>.subscribe())),<span class="hljs-keyword">this</span>._on(e,t,r)}<span class="hljs-keyword">async</span> httpSend(e,t,r={}){<span class="hljs-keyword">var</span> s;<span class="hljs-keyword">let</span> i=<span class="hljs-keyword">this</span>.socket.accessTokenValue?<span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">this</span>.socket.accessTokenValue}</span>`</span>:<span class="hljs-string">""</span>;<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==t)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(<span class="hljs-string">"Payload is required for httpSend()"</span>);<span class="hljs-keyword">let</span> n={<span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-attr">headers</span>:{<span class="hljs-attr">Authorization</span>:i,<span class="hljs-attr">apikey</span>:<span class="hljs-keyword">this</span>.socket.apiKey?<span class="hljs-keyword">this</span>.socket.apiKey:<span class="hljs-string">""</span>,<span class="hljs-string">"Content-Type"</span>:<span class="hljs-string">"application/json"</span>},<span class="hljs-attr">body</span>:<span class="hljs-built_in">JSON</span>.stringify({<span class="hljs-attr">messages</span>:[{<span class="hljs-attr">topic</span>:<span class="hljs-keyword">this</span>.subTopic,<span class="hljs-attr">event</span>:e,<span class="hljs-attr">payload</span>:t,<span class="hljs-attr">private</span>:<span class="hljs-keyword">this</span>.private}]})},a=<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._fetchWithTimeout(<span class="hljs-keyword">this</span>.broadcastEndpointURL,n,<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">s=r.timeout</span>)?<span class="hljs-params">s</span>:<span class="hljs-params">this</span>.<span class="hljs-params">timeout</span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">202</span>===a.status</span>)<span class="hljs-params">return</span>{<span class="hljs-params">success</span>:!0};<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">a</span>.<span class="hljs-params">statusText</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">await</span> <span class="hljs-params">a</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>;<span class="hljs-params">o</span>=<span class="hljs-params">e</span>.<span class="hljs-params">error</span>||<span class="hljs-params">e</span>.<span class="hljs-params">message</span>||<span class="hljs-params">o</span>}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){}<span class="hljs-params">return</span> <span class="hljs-params">Promise</span>.<span class="hljs-params">reject</span>(<span class="hljs-params"><span class="hljs-built_in">Error</span>(o</span>))}<span class="hljs-params">async</span> <span class="hljs-params">send</span>(<span class="hljs-params">e,t={}</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._canPush(</span>)||"<span class="hljs-params">broadcast</span>"!==<span class="hljs-params">e</span>.<span class="hljs-params">type</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Promise</span>(<span class="hljs-params">r=&gt;{<span class="hljs-keyword">var</span> s,i,n;<span class="hljs-keyword">let</span> a=<span class="hljs-keyword">this</span>._push(e.type,e,t.timeout||<span class="hljs-keyword">this</span>.timeout</span>);"<span class="hljs-params">broadcast</span>"!==<span class="hljs-params">e</span>.<span class="hljs-params">type</span>||(<span class="hljs-params"><span class="hljs-literal">null</span>==(n=<span class="hljs-literal">null</span>==(i=<span class="hljs-literal">null</span>==(s=<span class="hljs-keyword">this</span>.params</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">config</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">broadcast</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">n</span>.<span class="hljs-params">ack</span>)||<span class="hljs-params">r</span>(<span class="hljs-params"><span class="hljs-string">"ok"</span></span>),<span class="hljs-params">a</span>.<span class="hljs-params">receive</span>(<span class="hljs-params"><span class="hljs-string">"ok"</span>,(</span>)=&gt;</span>r(<span class="hljs-string">"ok"</span>)),a.receive(<span class="hljs-string">"error"</span>,()=&gt;r(<span class="hljs-string">"error"</span>)),a.receive(<span class="hljs-string">"timeout"</span>,()=&gt;r(<span class="hljs-string">"timed out"</span>))});{<span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery."</span>);<span class="hljs-keyword">let</span>{<span class="hljs-attr">event</span>:i,<span class="hljs-attr">payload</span>:n}=e,a={<span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-attr">headers</span>:{<span class="hljs-attr">Authorization</span>:<span class="hljs-keyword">this</span>.socket.accessTokenValue?<span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">this</span>.socket.accessTokenValue}</span>`</span>:<span class="hljs-string">""</span>,<span class="hljs-attr">apikey</span>:<span class="hljs-keyword">this</span>.socket.apiKey?<span class="hljs-keyword">this</span>.socket.apiKey:<span class="hljs-string">""</span>,<span class="hljs-string">"Content-Type"</span>:<span class="hljs-string">"application/json"</span>},<span class="hljs-attr">body</span>:<span class="hljs-built_in">JSON</span>.stringify({<span class="hljs-attr">messages</span>:[{<span class="hljs-attr">topic</span>:<span class="hljs-keyword">this</span>.subTopic,<span class="hljs-attr">event</span>:i,<span class="hljs-attr">payload</span>:n,<span class="hljs-attr">private</span>:<span class="hljs-keyword">this</span>.private}]})};<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._fetchWithTimeout(<span class="hljs-keyword">this</span>.broadcastEndpointURL,a,<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">r=t.timeout</span>)?<span class="hljs-params">r</span>:<span class="hljs-params">this</span>.<span class="hljs-params">timeout</span>);<span class="hljs-params">return</span> <span class="hljs-params">await</span> (<span class="hljs-params"><span class="hljs-literal">null</span>==(s=e.body</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">cancel</span><span class="hljs-params">()</span>),<span class="hljs-params">e</span>.<span class="hljs-params">ok</span>?"<span class="hljs-params">ok</span>":"<span class="hljs-params">error</span>"}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"AbortError"</span>===e.name</span>)<span class="hljs-params">return</span>"<span class="hljs-params">timed</span> <span class="hljs-params">out</span>";<span class="hljs-params">return</span>"<span class="hljs-params">error</span>"}}}<span class="hljs-params">updateJoinPayload</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">joinPush</span>.<span class="hljs-params">updatePayload</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">unsubscribe</span>(<span class="hljs-params">e=<span class="hljs-keyword">this</span>.timeout</span>){<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">g</span>.<span class="hljs-params">leaving</span>;<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>.socket.log(<span class="hljs-string">"channel"</span>,<span class="hljs-string">`leave <span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span>`</span>),<span class="hljs-keyword">this</span>._trigger(y.close,<span class="hljs-string">"leave"</span>,<span class="hljs-keyword">this</span>._joinRef())};<span class="hljs-keyword">this</span>.joinPush.destroy();<span class="hljs-keyword">let</span> r=<span class="hljs-literal">null</span>;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">s</span>=&gt;</span>{(r=<span class="hljs-keyword">new</span> Z(<span class="hljs-keyword">this</span>,y.leave,{},e)).receive(<span class="hljs-string">"ok"</span>,()=&gt;{t(),s(<span class="hljs-string">"ok"</span>)}).receive(<span class="hljs-string">"timeout"</span>,()=&gt;{t(),s(<span class="hljs-string">"timed out"</span>)}).receive(<span class="hljs-string">"error"</span>,()=&gt;{s(<span class="hljs-string">"error"</span>)}),r.send(),<span class="hljs-keyword">this</span>._canPush()||r.trigger(<span class="hljs-string">"ok"</span>,{})}).finally(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-literal">null</span>==r||r.destroy()})}teardown(){<span class="hljs-keyword">this</span>.pushBuffer.forEach(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.destroy()),<span class="hljs-keyword">this</span>.pushBuffer=[],<span class="hljs-keyword">this</span>.rejoinTimer.reset(),<span class="hljs-keyword">this</span>.joinPush.destroy(),<span class="hljs-keyword">this</span>.state=g.closed,<span class="hljs-keyword">this</span>.bindings={}}<span class="hljs-keyword">async</span> _fetchWithTimeout(e,t,r){<span class="hljs-keyword">let</span> s=<span class="hljs-keyword">new</span> AbortController,i=setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>s.abort(),r),n=<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.socket.fetch(e,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},t),{<span class="hljs-attr">signal</span>:s.signal}));<span class="hljs-keyword">return</span> clearTimeout(i),n}_push(e,t,r=<span class="hljs-keyword">this</span>.timeout){<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.joinedOnce)<span class="hljs-keyword">throw</span><span class="hljs-string">`tried to push '<span class="hljs-subst">${e}</span>' to '<span class="hljs-subst">${<span class="hljs-keyword">this</span>.topic}</span>' before joining. Use channel.subscribe() before pushing events`</span>;<span class="hljs-keyword">let</span> s=<span class="hljs-keyword">new</span> Z(<span class="hljs-keyword">this</span>,e,t,r);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._canPush()?s.send():<span class="hljs-keyword">this</span>._addToPushBuffer(s),s}_addToPushBuffer(e){<span class="hljs-keyword">if</span>(e.startTimeout(),<span class="hljs-keyword">this</span>.pushBuffer.push(e),<span class="hljs-keyword">this</span>.pushBuffer.length&gt;<span class="hljs-number">100</span>){<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">this</span>.pushBuffer.shift();e&amp;&amp;<span class="hljs-function">(<span class="hljs-params">e.destroy(</span>),<span class="hljs-params">this</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"channel"</span>,<span class="hljs-string">`discarded push due to buffer overflow: <span class="hljs-subst">${e.event}</span>`</span>,e.payload</span>))}}<span class="hljs-params">_onMessage</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>}<span class="hljs-params">_isMember</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">topic</span>===<span class="hljs-params">e</span>}<span class="hljs-params">_joinRef</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">joinPush</span>.<span class="hljs-params">ref</span>}<span class="hljs-params">_trigger</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">var</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">e</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>,{<span class="hljs-params">close</span>:<span class="hljs-params">a</span>,<span class="hljs-params">error</span>:<span class="hljs-params">o</span>,<span class="hljs-params">leave</span>:<span class="hljs-params">l</span>,<span class="hljs-params">join</span>:<span class="hljs-params">h</span>}=<span class="hljs-params">y</span>;<span class="hljs-params">if</span>(<span class="hljs-params">r&amp;&amp;[a,o,l,h].indexOf(n</span>)&gt;=0&amp;&amp;<span class="hljs-params">r</span>!==<span class="hljs-params">this</span>.<span class="hljs-params">_joinRef</span><span class="hljs-params">()</span>)<span class="hljs-params">return</span>;<span class="hljs-params">let</span> <span class="hljs-params">u</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_onMessage</span>(<span class="hljs-params">n,t,r</span>);<span class="hljs-params">if</span>(<span class="hljs-params">t&amp;&amp;!u</span>)<span class="hljs-params">throw</span>"<span class="hljs-params">channel</span> <span class="hljs-params">onMessage</span> <span class="hljs-params">callbacks</span> <span class="hljs-params">must</span> <span class="hljs-params">return</span> <span class="hljs-params">the</span> <span class="hljs-params">payload</span>, <span class="hljs-params">modified</span> <span class="hljs-params">or</span> <span class="hljs-params">unmodified</span>";["<span class="hljs-params">insert</span>","<span class="hljs-params">update</span>","<span class="hljs-params">delete</span>"].<span class="hljs-params">includes</span>(<span class="hljs-params">n</span>)?<span class="hljs-params">null</span>==(<span class="hljs-params">s=<span class="hljs-keyword">this</span>.bindings.postgres_changes</span>)||<span class="hljs-params">s</span>.<span class="hljs-params">filter</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">var</span> t,r,s;<span class="hljs-keyword">return</span>(<span class="hljs-literal">null</span>==(t=e.filter</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">event</span>)==="*"||(<span class="hljs-params"><span class="hljs-literal">null</span>==(s=<span class="hljs-literal">null</span>==(r=e.filter</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">event</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>)===<span class="hljs-params">n</span>}).<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;e.callback(u,r</span>)):<span class="hljs-params">null</span>==(<span class="hljs-params">i=<span class="hljs-keyword">this</span>.bindings[n]</span>)||<span class="hljs-params">i</span>.<span class="hljs-params">filter</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">var</span> r,s,i,a,o,l;<span class="hljs-keyword">if</span>(![<span class="hljs-string">"broadcast"</span>,<span class="hljs-string">"presence"</span>,<span class="hljs-string">"postgres_changes"</span>].includes(n</span>))<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">type</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>===<span class="hljs-params">n</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"id"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">e</span>.<span class="hljs-params">id</span>,<span class="hljs-params">a</span>=<span class="hljs-params">null</span>==(<span class="hljs-params">r=e.filter</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">event</span>;<span class="hljs-params">return</span> <span class="hljs-params">n</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-literal">null</span>==(s=t.ids</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">includes</span>(<span class="hljs-params">n</span>))&amp;&amp;(<span class="hljs-params"><span class="hljs-string">"*"</span>===a||(<span class="hljs-literal">null</span>==a?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:a.toLocaleLowerCase(</span>))===(<span class="hljs-params"><span class="hljs-literal">null</span>==(i=t.data</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">type</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>))}{<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">null</span>==(<span class="hljs-params">o=<span class="hljs-literal">null</span>==(a=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.filter</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">a</span>.<span class="hljs-params">event</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">o</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span>"*"===<span class="hljs-params">r</span>||<span class="hljs-params">r</span>===(<span class="hljs-params"><span class="hljs-literal">null</span>==(l=<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.event</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">l</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>)}}).<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">if</span>(<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> u&amp;&amp;<span class="hljs-string">"ids"</span><span class="hljs-keyword">in</span> u</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">u</span>.<span class="hljs-params">data</span>,{<span class="hljs-params">schema</span>:<span class="hljs-params">t</span>,<span class="hljs-params">table</span>:<span class="hljs-params">r</span>,<span class="hljs-params">commit_timestamp</span>:<span class="hljs-params">s</span>,<span class="hljs-params">type</span>:<span class="hljs-params">i</span>,<span class="hljs-params">errors</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">e</span>;<span class="hljs-params">u</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},{schema:t,table:r,commit_timestamp:s,eventType:i,<span class="hljs-keyword">new</span>:{},old:{},errors:n}</span>),<span class="hljs-params">this</span>.<span class="hljs-params">_getPayloadRecords</span>(<span class="hljs-params">e</span>))}<span class="hljs-params">e</span>.<span class="hljs-params">callback</span>(<span class="hljs-params">u,r</span>)})}<span class="hljs-params">_isClosed</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">state</span>===<span class="hljs-params">g</span>.<span class="hljs-params">closed</span>}<span class="hljs-params">_isJoined</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">state</span>===<span class="hljs-params">g</span>.<span class="hljs-params">joined</span>}<span class="hljs-params">_isJoining</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">state</span>===<span class="hljs-params">g</span>.<span class="hljs-params">joining</span>}<span class="hljs-params">_isLeaving</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">state</span>===<span class="hljs-params">g</span>.<span class="hljs-params">leaving</span>}<span class="hljs-params">_replyEventName</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>`<span class="hljs-params">chan_reply_$</span>{<span class="hljs-params">e</span>}`}<span class="hljs-params">_on</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">e</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>,<span class="hljs-params">i</span>={<span class="hljs-params">type</span>:<span class="hljs-params">s</span>,<span class="hljs-params">filter</span>:<span class="hljs-params">t</span>,<span class="hljs-params">callback</span>:<span class="hljs-params">r</span>};<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>[<span class="hljs-params">s</span>]?<span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>[<span class="hljs-params">s</span>].<span class="hljs-params">push</span>(<span class="hljs-params">i</span>):<span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>[<span class="hljs-params">s</span>]=[<span class="hljs-params">i</span>],<span class="hljs-params">this</span>}<span class="hljs-params">_off</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">e</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">bindings</span>[<span class="hljs-params">r</span>]&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.bindings[r]=<span class="hljs-keyword">this</span>.bindings[r].filter(e=&gt;{<span class="hljs-keyword">var</span> s;<span class="hljs-keyword">return</span>!((<span class="hljs-literal">null</span>==(s=e.type</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">toLocaleLowerCase</span><span class="hljs-params">()</span>)===<span class="hljs-params">r</span>&amp;&amp;<span class="hljs-params">et</span>.<span class="hljs-params">isEqual</span>(<span class="hljs-params">e.filter,t</span>))})),<span class="hljs-params">this</span>}<span class="hljs-params">static</span> <span class="hljs-params">isEqual</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.keys(e</span>).<span class="hljs-params">length</span>!==<span class="hljs-params">Object</span>.<span class="hljs-params">keys</span>(<span class="hljs-params">t</span>).<span class="hljs-params">length</span>)<span class="hljs-params">return</span>!1;<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> r <span class="hljs-keyword">in</span> e</span>)<span class="hljs-params">if</span>(<span class="hljs-params">e[r]!==t[r]</span>)<span class="hljs-params">return</span>!1;<span class="hljs-params">return</span>!0}<span class="hljs-params">_rejoinUntilConnected</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">rejoinTimer</span>.<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">isConnected</span><span class="hljs-params">()</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">_rejoin</span><span class="hljs-params">()</span>}<span class="hljs-params">_onClose</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">_on</span>(<span class="hljs-params">y.close,{},e</span>)}<span class="hljs-params">_onError</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">_on</span>(<span class="hljs-params">y.error,{},t=&gt;e(t</span>))}<span class="hljs-params">_canPush</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">socket</span>.<span class="hljs-params">isConnected</span><span class="hljs-params">()</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">_isJoined</span><span class="hljs-params">()</span>}<span class="hljs-params">_rejoin</span>(<span class="hljs-params">e=<span class="hljs-keyword">this</span>.timeout</span>){<span class="hljs-params">this</span>.<span class="hljs-params">_isLeaving</span><span class="hljs-params">()</span>||(<span class="hljs-params"><span class="hljs-keyword">this</span>.socket._leaveOpenTopic(<span class="hljs-keyword">this</span>.topic</span>),<span class="hljs-params">this</span>.<span class="hljs-params">state</span>=<span class="hljs-params">g</span>.<span class="hljs-params">joining</span>,<span class="hljs-params">this</span>.<span class="hljs-params">joinPush</span>.<span class="hljs-params">resend</span>(<span class="hljs-params">e</span>))}<span class="hljs-params">_getPayloadRecords</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>={<span class="hljs-params">new</span>:{},<span class="hljs-params">old</span>:{}};<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-string">"INSERT"</span>===e.type||<span class="hljs-string">"UPDATE"</span>===e.type</span>)&amp;&amp;(<span class="hljs-params">t.<span class="hljs-keyword">new</span>=V(e.columns,e.record</span>)),(<span class="hljs-params"><span class="hljs-string">"UPDATE"</span>===e.type||<span class="hljs-string">"DELETE"</span>===e.type</span>)&amp;&amp;(<span class="hljs-params">t.old=V(e.columns,e.old_record</span>)),<span class="hljs-params">t</span>}}<span class="hljs-params">let</span> <span class="hljs-params">er</span>=<span class="hljs-params">()</span>=&gt;</span>{},es=[<span class="hljs-number">1e3</span>,<span class="hljs-number">2e3</span>,<span class="hljs-number">5e3</span>,<span class="hljs-number">1e4</span>],ei=<span class="hljs-string">`
  addEventListener("message", (e) =&gt; {
    if (e.data.event === "start") {
      setInterval(() =&gt; postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`</span>;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">en</span></span>{<span class="hljs-keyword">constructor</span>(e,t){<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.accessTokenValue=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.apiKey=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.channels=[],<span class="hljs-keyword">this</span>.endPoint=<span class="hljs-string">""</span>,<span class="hljs-keyword">this</span>.httpEndpoint=<span class="hljs-string">""</span>,<span class="hljs-keyword">this</span>.headers={},<span class="hljs-keyword">this</span>.params={},<span class="hljs-keyword">this</span>.timeout=<span class="hljs-number">1e4</span>,<span class="hljs-keyword">this</span>.transport=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.heartbeatIntervalMs=<span class="hljs-number">25e3</span>,<span class="hljs-keyword">this</span>.heartbeatTimer=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.pendingHeartbeatRef=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.heartbeatCallback=er,<span class="hljs-keyword">this</span>.ref=<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.reconnectTimer=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.vsn=q,<span class="hljs-keyword">this</span>.logger=er,<span class="hljs-keyword">this</span>.conn=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.sendBuffer=[],<span class="hljs-keyword">this</span>.serializer=<span class="hljs-keyword">new</span> K,<span class="hljs-keyword">this</span>.stateChangeCallbacks={<span class="hljs-attr">open</span>:[],<span class="hljs-attr">close</span>:[],<span class="hljs-attr">error</span>:[],<span class="hljs-attr">message</span>:[]},<span class="hljs-keyword">this</span>.accessToken=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>._connectionState=<span class="hljs-string">"disconnected"</span>,<span class="hljs-keyword">this</span>._wasManualDisconnect=!<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>._authPromise=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>._resolveFetch=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e?<span class="hljs-function">(<span class="hljs-params">...t</span>)=&gt;</span>e(...t):<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>fetch(...e),!(<span class="hljs-literal">null</span>==(r=<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.params)?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.apikey))<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"API key is required to connect to Realtime"</span>);<span class="hljs-keyword">this</span>.apiKey=t.params.apikey,<span class="hljs-keyword">this</span>.endPoint=<span class="hljs-string">`<span class="hljs-subst">${e}</span>/<span class="hljs-subst">${_.websocket}</span>`</span>,<span class="hljs-keyword">this</span>.httpEndpoint=X(e),<span class="hljs-keyword">this</span>._initializeOptions(t),<span class="hljs-keyword">this</span>._setupReconnectionTimer(),<span class="hljs-keyword">this</span>.fetch=<span class="hljs-keyword">this</span>._resolveFetch(<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.fetch)}connect(){<span class="hljs-keyword">if</span>(!(<span class="hljs-keyword">this</span>.isConnecting()||<span class="hljs-keyword">this</span>.isDisconnecting()||<span class="hljs-literal">null</span>!==<span class="hljs-keyword">this</span>.conn&amp;&amp;<span class="hljs-keyword">this</span>.isConnected())){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"connecting"</span>),<span class="hljs-keyword">this</span>.accessToken&amp;&amp;!<span class="hljs-keyword">this</span>._authPromise&amp;&amp;<span class="hljs-keyword">this</span>._setAuthSafely(<span class="hljs-string">"connect"</span>),<span class="hljs-keyword">this</span>.transport)<span class="hljs-keyword">this</span>.conn=<span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>.transport(<span class="hljs-keyword">this</span>.endpointURL());<span class="hljs-keyword">else</span> <span class="hljs-keyword">try</span>{<span class="hljs-keyword">this</span>.conn=L.createWebSocket(<span class="hljs-keyword">this</span>.endpointURL())}<span class="hljs-keyword">catch</span>(t){<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"disconnected"</span>);<span class="hljs-keyword">let</span> e=t.message;<span class="hljs-keyword">if</span>(e.includes(<span class="hljs-string">"Node.js"</span>))<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`<span class="hljs-subst">${e}</span>

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`</span>);<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`WebSocket not available: <span class="hljs-subst">${e}</span>`</span>)}<span class="hljs-keyword">this</span>._setupConnectionHandlers()}}endpointURL(){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._appendParams(<span class="hljs-keyword">this</span>.endPoint,<span class="hljs-built_in">Object</span>.assign({},<span class="hljs-keyword">this</span>.params,{<span class="hljs-attr">vsn</span>:<span class="hljs-keyword">this</span>.vsn}))}disconnect(e,t){<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.isDisconnecting())<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"disconnecting"</span>,!<span class="hljs-number">0</span>),<span class="hljs-keyword">this</span>.conn){<span class="hljs-keyword">let</span> r=setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"disconnected"</span>)},<span class="hljs-number">100</span>);<span class="hljs-keyword">this</span>.conn.onclose=<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{clearTimeout(r),<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"disconnected"</span>)},<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.conn.close&amp;&amp;<span class="hljs-function">(<span class="hljs-params">e?<span class="hljs-keyword">this</span>.conn.close(e,<span class="hljs-literal">null</span>!=t?t:<span class="hljs-string">""</span></span>):<span class="hljs-params">this</span>.<span class="hljs-params">conn</span>.<span class="hljs-params">close</span><span class="hljs-params">()</span>),<span class="hljs-params">this</span>.<span class="hljs-params">_teardownConnection</span><span class="hljs-params">()</span>}<span class="hljs-params">else</span> <span class="hljs-params">this</span>.<span class="hljs-params">_setConnectionState</span>(<span class="hljs-params"><span class="hljs-string">"disconnected"</span></span>)}<span class="hljs-params">getChannels</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">channels</span>}<span class="hljs-params">async</span> <span class="hljs-params">removeChannel</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">e</span>.<span class="hljs-params">unsubscribe</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span> 0===<span class="hljs-params">this</span>.<span class="hljs-params">channels</span>.<span class="hljs-params">length</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">disconnect</span><span class="hljs-params">()</span>,<span class="hljs-params">t</span>}<span class="hljs-params">async</span> <span class="hljs-params">removeAllChannels</span><span class="hljs-params">()</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">await</span> <span class="hljs-params">Promise</span>.<span class="hljs-params">all</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.channels.map(e=&gt;e.unsubscribe(</span>)));<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">channels</span>=[],<span class="hljs-params">this</span>.<span class="hljs-params">disconnect</span><span class="hljs-params">()</span>,<span class="hljs-params">e</span>}<span class="hljs-params">log</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">this</span>.<span class="hljs-params">logger</span>(<span class="hljs-params">e,t,r</span>)}<span class="hljs-params">connectionState</span><span class="hljs-params">()</span>{<span class="hljs-params">switch</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.conn&amp;&amp;<span class="hljs-keyword">this</span>.conn.readyState</span>){<span class="hljs-params">case</span> <span class="hljs-params">p</span>.<span class="hljs-params">connecting</span>:<span class="hljs-params">return</span> <span class="hljs-params">w</span>.<span class="hljs-params">Connecting</span>;<span class="hljs-params">case</span> <span class="hljs-params">p</span>.<span class="hljs-params">open</span>:<span class="hljs-params">return</span> <span class="hljs-params">w</span>.<span class="hljs-params">Open</span>;<span class="hljs-params">case</span> <span class="hljs-params">p</span>.<span class="hljs-params">closing</span>:<span class="hljs-params">return</span> <span class="hljs-params">w</span>.<span class="hljs-params">Closing</span>;<span class="hljs-params">default</span>:<span class="hljs-params">return</span> <span class="hljs-params">w</span>.<span class="hljs-params">Closed</span>}}<span class="hljs-params">isConnected</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">connectionState</span><span class="hljs-params">()</span>===<span class="hljs-params">w</span>.<span class="hljs-params">Open</span>}<span class="hljs-params">isConnecting</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>"<span class="hljs-params">connecting</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">_connectionState</span>}<span class="hljs-params">isDisconnecting</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>"<span class="hljs-params">disconnecting</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">_connectionState</span>}<span class="hljs-params">channel</span>(<span class="hljs-params">e,t={config:{}}</span>){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=`<span class="hljs-params">realtime</span>:<span class="hljs-params">$</span>{<span class="hljs-params">e</span>}`,<span class="hljs-params">s</span>=<span class="hljs-params">this</span>.<span class="hljs-params">getChannels</span><span class="hljs-params">()</span>.<span class="hljs-params">find</span>(<span class="hljs-params">e=&gt;e.topic===r</span>);<span class="hljs-params">if</span>(<span class="hljs-params">s</span>)<span class="hljs-params">return</span> <span class="hljs-params">s</span>;{<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">new</span> <span class="hljs-params">et</span>(<span class="hljs-params"><span class="hljs-string">`realtime:<span class="hljs-subst">${e}</span>`</span>,t,<span class="hljs-keyword">this</span></span>);<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">channels</span>.<span class="hljs-params">push</span>(<span class="hljs-params">r</span>),<span class="hljs-params">r</span>}}<span class="hljs-params">push</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">topic</span>:<span class="hljs-params">t</span>,<span class="hljs-params">event</span>:<span class="hljs-params">r</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">s</span>,<span class="hljs-params">ref</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">n</span>=<span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>.encode(e,e=&gt;{<span class="hljs-keyword">var</span> t;<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">t=<span class="hljs-keyword">this</span>.conn</span>)||<span class="hljs-params">t</span>.<span class="hljs-params">send</span>(<span class="hljs-params">e</span>)})};<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"push"</span>,<span class="hljs-string">`<span class="hljs-subst">${t}</span> <span class="hljs-subst">${r}</span> (<span class="hljs-subst">${i}</span>)`</span>,s</span>),<span class="hljs-params">this</span>.<span class="hljs-params">isConnected</span><span class="hljs-params">()</span>?<span class="hljs-params">n</span><span class="hljs-params">()</span>:<span class="hljs-params">this</span>.<span class="hljs-params">sendBuffer</span>.<span class="hljs-params">push</span>(<span class="hljs-params">n</span>)}<span class="hljs-params">async</span> <span class="hljs-params">setAuth</span>(<span class="hljs-params">e=<span class="hljs-literal">null</span></span>){<span class="hljs-params">this</span>.<span class="hljs-params">_authPromise</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_performAuth</span>(<span class="hljs-params">e</span>);<span class="hljs-params">try</span>{<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_authPromise</span>}<span class="hljs-params">finally</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_authPromise</span>=<span class="hljs-params">null</span>}}<span class="hljs-params">async</span> <span class="hljs-params">sendHeartbeat</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!<span class="hljs-keyword">this</span>.isConnected(</span>)){<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatCallback</span>(<span class="hljs-params"><span class="hljs-string">"disconnected"</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,<span class="hljs-string">"error in heartbeat callback"</span>,e</span>)}<span class="hljs-params">return</span>}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.pendingHeartbeatRef</span>){<span class="hljs-params">this</span>.<span class="hljs-params">pendingHeartbeatRef</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"transport"</span>,<span class="hljs-string">"heartbeat timeout. Attempting to re-establish connection"</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatCallback</span>(<span class="hljs-params"><span class="hljs-string">"timeout"</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,<span class="hljs-string">"error in heartbeat callback"</span>,e</span>)}<span class="hljs-params">this</span>.<span class="hljs-params">_wasManualDisconnect</span>=!1,<span class="hljs-params">null</span>==(<span class="hljs-params">e=<span class="hljs-keyword">this</span>.conn</span>)||<span class="hljs-params">e</span>.<span class="hljs-params">close</span>(<span class="hljs-params"><span class="hljs-number">1e3</span>,<span class="hljs-string">"heartbeat timeout"</span></span>),<span class="hljs-params">setTimeout</span>(<span class="hljs-params">(</span>)=&gt;</span>{<span class="hljs-keyword">var</span> e;<span class="hljs-keyword">this</span>.isConnected()||<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">e=<span class="hljs-keyword">this</span>.reconnectTimer</span>)||<span class="hljs-params">e</span>.<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>},100);<span class="hljs-params">return</span>}<span class="hljs-params">this</span>.<span class="hljs-params">pendingHeartbeatRef</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_makeRef</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">push</span>(<span class="hljs-params">{topic:<span class="hljs-string">"phoenix"</span>,event:<span class="hljs-string">"heartbeat"</span>,payload:{},ref:<span class="hljs-keyword">this</span>.pendingHeartbeatRef}</span>);<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatCallback</span>(<span class="hljs-params"><span class="hljs-string">"sent"</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,<span class="hljs-string">"error in heartbeat callback"</span>,e</span>)}<span class="hljs-params">this</span>.<span class="hljs-params">_setAuthSafely</span>(<span class="hljs-params"><span class="hljs-string">"heartbeat"</span></span>)}<span class="hljs-params">onHeartbeat</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatCallback</span>=<span class="hljs-params">e</span>}<span class="hljs-params">flushSendBuffer</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">isConnected</span><span class="hljs-params">()</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">sendBuffer</span>.<span class="hljs-params">length</span>&gt;0&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.sendBuffer.forEach(e=&gt;e(</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">sendBuffer</span>=[])}<span class="hljs-params">_makeRef</span><span class="hljs-params">()</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">this</span>.<span class="hljs-params">ref</span>+1;<span class="hljs-params">return</span> <span class="hljs-params">e</span>===<span class="hljs-params">this</span>.<span class="hljs-params">ref</span>?<span class="hljs-params">this</span>.<span class="hljs-params">ref</span>=0:<span class="hljs-params">this</span>.<span class="hljs-params">ref</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">ref</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>}<span class="hljs-params">_leaveOpenTopic</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">this</span>.<span class="hljs-params">channels</span>.<span class="hljs-params">find</span>(<span class="hljs-params">t=&gt;t.topic===e&amp;&amp;(t._isJoined(</span>)||<span class="hljs-params">t</span>.<span class="hljs-params">_isJoining</span><span class="hljs-params">()</span>));<span class="hljs-params">t</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.log(<span class="hljs-string">"transport"</span>,<span class="hljs-string">`leaving duplicate topic "<span class="hljs-subst">${e}</span>"`</span></span>),<span class="hljs-params">t</span>.<span class="hljs-params">unsubscribe</span><span class="hljs-params">()</span>)}<span class="hljs-params">_remove</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">channels</span>=<span class="hljs-params">this</span>.<span class="hljs-params">channels</span>.<span class="hljs-params">filter</span>(<span class="hljs-params">t=&gt;t.topic!==e.topic</span>)}<span class="hljs-params">_onConnMessage</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.data,e=&gt;{<span class="hljs-keyword">if</span>(<span class="hljs-string">"phoenix"</span>===e.topic&amp;&amp;<span class="hljs-string">"phx_reply"</span>===e.event</span>)<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatCallback</span>(<span class="hljs-params"><span class="hljs-string">"ok"</span>===e.payload.status?<span class="hljs-string">"ok"</span>:<span class="hljs-string">"error"</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,<span class="hljs-string">"error in heartbeat callback"</span>,e</span>)}<span class="hljs-params">e</span>.<span class="hljs-params">ref</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">ref</span>===<span class="hljs-params">this</span>.<span class="hljs-params">pendingHeartbeatRef</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.pendingHeartbeatRef=<span class="hljs-literal">null</span></span>);<span class="hljs-params">let</span>{<span class="hljs-params">topic</span>:<span class="hljs-params">t</span>,<span class="hljs-params">event</span>:<span class="hljs-params">r</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">s</span>,<span class="hljs-params">ref</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">n</span>=<span class="hljs-params">i</span>?`(<span class="hljs-params">${i}</span>)`:"",<span class="hljs-params">a</span>=<span class="hljs-params">s</span>.<span class="hljs-params">status</span>||"";<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"receive"</span>,<span class="hljs-string">`<span class="hljs-subst">${a}</span> <span class="hljs-subst">${t}</span> <span class="hljs-subst">${r}</span> <span class="hljs-subst">${n}</span>`</span>.trim(</span>),<span class="hljs-params">s</span>),<span class="hljs-params">this</span>.<span class="hljs-params">channels</span>.<span class="hljs-params">filter</span>(<span class="hljs-params">e=&gt;e._isMember(t</span>)).<span class="hljs-params">forEach</span>(<span class="hljs-params">e=&gt;e._trigger(r,s,i</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_triggerStateCallbacks</span>(<span class="hljs-params"><span class="hljs-string">"message"</span>,e</span>)})}<span class="hljs-params">_clearTimer</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;"<span class="hljs-params">heartbeat</span>"===<span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatTimer</span>?(<span class="hljs-params">clearInterval(<span class="hljs-keyword">this</span>.heartbeatTimer</span>),<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatTimer</span>=<span class="hljs-params">void</span> 0):"<span class="hljs-params">reconnect</span>"===<span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-literal">null</span>==(t=<span class="hljs-keyword">this</span>.reconnectTimer</span>)||<span class="hljs-params">t</span>.<span class="hljs-params">reset</span><span class="hljs-params">()</span>)}<span class="hljs-params">_clearAllTimers</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_clearTimer</span>(<span class="hljs-params"><span class="hljs-string">"heartbeat"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">_clearTimer</span>(<span class="hljs-params"><span class="hljs-string">"reconnect"</span></span>)}<span class="hljs-params">_setupConnectionHandlers</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">conn</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-string">"binaryType"</span><span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.conn&amp;&amp;(<span class="hljs-keyword">this</span>.conn.binaryType=<span class="hljs-string">"arraybuffer"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">conn</span>.<span class="hljs-params">onopen</span>=<span class="hljs-params">()</span>=&gt;</span><span class="hljs-keyword">this</span>._onConnOpen(),<span class="hljs-keyword">this</span>.conn.onerror=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-keyword">this</span>._onConnError(e),<span class="hljs-keyword">this</span>.conn.onmessage=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-keyword">this</span>._onConnMessage(e),<span class="hljs-keyword">this</span>.conn.onclose=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span><span class="hljs-keyword">this</span>._onConnClose(e))}_teardownConnection(){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.conn){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.conn.readyState===p.open||<span class="hljs-keyword">this</span>.conn.readyState===p.connecting)<span class="hljs-keyword">try</span>{<span class="hljs-keyword">this</span>.conn.close()}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"error"</span>,<span class="hljs-string">"Error closing connection"</span>,e)}<span class="hljs-keyword">this</span>.conn.onopen=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.conn.onerror=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.conn.onmessage=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.conn.onclose=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>.conn=<span class="hljs-literal">null</span>}<span class="hljs-keyword">this</span>._clearAllTimers(),<span class="hljs-keyword">this</span>.channels.forEach(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.teardown())}_onConnOpen(){<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"connected"</span>),<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"transport"</span>,<span class="hljs-string">`connected to <span class="hljs-subst">${<span class="hljs-keyword">this</span>.endpointURL()}</span>`</span>),(<span class="hljs-keyword">this</span>._authPromise||<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">this</span>.accessToken&amp;&amp;!<span class="hljs-keyword">this</span>.accessTokenValue?<span class="hljs-keyword">this</span>.setAuth(</span>):<span class="hljs-params">Promise</span>.<span class="hljs-params">resolve</span><span class="hljs-params">()</span>)).<span class="hljs-params">then</span>(<span class="hljs-params">(</span>)=&gt;</span>{<span class="hljs-keyword">this</span>.flushSendBuffer()}).catch(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"error"</span>,<span class="hljs-string">"error waiting for auth on connect"</span>,e),<span class="hljs-keyword">this</span>.flushSendBuffer()}),<span class="hljs-keyword">this</span>._clearTimer(<span class="hljs-string">"reconnect"</span>),<span class="hljs-keyword">this</span>.worker?<span class="hljs-keyword">this</span>.workerRef||<span class="hljs-keyword">this</span>._startWorkerHeartbeat():<span class="hljs-keyword">this</span>._startHeartbeat(),<span class="hljs-keyword">this</span>._triggerStateCallbacks(<span class="hljs-string">"open"</span>)}_startHeartbeat(){<span class="hljs-keyword">this</span>.heartbeatTimer&amp;&amp;clearInterval(<span class="hljs-keyword">this</span>.heartbeatTimer),<span class="hljs-keyword">this</span>.heartbeatTimer=setInterval(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span><span class="hljs-keyword">this</span>.sendHeartbeat(),<span class="hljs-keyword">this</span>.heartbeatIntervalMs)}_startWorkerHeartbeat(){<span class="hljs-keyword">this</span>.workerUrl?<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"worker"</span>,<span class="hljs-string">`starting worker for from <span class="hljs-subst">${<span class="hljs-keyword">this</span>.workerUrl}</span>`</span>):<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"worker"</span>,<span class="hljs-string">"starting default worker"</span>);<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">this</span>._workerObjectUrl(<span class="hljs-keyword">this</span>.workerUrl);<span class="hljs-keyword">this</span>.workerRef=<span class="hljs-keyword">new</span> Worker(e),<span class="hljs-keyword">this</span>.workerRef.onerror=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"worker"</span>,<span class="hljs-string">"worker error"</span>,e.message),<span class="hljs-keyword">this</span>.workerRef.terminate()},<span class="hljs-keyword">this</span>.workerRef.onmessage=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-string">"keepAlive"</span>===e.data.event&amp;&amp;<span class="hljs-keyword">this</span>.sendHeartbeat()},<span class="hljs-keyword">this</span>.workerRef.postMessage({<span class="hljs-attr">event</span>:<span class="hljs-string">"start"</span>,<span class="hljs-attr">interval</span>:<span class="hljs-keyword">this</span>.heartbeatIntervalMs})}_onConnClose(e){<span class="hljs-keyword">var</span> t;<span class="hljs-keyword">this</span>._setConnectionState(<span class="hljs-string">"disconnected"</span>),<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"transport"</span>,<span class="hljs-string">"close"</span>,e),<span class="hljs-keyword">this</span>._triggerChanError(),<span class="hljs-keyword">this</span>._clearTimer(<span class="hljs-string">"heartbeat"</span>),<span class="hljs-keyword">this</span>._wasManualDisconnect||<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">t=<span class="hljs-keyword">this</span>.reconnectTimer</span>)||<span class="hljs-params">t</span>.<span class="hljs-params">scheduleTimeout</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">_triggerStateCallbacks</span>(<span class="hljs-params"><span class="hljs-string">"close"</span>,e</span>)}<span class="hljs-params">_onConnError</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">_setConnectionState</span>(<span class="hljs-params"><span class="hljs-string">"disconnected"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"transport"</span>,<span class="hljs-string">`<span class="hljs-subst">${e}</span>`</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">_triggerChanError</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">_triggerStateCallbacks</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,e</span>)}<span class="hljs-params">_triggerChanError</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">channels</span>.<span class="hljs-params">forEach</span>(<span class="hljs-params">e=&gt;e._trigger(y.error</span>))}<span class="hljs-params">_appendParams</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">0</span>===<span class="hljs-built_in">Object</span>.keys(t</span>).<span class="hljs-params">length</span>)<span class="hljs-params">return</span> <span class="hljs-params">e</span>;<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">e</span>.<span class="hljs-params">match</span>(<span class="hljs-params"><span class="hljs-regexp">/\?/</span></span>)?"&amp;":"?",<span class="hljs-params">s</span>=<span class="hljs-params">new</span> <span class="hljs-params">URLSearchParams</span>(<span class="hljs-params">t</span>);<span class="hljs-params">return</span>`<span class="hljs-params">$</span>{<span class="hljs-params">e</span>}<span class="hljs-params">$</span>{<span class="hljs-params">r</span>}<span class="hljs-params">$</span>{<span class="hljs-params">s</span>}`}<span class="hljs-params">_workerObjectUrl</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params">e</span>)<span class="hljs-params">t</span>=<span class="hljs-params">e</span>;<span class="hljs-params">else</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">Blob</span>(<span class="hljs-params">[ei],{type:<span class="hljs-string">"application/javascript"</span>}</span>);<span class="hljs-params">t</span>=<span class="hljs-params">URL</span>.<span class="hljs-params">createObjectURL</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">return</span> <span class="hljs-params">t</span>}<span class="hljs-params">_setConnectionState</span>(<span class="hljs-params">e,t=!<span class="hljs-number">1</span></span>){<span class="hljs-params">this</span>.<span class="hljs-params">_connectionState</span>=<span class="hljs-params">e</span>,"<span class="hljs-params">connecting</span>"===<span class="hljs-params">e</span>?<span class="hljs-params">this</span>.<span class="hljs-params">_wasManualDisconnect</span>=!1:"<span class="hljs-params">disconnecting</span>"===<span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>._wasManualDisconnect=t</span>)}<span class="hljs-params">async</span> <span class="hljs-params">_performAuth</span>(<span class="hljs-params">e=<span class="hljs-literal">null</span></span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>;<span class="hljs-params">t</span>=<span class="hljs-params">e</span>||(<span class="hljs-params"><span class="hljs-keyword">this</span>.accessToken?<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.accessToken(</span>):<span class="hljs-params">this</span>.<span class="hljs-params">accessTokenValue</span>),<span class="hljs-params">this</span>.<span class="hljs-params">accessTokenValue</span>!=<span class="hljs-params">t</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.accessTokenValue=t,<span class="hljs-keyword">this</span>.channels.forEach(e=&gt;{t&amp;&amp;e.updateJoinPayload({access_token:t,version:<span class="hljs-string">"realtime-js/2.83.0"</span>}</span>),<span class="hljs-params">e</span>.<span class="hljs-params">joinedOnce</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">_isJoined</span><span class="hljs-params">()</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">_push</span>(<span class="hljs-params">y.access_token,{access_token:t}</span>)}))}<span class="hljs-params">async</span> <span class="hljs-params">_waitForAuthIfNeeded</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_authPromise</span>&amp;&amp;<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_authPromise</span>}<span class="hljs-params">_setAuthSafely</span>(<span class="hljs-params">e=<span class="hljs-string">"general"</span></span>){<span class="hljs-params">this</span>.<span class="hljs-params">setAuth</span><span class="hljs-params">()</span>.<span class="hljs-params">catch</span>(<span class="hljs-params">t=&gt;{<span class="hljs-keyword">this</span>.log(<span class="hljs-string">"error"</span>,<span class="hljs-string">`error setting auth in <span class="hljs-subst">${e}</span>`</span>,t</span>)})}<span class="hljs-params">_triggerStateCallbacks</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">stateChangeCallbacks</span>[<span class="hljs-params">e</span>].<span class="hljs-params">forEach</span>(<span class="hljs-params">r=&gt;{<span class="hljs-keyword">try</span>{r(t</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">t</span>){<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,<span class="hljs-string">`error in <span class="hljs-subst">${e}</span> callback`</span>,t</span>)}})}<span class="hljs-params">catch</span>(<span class="hljs-params">t</span>){<span class="hljs-params">this</span>.<span class="hljs-params">log</span>(<span class="hljs-params"><span class="hljs-string">"error"</span>,<span class="hljs-string">`error triggering <span class="hljs-subst">${e}</span> callbacks`</span>,t</span>)}}<span class="hljs-params">_setupReconnectionTimer</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">reconnectTimer</span>=<span class="hljs-params">new</span> <span class="hljs-params">W</span>(<span class="hljs-params"><span class="hljs-keyword">async</span>(</span>)=&gt;</span>{setTimeout(<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._waitForAuthIfNeeded(),<span class="hljs-keyword">this</span>.isConnected()||<span class="hljs-keyword">this</span>.connect()},<span class="hljs-number">10</span>)},<span class="hljs-keyword">this</span>.reconnectAfterMs)}_initializeOptions(e){<span class="hljs-keyword">var</span> t,r,s,i,n,a,o,l,h,u,c,d;<span class="hljs-keyword">switch</span>(<span class="hljs-keyword">this</span>.transport=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">t=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.transport</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">timeout</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">r=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.timeout</span>)?<span class="hljs-params">r</span>:1<span class="hljs-params">e4</span>,<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatIntervalMs</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">s=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.heartbeatIntervalMs</span>)?<span class="hljs-params">s</span>:25<span class="hljs-params">e3</span>,<span class="hljs-params">this</span>.<span class="hljs-params">worker</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">i=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.worker</span>)&amp;&amp;<span class="hljs-params">i</span>,<span class="hljs-params">this</span>.<span class="hljs-params">accessToken</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">n=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.accessToken</span>)?<span class="hljs-params">n</span>:<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">heartbeatCallback</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">a=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.heartbeatCallback</span>)?<span class="hljs-params">a</span>:<span class="hljs-params">er</span>,<span class="hljs-params">this</span>.<span class="hljs-params">vsn</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">o=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.vsn</span>)?<span class="hljs-params">o</span>:<span class="hljs-params">q</span>,(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.params</span>)&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.params=e.params</span>),(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.logger</span>)&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.logger=e.logger</span>),(<span class="hljs-params">(<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.logLevel</span>)||(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.log_level</span>))&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.logLevel=e.logLevel||e.log_level,<span class="hljs-keyword">this</span>.params=<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},<span class="hljs-keyword">this</span>.params</span>),{<span class="hljs-params">log_level</span>:<span class="hljs-params">this</span>.<span class="hljs-params">logLevel</span>})),<span class="hljs-params">this</span>.<span class="hljs-params">reconnectAfterMs</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">l=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.reconnectAfterMs</span>)?<span class="hljs-params">l</span>:<span class="hljs-params">e</span>=&gt;</span>es[e<span class="hljs-number">-1</span>]||<span class="hljs-number">1e4</span>,<span class="hljs-keyword">this</span>.vsn){<span class="hljs-keyword">case</span> q:<span class="hljs-keyword">this</span>.encode=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">h=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.encode</span>)?<span class="hljs-params">h</span>:(<span class="hljs-params">e,t</span>)=&gt;</span>t(<span class="hljs-built_in">JSON</span>.stringify(e)),<span class="hljs-keyword">this</span>.decode=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">u=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.decode</span>)?<span class="hljs-params">u</span>:(<span class="hljs-params">e,t</span>)=&gt;</span>t(<span class="hljs-built_in">JSON</span>.parse(e));<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span><span class="hljs-string">"2.0.0"</span>:<span class="hljs-keyword">this</span>.encode=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">c=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.encode</span>)?<span class="hljs-params">c</span>:<span class="hljs-params">this</span>.<span class="hljs-params">serializer</span>.<span class="hljs-params">encode</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.serializer</span>),<span class="hljs-params">this</span>.<span class="hljs-params">decode</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">d=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.decode</span>)?<span class="hljs-params">d</span>:<span class="hljs-params">this</span>.<span class="hljs-params">serializer</span>.<span class="hljs-params">decode</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.serializer</span>);<span class="hljs-params">break</span>;<span class="hljs-params">default</span>:<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">`Unsupported serializer version: <span class="hljs-subst">${<span class="hljs-keyword">this</span>.vsn}</span>`</span></span>)}<span class="hljs-params">this</span>.<span class="hljs-params">worker</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.workerUrl=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.workerUrl</span>)}}<span class="hljs-params">class</span> <span class="hljs-params">ea</span> <span class="hljs-params">extends</span> <span class="hljs-params">Error</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">__isStorageError</span>=!0,<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">StorageError</span>"}}<span class="hljs-params">function</span> <span class="hljs-params">eo</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">null</span>!==<span class="hljs-params">e</span>&amp;&amp;"<span class="hljs-params">__isStorageError</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>}<span class="hljs-params">class</span> <span class="hljs-params">el</span> <span class="hljs-params">extends</span> <span class="hljs-params">ea</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">StorageApiError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">status</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">statusCode</span>=<span class="hljs-params">r</span>}<span class="hljs-params">toJSON</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>{<span class="hljs-params">name</span>:<span class="hljs-params">this</span>.<span class="hljs-params">name</span>,<span class="hljs-params">message</span>:<span class="hljs-params">this</span>.<span class="hljs-params">message</span>,<span class="hljs-params">status</span>:<span class="hljs-params">this</span>.<span class="hljs-params">status</span>,<span class="hljs-params">statusCode</span>:<span class="hljs-params">this</span>.<span class="hljs-params">statusCode</span>}}}<span class="hljs-params">class</span> <span class="hljs-params">eh</span> <span class="hljs-params">extends</span> <span class="hljs-params">ea</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">StorageUnknownError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">originalError</span>=<span class="hljs-params">t</span>}}<span class="hljs-params">let</span> <span class="hljs-params">eu</span>=<span class="hljs-params">e</span>=&gt;</span>e?<span class="hljs-function">(<span class="hljs-params">...t</span>)=&gt;</span>e(...t):<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>fetch(...e),ec=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-built_in">Array</span>.isArray(e))<span class="hljs-keyword">return</span> e.map(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>ec(e));<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> e||e!==<span class="hljs-built_in">Object</span>(e))<span class="hljs-keyword">return</span> e;<span class="hljs-keyword">let</span> t={};<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.entries(e).forEach(<span class="hljs-function">(<span class="hljs-params">[e,r]</span>)=&gt;</span>{t[e.replace(<span class="hljs-regexp">/([-_][a-z])/gi</span>,e=&gt;e.toUpperCase().replace(<span class="hljs-regexp">/[-_]/g</span>,<span class="hljs-string">""</span>))]=ec(r)}),t},ed=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{<span class="hljs-keyword">var</span> t;<span class="hljs-keyword">return</span> e.msg||e.message||e.error_description||<span class="hljs-function">(<span class="hljs-params"><span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e.error?e.error:<span class="hljs-literal">null</span>==(t=e.error</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">message</span>)||<span class="hljs-params">JSON</span>.<span class="hljs-params">stringify</span>(<span class="hljs-params">e</span>)};<span class="hljs-params">function</span> <span class="hljs-params">ef</span>(<span class="hljs-params">e,t,r,s,i,n</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Promise</span>(<span class="hljs-params">(a,o</span>)=&gt;</span>{<span class="hljs-keyword">let</span> l;e(r,(l={<span class="hljs-attr">method</span>:t,<span class="hljs-attr">headers</span>:<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>)||{}},"<span class="hljs-params">GET</span>"===<span class="hljs-params">t</span>||!<span class="hljs-params">n</span>?<span class="hljs-params">l</span>:(<span class="hljs-params">(e=&gt;{<span class="hljs-keyword">if</span>(<span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> e||<span class="hljs-literal">null</span>===e</span>)<span class="hljs-params">return</span>!1;<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">getPrototypeOf</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>===t||t===<span class="hljs-built_in">Object</span>.prototype||<span class="hljs-literal">null</span>===<span class="hljs-built_in">Object</span>.getPrototypeOf(t</span>))&amp;&amp;!(<span class="hljs-params"><span class="hljs-built_in">Symbol</span>.toStringTag <span class="hljs-keyword">in</span> e</span>)&amp;&amp;!(<span class="hljs-params"><span class="hljs-built_in">Symbol</span>.iterator <span class="hljs-keyword">in</span> e</span>)})(<span class="hljs-params">n</span>)?(<span class="hljs-params">l.headers=<span class="hljs-built_in">Object</span>.assign({<span class="hljs-string">"Content-Type"</span>:<span class="hljs-string">"application/json"</span>},<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>),<span class="hljs-params">l</span>.<span class="hljs-params">body</span>=<span class="hljs-params">JSON</span>.<span class="hljs-params">stringify</span>(<span class="hljs-params">n</span>)):<span class="hljs-params">l</span>.<span class="hljs-params">body</span>=<span class="hljs-params">n</span>,(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.duplex</span>)&amp;&amp;(<span class="hljs-params">l.duplex=s.duplex</span>),<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},l</span>),<span class="hljs-params">i</span>)))).<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">if</span>(!e.ok</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.noResolveJson</span>)?<span class="hljs-params">e</span>:<span class="hljs-params">e</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>}).<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;a(e</span>)).<span class="hljs-params">catch</span>(<span class="hljs-params">e=&gt;(<span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">e</span> <span class="hljs-params">instanceof</span>(<span class="hljs-params"><span class="hljs-keyword">yield</span> Response</span>)&amp;&amp;!(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.noResolveJson</span>)?<span class="hljs-params">e</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">t=&gt;{<span class="hljs-keyword">let</span> r=e.status||<span class="hljs-number">500</span>,s=(<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.statusCode</span>)||<span class="hljs-params">r</span>+"";<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> el(ed(t</span>),<span class="hljs-params">r</span>,<span class="hljs-params">s</span>))}).<span class="hljs-params">catch</span>(<span class="hljs-params">e=&gt;{o(<span class="hljs-keyword">new</span> eh(ed(e</span>),<span class="hljs-params">e</span>))}):<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> eh(ed(e</span>),<span class="hljs-params">e</span>))}))})})}<span class="hljs-params">function</span> <span class="hljs-params">ep</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">ef</span>(<span class="hljs-params">e,<span class="hljs-string">"GET"</span>,t,r,s</span>)})}<span class="hljs-params">function</span> <span class="hljs-params">eg</span>(<span class="hljs-params">e,t,r,s,i</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">ef</span>(<span class="hljs-params">e,<span class="hljs-string">"POST"</span>,t,s,i,r</span>)})}<span class="hljs-params">function</span> <span class="hljs-params">ey</span>(<span class="hljs-params">e,t,r,s,i</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">ef</span>(<span class="hljs-params">e,<span class="hljs-string">"PUT"</span>,t,s,i,r</span>)})}<span class="hljs-params">function</span> <span class="hljs-params">e_</span>(<span class="hljs-params">e,t,r,s,i</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">ef</span>(<span class="hljs-params">e,<span class="hljs-string">"DELETE"</span>,t,s,i,r</span>)})}<span class="hljs-params">class</span> <span class="hljs-params">ew</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">this</span>.<span class="hljs-params">downloadFn</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=<span class="hljs-params">t</span>}<span class="hljs-params">then</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">execute</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">e,t</span>)}<span class="hljs-params">execute</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">this</span>.downloadFn(</span>)).<span class="hljs-params">body</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}}<span class="hljs-params">E</span>=<span class="hljs-params">Symbol</span>.<span class="hljs-params">toStringTag</span>;<span class="hljs-params">let</span> <span class="hljs-params">em</span>=<span class="hljs-params">class</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">this</span>.<span class="hljs-params">downloadFn</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>[<span class="hljs-params">E</span>]="<span class="hljs-params">BlobDownloadBuilder</span>",<span class="hljs-params">this</span>.<span class="hljs-params">promise</span>=<span class="hljs-params">null</span>}<span class="hljs-params">asStream</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">ew</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.downloadFn,<span class="hljs-keyword">this</span>.shouldThrowOnError</span>)}<span class="hljs-params">then</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">getPromise</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">e,t</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">getPromise</span><span class="hljs-params">()</span>.<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">finally</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">getPromise</span><span class="hljs-params">()</span>.<span class="hljs-params">finally</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">getPromise</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">promise</span>||(<span class="hljs-params"><span class="hljs-keyword">this</span>.promise=<span class="hljs-keyword">this</span>.execute(</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">promise</span>}<span class="hljs-params">execute</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">yield</span> <span class="hljs-params">this</span>.<span class="hljs-params">downloadFn</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">e</span>.<span class="hljs-params">blob</span><span class="hljs-params">()</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}},<span class="hljs-params">eb</span>={<span class="hljs-params">limit</span>:100,<span class="hljs-params">offset</span>:0,<span class="hljs-params">sortBy</span>:{<span class="hljs-params">column</span>:"<span class="hljs-params">name</span>",<span class="hljs-params">order</span>:"<span class="hljs-params">asc</span>"}},<span class="hljs-params">ev</span>={<span class="hljs-params">cacheControl</span>:"3600",<span class="hljs-params">contentType</span>:"<span class="hljs-params">text</span>/<span class="hljs-params">plain</span>;<span class="hljs-params">charset</span>=<span class="hljs-params">UTF</span>-8",<span class="hljs-params">upsert</span>:!1};<span class="hljs-params">class</span> <span class="hljs-params">eS</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={},r,s</span>){<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">bucketId</span>=<span class="hljs-params">r</span>,<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">eu</span>(<span class="hljs-params">s</span>)}<span class="hljs-params">throwOnError</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!0,<span class="hljs-params">this</span>}<span class="hljs-params">uploadOrUpdate</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">i</span>,<span class="hljs-params">n</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},ev</span>),<span class="hljs-params">s</span>),<span class="hljs-params">a</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},<span class="hljs-keyword">this</span>.headers</span>),"<span class="hljs-params">POST</span>"===<span class="hljs-params">e</span>&amp;&amp;{"<span class="hljs-params">x</span>-<span class="hljs-params">upsert</span>":<span class="hljs-params">String</span>(<span class="hljs-params">n.upsert</span>)}),<span class="hljs-params">o</span>=<span class="hljs-params">n</span>.<span class="hljs-params">metadata</span>;"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">Blob</span>&amp;&amp;<span class="hljs-params">r</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">Blob</span>?(<span class="hljs-params">(i=<span class="hljs-keyword">new</span> FormData</span>).<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"cacheControl"</span>,n.cacheControl</span>),<span class="hljs-params">o</span>&amp;&amp;<span class="hljs-params">i</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"metadata"</span>,<span class="hljs-keyword">this</span>.encodeMetadata(o</span>)),<span class="hljs-params">i</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">""</span>,r</span>)):"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">FormData</span>&amp;&amp;<span class="hljs-params">r</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">FormData</span>?(<span class="hljs-params">(i=r</span>).<span class="hljs-params">has</span>(<span class="hljs-params"><span class="hljs-string">"cacheControl"</span></span>)||<span class="hljs-params">i</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"cacheControl"</span>,n.cacheControl</span>),<span class="hljs-params">o</span>&amp;&amp;!<span class="hljs-params">i</span>.<span class="hljs-params">has</span>(<span class="hljs-params"><span class="hljs-string">"metadata"</span></span>)&amp;&amp;<span class="hljs-params">i</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"metadata"</span>,<span class="hljs-keyword">this</span>.encodeMetadata(o</span>))):(<span class="hljs-params">i=r,a[<span class="hljs-string">"cache-control"</span>]=<span class="hljs-string">`max-age=<span class="hljs-subst">${n.cacheControl}</span>`</span>,a[<span class="hljs-string">"content-type"</span>]=n.contentType,o&amp;&amp;(a[<span class="hljs-string">"x-metadata"</span>]=<span class="hljs-keyword">this</span>.toBase64(<span class="hljs-keyword">this</span>.encodeMetadata(o</span>))),(<span class="hljs-params"><span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> ReadableStream&amp;&amp;i <span class="hljs-keyword">instanceof</span> ReadableStream||i&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> i&amp;&amp;<span class="hljs-string">"pipe"</span><span class="hljs-keyword">in</span> i&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> i.pipe</span>)&amp;&amp;!<span class="hljs-params">n</span>.<span class="hljs-params">duplex</span>&amp;&amp;(<span class="hljs-params">n.duplex=<span class="hljs-string">"half"</span></span>)),(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>)&amp;&amp;(<span class="hljs-params">a=<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},a</span>),<span class="hljs-params">s</span>.<span class="hljs-params">headers</span>));<span class="hljs-params">let</span> <span class="hljs-params">l</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_removeEmptyFolders</span>(<span class="hljs-params">t</span>),<span class="hljs-params">h</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">l</span>),<span class="hljs-params">u</span>=<span class="hljs-params">yield</span>(<span class="hljs-params"><span class="hljs-string">"PUT"</span>==e?ey:eg</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/<span class="hljs-subst">${h}</span>`</span>,i,<span class="hljs-built_in">Object</span>.assign({headers:a},(<span class="hljs-literal">null</span>==n?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.duplex</span>)?{<span class="hljs-params">duplex</span>:<span class="hljs-params">n</span>.<span class="hljs-params">duplex</span>}:{}));<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">path</span>:<span class="hljs-params">l</span>,<span class="hljs-params">id</span>:<span class="hljs-params">u</span>.<span class="hljs-params">Id</span>,<span class="hljs-params">fullPath</span>:<span class="hljs-params">u</span>.<span class="hljs-params">Key</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">upload</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">uploadOrUpdate</span>(<span class="hljs-params"><span class="hljs-string">"POST"</span>,e,t,r</span>)})}<span class="hljs-params">uploadToSignedUrl</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_removeEmptyFolders</span>(<span class="hljs-params">e</span>),<span class="hljs-params">n</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">i</span>),<span class="hljs-params">a</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url+<span class="hljs-string">`/object/upload/sign/<span class="hljs-subst">${n}</span>`</span></span>);<span class="hljs-params">a</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"token"</span>,t</span>);<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>,<span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{upsert:ev.upsert},s</span>),<span class="hljs-params">n</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},<span class="hljs-keyword">this</span>.headers</span>),{"<span class="hljs-params">x</span>-<span class="hljs-params">upsert</span>":<span class="hljs-params">String</span>(<span class="hljs-params">t.upsert</span>)});"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">Blob</span>&amp;&amp;<span class="hljs-params">r</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">Blob</span>?(<span class="hljs-params">(e=<span class="hljs-keyword">new</span> FormData</span>).<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"cacheControl"</span>,t.cacheControl</span>),<span class="hljs-params">e</span>.<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">""</span>,r</span>)):"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">FormData</span>&amp;&amp;<span class="hljs-params">r</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">FormData</span>?(<span class="hljs-params">e=r</span>).<span class="hljs-params">append</span>(<span class="hljs-params"><span class="hljs-string">"cacheControl"</span>,t.cacheControl</span>):(<span class="hljs-params">e=r,n[<span class="hljs-string">"cache-control"</span>]=<span class="hljs-string">`max-age=<span class="hljs-subst">${t.cacheControl}</span>`</span>,n[<span class="hljs-string">"content-type"</span>]=t.contentType</span>);<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">yield</span> <span class="hljs-params">ey</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,a.toString(</span>),<span class="hljs-params">e</span>,{<span class="hljs-params">headers</span>:<span class="hljs-params">n</span>});<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">path</span>:<span class="hljs-params">i</span>,<span class="hljs-params">fullPath</span>:<span class="hljs-params">o</span>.<span class="hljs-params">Key</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">createSignedUploadUrl</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>),<span class="hljs-params">s</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{},<span class="hljs-keyword">this</span>.headers</span>);(<span class="hljs-params"><span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.upsert</span>)&amp;&amp;(<span class="hljs-params">s[<span class="hljs-string">"x-upsert"</span>]=<span class="hljs-string">"true"</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/upload/sign/<span class="hljs-subst">${r}</span>`</span>,{},{headers:s}</span>),<span class="hljs-params">n</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url+i.url</span>),<span class="hljs-params">a</span>=<span class="hljs-params">n</span>.<span class="hljs-params">searchParams</span>.<span class="hljs-params">get</span>(<span class="hljs-params"><span class="hljs-string">"token"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params">!a</span>)<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">ea</span>(<span class="hljs-params"><span class="hljs-string">"No token returned by API"</span></span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">signedUrl</span>:<span class="hljs-params">n</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>,<span class="hljs-params">path</span>:<span class="hljs-params">e</span>,<span class="hljs-params">token</span>:<span class="hljs-params">a</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">update</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">uploadOrUpdate</span>(<span class="hljs-params"><span class="hljs-string">"PUT"</span>,e,t,r</span>)})}<span class="hljs-params">move</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/move`</span>,{bucketId:<span class="hljs-keyword">this</span>.bucketId,sourceKey:e,destinationKey:t,destinationBucket:<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.destinationBucket},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">copy</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">path</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> eg(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/copy`</span>,{bucketId:<span class="hljs-keyword">this</span>.bucketId,sourceKey:e,destinationKey:t,destinationBucket:<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.destinationBucket},{headers:<span class="hljs-keyword">this</span>.headers}</span>)).<span class="hljs-params">Key</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">createSignedUrl</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>),<span class="hljs-params">i</span>=<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/sign/<span class="hljs-subst">${s}</span>`</span>,<span class="hljs-built_in">Object</span>.assign({expiresIn:t},(<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.transform</span>)?{<span class="hljs-params">transform</span>:<span class="hljs-params">r</span>.<span class="hljs-params">transform</span>}:{}),{<span class="hljs-params">headers</span>:<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>}),<span class="hljs-params">n</span>=(<span class="hljs-params"><span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.download</span>)?`&amp;<span class="hljs-params">download</span>=<span class="hljs-params">$</span>{!0===<span class="hljs-params">r</span>.<span class="hljs-params">download</span>?"":<span class="hljs-params">r</span>.<span class="hljs-params">download</span>}`:"";<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">i</span>={<span class="hljs-params">signedUrl</span>:<span class="hljs-params">encodeURI</span>(<span class="hljs-params"><span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span><span class="hljs-subst">${i.signedURL}</span><span class="hljs-subst">${n}</span>`</span></span>)},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">createSignedUrls</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/sign/<span class="hljs-subst">${<span class="hljs-keyword">this</span>.bucketId}</span>`</span>,{expiresIn:t,paths:e},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">i</span>=(<span class="hljs-params"><span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.download</span>)?`&amp;<span class="hljs-params">download</span>=<span class="hljs-params">$</span>{!0===<span class="hljs-params">r</span>.<span class="hljs-params">download</span>?"":<span class="hljs-params">r</span>.<span class="hljs-params">download</span>}`:"";<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">s</span>.<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">signedUrl</span>:<span class="hljs-params">e</span>.<span class="hljs-params">signedURL</span>?<span class="hljs-params">encodeURI</span>(<span class="hljs-params"><span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span><span class="hljs-subst">${e.signedURL}</span><span class="hljs-subst">${i}</span>`</span></span>):<span class="hljs-params">null</span>})),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">download</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">void</span> 0!==(<span class="hljs-params"><span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.transform</span>)?"<span class="hljs-params">render</span>/<span class="hljs-params">image</span>/<span class="hljs-params">authenticated</span>":"<span class="hljs-params">object</span>",<span class="hljs-params">s</span>=<span class="hljs-params">this</span>.<span class="hljs-params">transformOptsToQueryString</span>(<span class="hljs-params">(<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.transform</span>)||{}),<span class="hljs-params">i</span>=<span class="hljs-params">s</span>?`?<span class="hljs-params">$</span>{<span class="hljs-params">s</span>}`:"",<span class="hljs-params">n</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">em</span>(<span class="hljs-params">(</span>)=&gt;</span>ep(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/<span class="hljs-subst">${r}</span>/<span class="hljs-subst">${n}</span><span class="hljs-subst">${i}</span>`</span>,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">noResolveJson</span>:!<span class="hljs-number">0</span>}),<span class="hljs-keyword">this</span>.shouldThrowOnError)}info(e){<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>);<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">yield</span> <span class="hljs-params">ep</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/info/<span class="hljs-subst">${t}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers}</span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">ec</span>(<span class="hljs-params">e</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">exists</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">yield</span> <span class="hljs-params">function</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">ef</span>(<span class="hljs-params">e,<span class="hljs-string">"HEAD"</span>,t,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},r</span>),{<span class="hljs-params">noResolveJson</span>:!0}),<span class="hljs-params">void</span> 0)})}(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/<span class="hljs-subst">${t}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers}</span>),{<span class="hljs-params">data</span>:!0,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>)&amp;&amp;<span class="hljs-params">e</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">eh</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">originalError</span>;<span class="hljs-params">if</span>(<span class="hljs-params">[<span class="hljs-number">400</span>,<span class="hljs-number">404</span>].includes(<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.status</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:!1,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>}}<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">getPublicUrl</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>),<span class="hljs-params">s</span>=[],<span class="hljs-params">i</span>=(<span class="hljs-params"><span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.download</span>)?`<span class="hljs-params">download</span>=<span class="hljs-params">$</span>{!0===<span class="hljs-params">t</span>.<span class="hljs-params">download</span>?"":<span class="hljs-params">t</span>.<span class="hljs-params">download</span>}`:"";""!==<span class="hljs-params">i</span>&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params">i</span>);<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">void</span> 0!==(<span class="hljs-params"><span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.transform</span>),<span class="hljs-params">a</span>=<span class="hljs-params">this</span>.<span class="hljs-params">transformOptsToQueryString</span>(<span class="hljs-params">(<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.transform</span>)||{});""!==<span class="hljs-params">a</span>&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params">a</span>);<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">s</span>.<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">"&amp;"</span></span>);<span class="hljs-params">return</span>""!==<span class="hljs-params">o</span>&amp;&amp;(<span class="hljs-params">o=<span class="hljs-string">`?<span class="hljs-subst">${o}</span>`</span></span>),{<span class="hljs-params">data</span>:{<span class="hljs-params">publicUrl</span>:<span class="hljs-params">encodeURI</span>(<span class="hljs-params"><span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/<span class="hljs-subst">${n?<span class="hljs-string">"render/image"</span>:<span class="hljs-string">"object"</span>}</span>/public/<span class="hljs-subst">${r}</span><span class="hljs-subst">${o}</span>`</span></span>)}}}<span class="hljs-params">remove</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">e_</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/<span class="hljs-subst">${<span class="hljs-keyword">this</span>.bucketId}</span>`</span>,{prefixes:e},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">list</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},eb</span>),<span class="hljs-params">t</span>),{<span class="hljs-params">prefix</span>:<span class="hljs-params">e</span>||""});<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/list/<span class="hljs-subst">${<span class="hljs-keyword">this</span>.bucketId}</span>`</span>,s,{headers:<span class="hljs-keyword">this</span>.headers},r</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">listV2</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{},e</span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/object/list-v2/<span class="hljs-subst">${<span class="hljs-keyword">this</span>.bucketId}</span>`</span>,r,{headers:<span class="hljs-keyword">this</span>.headers},t</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">encodeMetadata</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">JSON</span>.<span class="hljs-params">stringify</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">toBase64</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">Buffer</span>?<span class="hljs-params">Buffer</span>.<span class="hljs-params">from</span>(<span class="hljs-params">e</span>).<span class="hljs-params">toString</span>(<span class="hljs-params"><span class="hljs-string">"base64"</span></span>):<span class="hljs-params">btoa</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">_getFinalPath</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>`<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">bucketId</span>}/<span class="hljs-params">$</span>{<span class="hljs-params">e</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/^\/+/</span>,<span class="hljs-string">""</span></span>)}`}<span class="hljs-params">_removeEmptyFolders</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/^\/|\/$/g</span>,<span class="hljs-string">""</span></span>).<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\/+/g</span>,<span class="hljs-string">"/"</span></span>)}<span class="hljs-params">transformOptsToQueryString</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=[];<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">width</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`width=<span class="hljs-subst">${e.width}</span>`</span></span>),<span class="hljs-params">e</span>.<span class="hljs-params">height</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`height=<span class="hljs-subst">${e.height}</span>`</span></span>),<span class="hljs-params">e</span>.<span class="hljs-params">resize</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`resize=<span class="hljs-subst">${e.resize}</span>`</span></span>),<span class="hljs-params">e</span>.<span class="hljs-params">format</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`format=<span class="hljs-subst">${e.format}</span>`</span></span>),<span class="hljs-params">e</span>.<span class="hljs-params">quality</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`quality=<span class="hljs-subst">${e.quality}</span>`</span></span>),<span class="hljs-params">t</span>.<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">"&amp;"</span></span>)}}<span class="hljs-params">let</span> <span class="hljs-params">ek</span>="2.83.0",<span class="hljs-params">eE</span>={"<span class="hljs-params">X</span>-<span class="hljs-params">Client</span>-<span class="hljs-params">Info</span>":`<span class="hljs-params">storage</span>-<span class="hljs-params">js</span>/<span class="hljs-params">$</span>{<span class="hljs-params">ek</span>}`};<span class="hljs-params">class</span> <span class="hljs-params">eO</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={},r,s</span>){<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!1;<span class="hljs-params">const</span> <span class="hljs-params">i</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params">e</span>);(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.useNewHostname</span>)&amp;&amp;/<span class="hljs-params">supabase</span>\.(<span class="hljs-params">co|<span class="hljs-keyword">in</span>|red</span>)<span class="hljs-params">$</span>/.<span class="hljs-params">test</span>(<span class="hljs-params">i.hostname</span>)&amp;&amp;!<span class="hljs-params">i</span>.<span class="hljs-params">hostname</span>.<span class="hljs-params">includes</span>(<span class="hljs-params"><span class="hljs-string">"storage.supabase."</span></span>)&amp;&amp;(<span class="hljs-params">i.hostname=i.hostname.replace(<span class="hljs-string">"supabase."</span>,<span class="hljs-string">"storage.supabase."</span></span>)),<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">i</span>.<span class="hljs-params">href</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\/$/</span>,<span class="hljs-string">""</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},eE</span>),<span class="hljs-params">t</span>),<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">eu</span>(<span class="hljs-params">r</span>)}<span class="hljs-params">throwOnError</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!0,<span class="hljs-params">this</span>}<span class="hljs-params">listBuckets</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">this</span>.<span class="hljs-params">listBucketOptionsToQueryString</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ep</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket<span class="hljs-subst">${t}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">getBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ep</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket/<span class="hljs-subst">${e}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">createBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(e,t={public:!<span class="hljs-number">1</span>}</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket`</span>,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">updateBucket</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ey</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket/<span class="hljs-subst">${e}</span>`</span>,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">emptyBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket/<span class="hljs-subst">${e}</span>/empty`</span>,{},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">deleteBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">e_</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket/<span class="hljs-subst">${e}</span>`</span>,{},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">listBucketOptionsToQueryString</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>={};<span class="hljs-params">return</span> <span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-string">"limit"</span><span class="hljs-keyword">in</span> e&amp;&amp;(t.limit=<span class="hljs-built_in">String</span>(e.limit</span>)),"<span class="hljs-params">offset</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params">t.offset=<span class="hljs-built_in">String</span>(e.offset</span>)),<span class="hljs-params">e</span>.<span class="hljs-params">search</span>&amp;&amp;(<span class="hljs-params">t.search=e.search</span>),<span class="hljs-params">e</span>.<span class="hljs-params">sortColumn</span>&amp;&amp;(<span class="hljs-params">t.sortColumn=e.sortColumn</span>),<span class="hljs-params">e</span>.<span class="hljs-params">sortOrder</span>&amp;&amp;(<span class="hljs-params">t.sortOrder=e.sortOrder</span>)),<span class="hljs-params">Object</span>.<span class="hljs-params">keys</span>(<span class="hljs-params">t</span>).<span class="hljs-params">length</span>&gt;0?"?"+<span class="hljs-params">new</span> <span class="hljs-params">URLSearchParams</span>(<span class="hljs-params">t</span>).<span class="hljs-params">toString</span><span class="hljs-params">()</span>:""}}<span class="hljs-params">class</span> <span class="hljs-params">eT</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={},r</span>){<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">e</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\/$/</span>,<span class="hljs-string">""</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},eE</span>),<span class="hljs-params">t</span>),<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">eu</span>(<span class="hljs-params">r</span>)}<span class="hljs-params">throwOnError</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!0,<span class="hljs-params">this</span>}<span class="hljs-params">createBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">eg</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket`</span>,{name:e},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">listBuckets</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">new</span> <span class="hljs-params">URLSearchParams</span>;(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.limit</span>)!==<span class="hljs-params">void</span> 0&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"limit"</span>,e.limit.toString(</span>)),(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.offset</span>)!==<span class="hljs-params">void</span> 0&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"offset"</span>,e.offset.toString(</span>)),(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.sortColumn</span>)&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"sortColumn"</span>,e.sortColumn</span>),(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.sortOrder</span>)&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"sortOrder"</span>,e.sortOrder</span>),(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.search</span>)&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"search"</span>,e.search</span>);<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">t</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>,<span class="hljs-params">s</span>=<span class="hljs-params">r</span>?`<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">url</span>}/<span class="hljs-params">bucket</span>?<span class="hljs-params">$</span>{<span class="hljs-params">r</span>}`:`<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">url</span>}/<span class="hljs-params">bucket</span>`;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ep</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,s,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">deleteBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">e_</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/bucket/<span class="hljs-subst">${e}</span>`</span>,{},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eo(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}}<span class="hljs-params">let</span> <span class="hljs-params">ej</span>={"<span class="hljs-params">X</span>-<span class="hljs-params">Client</span>-<span class="hljs-params">Info</span>":`<span class="hljs-params">storage</span>-<span class="hljs-params">js</span>/<span class="hljs-params">$</span>{<span class="hljs-params">ek</span>}`,"<span class="hljs-params">Content</span>-<span class="hljs-params">Type</span>":"<span class="hljs-params">application</span>/<span class="hljs-params">json</span>"};<span class="hljs-params">class</span> <span class="hljs-params">eR</span> <span class="hljs-params">extends</span> <span class="hljs-params">Error</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">__isStorageVectorsError</span>=!0,<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">StorageVectorsError</span>"}}<span class="hljs-params">function</span> <span class="hljs-params">eA</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">null</span>!==<span class="hljs-params">e</span>&amp;&amp;"<span class="hljs-params">__isStorageVectorsError</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>}<span class="hljs-params">class</span> <span class="hljs-params">eP</span> <span class="hljs-params">extends</span> <span class="hljs-params">eR</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">StorageVectorsApiError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">status</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">statusCode</span>=<span class="hljs-params">r</span>}<span class="hljs-params">toJSON</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>{<span class="hljs-params">name</span>:<span class="hljs-params">this</span>.<span class="hljs-params">name</span>,<span class="hljs-params">message</span>:<span class="hljs-params">this</span>.<span class="hljs-params">message</span>,<span class="hljs-params">status</span>:<span class="hljs-params">this</span>.<span class="hljs-params">status</span>,<span class="hljs-params">statusCode</span>:<span class="hljs-params">this</span>.<span class="hljs-params">statusCode</span>}}}<span class="hljs-params">class</span> <span class="hljs-params">eI</span> <span class="hljs-params">extends</span> <span class="hljs-params">eR</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">StorageVectorsUnknownError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">originalError</span>=<span class="hljs-params">t</span>}}(<span class="hljs-params">d=O||(O={}</span>)).<span class="hljs-params">InternalError</span>="<span class="hljs-params">InternalError</span>",<span class="hljs-params">d</span>.<span class="hljs-params">S3VectorConflictException</span>="<span class="hljs-params">S3VectorConflictException</span>",<span class="hljs-params">d</span>.<span class="hljs-params">S3VectorNotFoundException</span>="<span class="hljs-params">S3VectorNotFoundException</span>",<span class="hljs-params">d</span>.<span class="hljs-params">S3VectorBucketNotEmpty</span>="<span class="hljs-params">S3VectorBucketNotEmpty</span>",<span class="hljs-params">d</span>.<span class="hljs-params">S3VectorMaxBucketsExceeded</span>="<span class="hljs-params">S3VectorMaxBucketsExceeded</span>",<span class="hljs-params">d</span>.<span class="hljs-params">S3VectorMaxIndexesExceeded</span>="<span class="hljs-params">S3VectorMaxIndexesExceeded</span>";<span class="hljs-params">let</span> <span class="hljs-params">e$</span>=<span class="hljs-params">e</span>=&gt;</span>e?<span class="hljs-function">(<span class="hljs-params">...t</span>)=&gt;</span>e(...t):<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>fetch(...e),eC=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.msg||e.message||e.error_description||e.error||<span class="hljs-built_in">JSON</span>.stringify(e);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ex</span>(<span class="hljs-params">e,t,r,s,i</span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">function</span>(<span class="hljs-params">e,t,r,s,i,n</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Promise</span>(<span class="hljs-params">(a,o</span>)=&gt;</span>{<span class="hljs-keyword">let</span> l;e(r,(l={<span class="hljs-attr">method</span>:t,<span class="hljs-attr">headers</span>:<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>)||{}},"<span class="hljs-params">GET</span>"===<span class="hljs-params">t</span>||!<span class="hljs-params">n</span>?<span class="hljs-params">l</span>:(<span class="hljs-params">(e=&gt;{<span class="hljs-keyword">if</span>(<span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> e||<span class="hljs-literal">null</span>===e</span>)<span class="hljs-params">return</span>!1;<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">getPrototypeOf</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>===t||t===<span class="hljs-built_in">Object</span>.prototype||<span class="hljs-literal">null</span>===<span class="hljs-built_in">Object</span>.getPrototypeOf(t</span>))&amp;&amp;!(<span class="hljs-params"><span class="hljs-built_in">Symbol</span>.toStringTag <span class="hljs-keyword">in</span> e</span>)&amp;&amp;!(<span class="hljs-params"><span class="hljs-built_in">Symbol</span>.iterator <span class="hljs-keyword">in</span> e</span>)})(<span class="hljs-params">n</span>)?(<span class="hljs-params">l.headers=<span class="hljs-built_in">Object</span>.assign({<span class="hljs-string">"Content-Type"</span>:<span class="hljs-string">"application/json"</span>},<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>),<span class="hljs-params">l</span>.<span class="hljs-params">body</span>=<span class="hljs-params">JSON</span>.<span class="hljs-params">stringify</span>(<span class="hljs-params">n</span>)):<span class="hljs-params">l</span>.<span class="hljs-params">body</span>=<span class="hljs-params">n</span>,<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},l</span>),<span class="hljs-params">i</span>)))).<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">if</span>(!e.ok</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.noResolveJson</span>)<span class="hljs-params">return</span> <span class="hljs-params">e</span>;<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">get</span>(<span class="hljs-params"><span class="hljs-string">"content-type"</span></span>);<span class="hljs-params">return</span> <span class="hljs-params">t</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">includes</span>(<span class="hljs-params"><span class="hljs-string">"application/json"</span></span>)?<span class="hljs-params">e</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>:{}}).<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;a(e</span>)).<span class="hljs-params">catch</span>(<span class="hljs-params">e=&gt;(<span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!(e&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> e&amp;&amp;<span class="hljs-string">"status"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"ok"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"number"</span>==<span class="hljs-keyword">typeof</span> e.status</span>)||(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.noResolveJson</span>))<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> eI(eC(e</span>),<span class="hljs-params">e</span>));<span class="hljs-params">else</span>{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">status</span>||500;"<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>.<span class="hljs-params">json</span>?<span class="hljs-params">e</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;{<span class="hljs-keyword">let</span> r=(<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.statusCode</span>)||(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.code</span>)||<span class="hljs-params">t</span>+"";<span class="hljs-params">o</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> eP(eC(e</span>),<span class="hljs-params">t</span>,<span class="hljs-params">r</span>))}).<span class="hljs-params">catch</span>(<span class="hljs-params">(</span>)=&gt;</span>{o(<span class="hljs-keyword">new</span> eP(e.statusText||<span class="hljs-string">`HTTP <span class="hljs-subst">${t}</span> error`</span>,t,t+<span class="hljs-string">""</span>))}):o(<span class="hljs-keyword">new</span> eP(e.statusText||<span class="hljs-string">`HTTP <span class="hljs-subst">${t}</span> error`</span>,t,t+<span class="hljs-string">""</span>))}}))})})}(e,<span class="hljs-string">"POST"</span>,t,s,i,r)})}<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eU</span></span>{<span class="hljs-keyword">constructor</span>(e,t={},r){<span class="hljs-keyword">this</span>.shouldThrowOnError=!<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.url=e.replace(<span class="hljs-regexp">/\/$/</span>,<span class="hljs-string">""</span>),<span class="hljs-keyword">this</span>.headers=<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},ej),t),<span class="hljs-keyword">this</span>.fetch=e$(r)}throwOnError(){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.shouldThrowOnError=!<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>}createIndex(e){<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> ex(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/CreateIndex`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>))||{},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">getIndex</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/GetIndex`</span>,{vectorBucketName:e,indexName:t},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">listIndexes</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/ListIndexes`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">deleteIndex</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> ex(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/DeleteIndex`</span>,{vectorBucketName:e,indexName:t},{headers:<span class="hljs-keyword">this</span>.headers}</span>))||{},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}}<span class="hljs-params">class</span> <span class="hljs-params">eN</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={},r</span>){<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">e</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\/$/</span>,<span class="hljs-string">""</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},ej</span>),<span class="hljs-params">t</span>),<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">e$</span>(<span class="hljs-params">r</span>)}<span class="hljs-params">throwOnError</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!0,<span class="hljs-params">this</span>}<span class="hljs-params">putVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">if</span>(<span class="hljs-params">e.vectors.length&lt;<span class="hljs-number">1</span>||e.vectors.length&gt;<span class="hljs-number">500</span></span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Vector batch size must be between 1 and 500 items"</span></span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> ex(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/PutVectors`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>))||{},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">getVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/GetVectors`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">listVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==e.segmentCount</span>){<span class="hljs-params">if</span>(<span class="hljs-params">e.segmentCount&lt;<span class="hljs-number">1</span>||e.segmentCount&gt;<span class="hljs-number">16</span></span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"segmentCount must be between 1 and 16"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==e.segmentIndex&amp;&amp;(e.segmentIndex&lt;<span class="hljs-number">0</span>||e.segmentIndex&gt;=e.segmentCount</span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">`segmentIndex must be between 0 and <span class="hljs-subst">${e.segmentCount<span class="hljs-number">-1</span>}</span>`</span></span>)}<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/ListVectors`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">queryVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/QueryVectors`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">deleteVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">if</span>(<span class="hljs-params">e.keys.length&lt;<span class="hljs-number">1</span>||e.keys.length&gt;<span class="hljs-number">500</span></span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Keys batch size must be between 1 and 500 items"</span></span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> ex(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/DeleteVectors`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>))||{},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}}<span class="hljs-params">class</span> <span class="hljs-params">eD</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={},r</span>){<span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">e</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\/$/</span>,<span class="hljs-string">""</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},ej</span>),<span class="hljs-params">t</span>),<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">e$</span>(<span class="hljs-params">r</span>)}<span class="hljs-params">throwOnError</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">shouldThrowOnError</span>=!0,<span class="hljs-params">this</span>}<span class="hljs-params">createBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> ex(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/CreateVectorBucket`</span>,{vectorBucketName:e},{headers:<span class="hljs-keyword">this</span>.headers}</span>))||{},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">getBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/GetVectorBucket`</span>,{vectorBucketName:e},{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">listBuckets</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(e={}</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">yield</span> <span class="hljs-params">ex</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/ListVectorBuckets`</span>,e,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">deleteBucket</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:(<span class="hljs-params"><span class="hljs-keyword">yield</span> ex(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/DeleteVectorBucket`</span>,{vectorBucketName:e},{headers:<span class="hljs-keyword">this</span>.headers}</span>))||{},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.shouldThrowOnError</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">eA(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}}<span class="hljs-params">class</span> <span class="hljs-params">eB</span> <span class="hljs-params">extends</span> <span class="hljs-params">eD</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={}</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,t.headers||{},t.fetch</span>)}<span class="hljs-params">from</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">eL</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url,<span class="hljs-keyword">this</span>.headers,e,<span class="hljs-keyword">this</span>.fetch</span>)}}<span class="hljs-params">class</span> <span class="hljs-params">eL</span> <span class="hljs-params">extends</span> <span class="hljs-params">eU</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,t,s</span>),<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>=<span class="hljs-params">r</span>}<span class="hljs-params">createIndex</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{createIndex:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.createIndex}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">createIndex</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>}))})}<span class="hljs-params">listIndexes</span><span class="hljs-params">()</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{listIndexes:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.listIndexes}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(t={}</span>){<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">listIndexes</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},t</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>}))})}<span class="hljs-params">getIndex</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{getIndex:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.getIndex}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">getIndex</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.vectorBucketName,e</span>)})}<span class="hljs-params">deleteIndex</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{deleteIndex:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.deleteIndex}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">deleteIndex</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.vectorBucketName,e</span>)})}<span class="hljs-params">index</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">eq</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url,<span class="hljs-keyword">this</span>.headers,<span class="hljs-keyword">this</span>.vectorBucketName,e,<span class="hljs-keyword">this</span>.fetch</span>)}}<span class="hljs-params">class</span> <span class="hljs-params">eq</span> <span class="hljs-params">extends</span> <span class="hljs-params">eN</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r,s,i</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,t,i</span>),<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>=<span class="hljs-params">r</span>,<span class="hljs-params">this</span>.<span class="hljs-params">indexName</span>=<span class="hljs-params">s</span>}<span class="hljs-params">putVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{putVectors:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.putVectors}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">putVectors</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>,<span class="hljs-params">indexName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">indexName</span>}))})}<span class="hljs-params">getVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{getVectors:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.getVectors}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">getVectors</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>,<span class="hljs-params">indexName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">indexName</span>}))})}<span class="hljs-params">listVectors</span><span class="hljs-params">()</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{listVectors:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.listVectors}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(t={}</span>){<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">listVectors</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},t</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>,<span class="hljs-params">indexName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">indexName</span>}))})}<span class="hljs-params">queryVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{queryVectors:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.queryVectors}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">queryVectors</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>,<span class="hljs-params">indexName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">indexName</span>}))})}<span class="hljs-params">deleteVectors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">create</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,{deleteVectors:{get:(</span>)=&gt;</span><span class="hljs-keyword">super</span>.deleteVectors}});<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>,T.__awaiter</span>)(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>*(</span>){<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">deleteVectors</span>.<span class="hljs-params">call</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">vectorBucketName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">vectorBucketName</span>,<span class="hljs-params">indexName</span>:<span class="hljs-params">this</span>.<span class="hljs-params">indexName</span>}))})}}<span class="hljs-params">class</span> <span class="hljs-params">eK</span> <span class="hljs-params">extends</span> <span class="hljs-params">eO</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t={},r,s</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,t,r,s</span>)}<span class="hljs-params">from</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">eS</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url,<span class="hljs-keyword">this</span>.headers,e,<span class="hljs-keyword">this</span>.fetch</span>)}<span class="hljs-params">get</span> <span class="hljs-params">vectors</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">eB</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url+<span class="hljs-string">"/vector"</span>,{headers:<span class="hljs-keyword">this</span>.headers,fetch:<span class="hljs-keyword">this</span>.fetch}</span>)}<span class="hljs-params">get</span> <span class="hljs-params">analytics</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">eT</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.url+<span class="hljs-string">"/iceberg"</span>,<span class="hljs-keyword">this</span>.headers,<span class="hljs-keyword">this</span>.fetch</span>)}}<span class="hljs-params">let</span> <span class="hljs-params">eW</span>="";<span class="hljs-params">eW</span>="<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">Deno</span>?"<span class="hljs-params">deno</span>":"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">document</span>?"<span class="hljs-params">web</span>":"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">navigator</span>&amp;&amp;"<span class="hljs-params">ReactNative</span>"===<span class="hljs-params">navigator</span>.<span class="hljs-params">product</span>?"<span class="hljs-params">react</span>-<span class="hljs-params">native</span>":"<span class="hljs-params">node</span>";<span class="hljs-params">let</span> <span class="hljs-params">eV</span>={<span class="hljs-params">headers</span>:{"<span class="hljs-params">X</span>-<span class="hljs-params">Client</span>-<span class="hljs-params">Info</span>":`<span class="hljs-params">supabase</span>-<span class="hljs-params">js</span>-<span class="hljs-params">$</span>{<span class="hljs-params">eW</span>}/2.83.0`}},<span class="hljs-params">eH</span>={<span class="hljs-params">schema</span>:"<span class="hljs-params">public</span>"},<span class="hljs-params">eM</span>={<span class="hljs-params">autoRefreshToken</span>:!0,<span class="hljs-params">persistSession</span>:!0,<span class="hljs-params">detectSessionInUrl</span>:!0,<span class="hljs-params">flowType</span>:"<span class="hljs-params">implicit</span>"},<span class="hljs-params">eJ</span>={},<span class="hljs-params">eG</span>="2.83.0",<span class="hljs-params">eF</span>={"<span class="hljs-params">X</span>-<span class="hljs-params">Client</span>-<span class="hljs-params">Info</span>":`<span class="hljs-params">gotrue</span>-<span class="hljs-params">js</span>/<span class="hljs-params">$</span>{<span class="hljs-params">eG</span>}`},<span class="hljs-params">ez</span>="<span class="hljs-params">X</span>-<span class="hljs-params">Supabase</span>-<span class="hljs-params">Api</span>-<span class="hljs-params">Version</span>",<span class="hljs-params">eY</span>={"2024-01-01":{<span class="hljs-params">timestamp</span>:<span class="hljs-params">Date</span>.<span class="hljs-params">parse</span>(<span class="hljs-params"><span class="hljs-string">"2024-01-01T00:00:00.0Z"</span></span>),<span class="hljs-params">name</span>:"2024-01-01"}},<span class="hljs-params">eQ</span>=/^(<span class="hljs-params">[a-z0<span class="hljs-number">-9</span>_-]{<span class="hljs-number">4</span>}</span>)*(<span class="hljs-params">$|[a-z0<span class="hljs-number">-9</span>_-]{<span class="hljs-number">3</span>}$|[a-z0<span class="hljs-number">-9</span>_-]{<span class="hljs-number">2</span>}$</span>)<span class="hljs-params">$</span>/<span class="hljs-params">i</span>;<span class="hljs-params">class</span> <span class="hljs-params">eX</span> <span class="hljs-params">extends</span> <span class="hljs-params">Error</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">__isAuthError</span>=!0,<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">AuthError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">status</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">code</span>=<span class="hljs-params">r</span>}}<span class="hljs-params">function</span> <span class="hljs-params">eZ</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>&amp;&amp;<span class="hljs-params">null</span>!==<span class="hljs-params">e</span>&amp;&amp;"<span class="hljs-params">__isAuthError</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>}<span class="hljs-params">class</span> <span class="hljs-params">e0</span> <span class="hljs-params">extends</span> <span class="hljs-params">eX</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,t,r</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">AuthApiError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">status</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">code</span>=<span class="hljs-params">r</span>}}<span class="hljs-params">class</span> <span class="hljs-params">e1</span> <span class="hljs-params">extends</span> <span class="hljs-params">eX</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">AuthUnknownError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">originalError</span>=<span class="hljs-params">t</span>}}<span class="hljs-params">class</span> <span class="hljs-params">e8</span> <span class="hljs-params">extends</span> <span class="hljs-params">eX</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r,s</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,r,s</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">status</span>=<span class="hljs-params">r</span>}}<span class="hljs-params">class</span> <span class="hljs-params">e2</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span><span class="hljs-params">()</span>{<span class="hljs-params">super</span>(<span class="hljs-params"><span class="hljs-string">"Auth session missing!"</span>,<span class="hljs-string">"AuthSessionMissingError"</span>,<span class="hljs-number">400</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>)}}<span class="hljs-params">class</span> <span class="hljs-params">e3</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span><span class="hljs-params">()</span>{<span class="hljs-params">super</span>(<span class="hljs-params"><span class="hljs-string">"Auth session or user missing"</span>,<span class="hljs-string">"AuthInvalidTokenResponseError"</span>,<span class="hljs-number">500</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>)}}<span class="hljs-params">class</span> <span class="hljs-params">e6</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,<span class="hljs-string">"AuthInvalidCredentialsError"</span>,<span class="hljs-number">400</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>)}}<span class="hljs-params">class</span> <span class="hljs-params">e4</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t=<span class="hljs-literal">null</span></span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,<span class="hljs-string">"AuthImplicitGrantRedirectError"</span>,<span class="hljs-number">500</span>,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">details</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">details</span>=<span class="hljs-params">t</span>}<span class="hljs-params">toJSON</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>{<span class="hljs-params">name</span>:<span class="hljs-params">this</span>.<span class="hljs-params">name</span>,<span class="hljs-params">message</span>:<span class="hljs-params">this</span>.<span class="hljs-params">message</span>,<span class="hljs-params">status</span>:<span class="hljs-params">this</span>.<span class="hljs-params">status</span>,<span class="hljs-params">details</span>:<span class="hljs-params">this</span>.<span class="hljs-params">details</span>}}}<span class="hljs-params">class</span> <span class="hljs-params">e5</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,<span class="hljs-string">"AuthRetryableFetchError"</span>,t,<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>)}}<span class="hljs-params">function</span> <span class="hljs-params">e9</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">eZ</span>(<span class="hljs-params">e</span>)&amp;&amp;"<span class="hljs-params">AuthRetryableFetchError</span>"===<span class="hljs-params">e</span>.<span class="hljs-params">name</span>}<span class="hljs-params">class</span> <span class="hljs-params">e7</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,<span class="hljs-string">"AuthWeakPasswordError"</span>,t,<span class="hljs-string">"weak_password"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">reasons</span>=<span class="hljs-params">r</span>}}<span class="hljs-params">class</span> <span class="hljs-params">te</span> <span class="hljs-params">extends</span> <span class="hljs-params">e8</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e,<span class="hljs-string">"AuthInvalidJwtError"</span>,<span class="hljs-number">400</span>,<span class="hljs-string">"invalid_jwt"</span></span>)}}<span class="hljs-params">let</span> <span class="hljs-params">tt</span>="<span class="hljs-params">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span>-<span class="hljs-params">_</span>".<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>),<span class="hljs-params">tr</span>=" 	\<span class="hljs-params">n</span>\<span class="hljs-params">r</span>=".<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>),<span class="hljs-params">ts</span>=(<span class="hljs-params">(</span>)=&gt;</span>{<span class="hljs-keyword">let</span> e=<span class="hljs-built_in">Array</span>(<span class="hljs-number">128</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> t=<span class="hljs-number">0</span>;t&lt;e.length;t+=<span class="hljs-number">1</span>)e[t]=<span class="hljs-number">-1</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> t=<span class="hljs-number">0</span>;t&lt;tr.length;t+=<span class="hljs-number">1</span>)e[tr[t].charCodeAt(<span class="hljs-number">0</span>)]=<span class="hljs-number">-2</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> t=<span class="hljs-number">0</span>;t&lt;tt.length;t+=<span class="hljs-number">1</span>)e[tt[t].charCodeAt(<span class="hljs-number">0</span>)]=t;<span class="hljs-keyword">return</span> e})();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ti</span>(<span class="hljs-params">e,t,r</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>!==e)<span class="hljs-keyword">for</span>(t.queue=t.queue&lt;&lt;<span class="hljs-number">8</span>|e,t.queuedBits+=<span class="hljs-number">8</span>;t.queuedBits&gt;=<span class="hljs-number">6</span>;)r(tt[t.queue&gt;&gt;t.queuedBits<span class="hljs-number">-6</span>&amp;<span class="hljs-number">63</span>]),t.queuedBits-=<span class="hljs-number">6</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(t.queuedBits&gt;<span class="hljs-number">0</span>)<span class="hljs-keyword">for</span>(t.queue=t.queue&lt;&lt;<span class="hljs-number">6</span>-t.queuedBits,t.queuedBits=<span class="hljs-number">6</span>;t.queuedBits&gt;=<span class="hljs-number">6</span>;)r(tt[t.queue&gt;&gt;t.queuedBits<span class="hljs-number">-6</span>&amp;<span class="hljs-number">63</span>]),t.queuedBits-=<span class="hljs-number">6</span>}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tn</span>(<span class="hljs-params">e,t,r</span>)</span>{<span class="hljs-keyword">let</span> s=ts[e];<span class="hljs-keyword">if</span>(s&gt;<span class="hljs-number">-1</span>)<span class="hljs-keyword">for</span>(t.queue=t.queue&lt;&lt;<span class="hljs-number">6</span>|s,t.queuedBits+=<span class="hljs-number">6</span>;t.queuedBits&gt;=<span class="hljs-number">8</span>;)r(t.queue&gt;&gt;t.queuedBits<span class="hljs-number">-8</span>&amp;<span class="hljs-number">255</span>),t.queuedBits-=<span class="hljs-number">8</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-number">-2</span>===s)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Invalid Base64-URL character "<span class="hljs-subst">${<span class="hljs-built_in">String</span>.fromCharCode(e)}</span>"`</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ta</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">let</span> t=[],r=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{t.push(<span class="hljs-built_in">String</span>.fromCodePoint(e))},s={<span class="hljs-attr">utf8seq</span>:<span class="hljs-number">0</span>,<span class="hljs-attr">codepoint</span>:<span class="hljs-number">0</span>},i={<span class="hljs-attr">queue</span>:<span class="hljs-number">0</span>,<span class="hljs-attr">queuedBits</span>:<span class="hljs-number">0</span>},n=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{!<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e,t,r</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===t.utf8seq){<span class="hljs-keyword">if</span>(e&lt;=<span class="hljs-number">127</span>)<span class="hljs-keyword">return</span> r(e);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> r=<span class="hljs-number">1</span>;r&lt;<span class="hljs-number">6</span>;r+=<span class="hljs-number">1</span>)<span class="hljs-keyword">if</span>(<span class="hljs-function">(<span class="hljs-params">e&gt;&gt;<span class="hljs-number">7</span>-r&amp;<span class="hljs-number">1</span></span>)==0){<span class="hljs-params">t</span>.<span class="hljs-params">utf8seq</span>=<span class="hljs-params">r</span>;<span class="hljs-params">break</span>}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">2</span>===t.utf8seq</span>)<span class="hljs-params">t</span>.<span class="hljs-params">codepoint</span>=31&amp;<span class="hljs-params">e</span>;<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">3</span>===t.utf8seq</span>)<span class="hljs-params">t</span>.<span class="hljs-params">codepoint</span>=15&amp;<span class="hljs-params">e</span>;<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">4</span>===t.utf8seq</span>)<span class="hljs-params">t</span>.<span class="hljs-params">codepoint</span>=7&amp;<span class="hljs-params">e</span>;<span class="hljs-params">else</span> <span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Invalid UTF-8 sequence"</span></span>);<span class="hljs-params">t</span>.<span class="hljs-params">utf8seq</span>-=1}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params">t.utf8seq&gt;<span class="hljs-number">0</span></span>){<span class="hljs-params">if</span>(<span class="hljs-params">e&lt;=<span class="hljs-number">127</span></span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Invalid UTF-8 sequence"</span></span>);<span class="hljs-params">t</span>.<span class="hljs-params">codepoint</span>=<span class="hljs-params">t</span>.<span class="hljs-params">codepoint</span>&lt;&lt;6|63&amp;<span class="hljs-params">e</span>,<span class="hljs-params">t</span>.<span class="hljs-params">utf8seq</span>-=1,0===<span class="hljs-params">t</span>.<span class="hljs-params">utf8seq</span>&amp;&amp;<span class="hljs-params">r</span>(<span class="hljs-params">t.codepoint</span>)}}(<span class="hljs-params">e,s,r</span>)};<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> t=<span class="hljs-number">0</span>;t&lt;e.length;t+=<span class="hljs-number">1</span></span>)<span class="hljs-params">tn</span>(<span class="hljs-params">e.charCodeAt(t</span>),<span class="hljs-params">i</span>,<span class="hljs-params">n</span>);<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>)}<span class="hljs-params">function</span> <span class="hljs-params">to</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=[],<span class="hljs-params">r</span>={<span class="hljs-params">queue</span>:0,<span class="hljs-params">queuedBits</span>:0},<span class="hljs-params">s</span>=<span class="hljs-params">e</span>=&gt;</span>{t.push(e)};<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> t=<span class="hljs-number">0</span>;t&lt;e.length;t+=<span class="hljs-number">1</span>)tn(e.charCodeAt(t),r,s);<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(t)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tl</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">let</span> t=[],r={<span class="hljs-attr">queue</span>:<span class="hljs-number">0</span>,<span class="hljs-attr">queuedBits</span>:<span class="hljs-number">0</span>},s=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>{t.push(e)};<span class="hljs-keyword">return</span> e.forEach(<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>ti(e,r,s)),ti(<span class="hljs-literal">null</span>,r,s),t.join(<span class="hljs-string">""</span>)}<span class="hljs-keyword">let</span> th=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e?<span class="hljs-function">(<span class="hljs-params">...t</span>)=&gt;</span>e(...t):<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>fetch(...e),tu=<span class="hljs-keyword">async</span>(e,t,r)=&gt;{<span class="hljs-keyword">await</span> e.setItem(t,<span class="hljs-built_in">JSON</span>.stringify(r))},tc=<span class="hljs-keyword">async</span>(e,t)=&gt;{<span class="hljs-keyword">let</span> r=<span class="hljs-keyword">await</span> e.getItem(t);<span class="hljs-keyword">if</span>(!r)<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(r)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span> r}},td=<span class="hljs-keyword">async</span>(e,t)=&gt;{<span class="hljs-keyword">await</span> e.removeItem(t)};<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tf</span></span>{<span class="hljs-keyword">constructor</span>(){<span class="hljs-keyword">this</span>.promise=<span class="hljs-keyword">new</span> tf.promiseConstructor(<span class="hljs-function">(<span class="hljs-params">e,t</span>)=&gt;</span>{<span class="hljs-keyword">this</span>.resolve=e,<span class="hljs-keyword">this</span>.reject=t})}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tp</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">let</span> t=e.split(<span class="hljs-string">"."</span>);<span class="hljs-keyword">if</span>(<span class="hljs-number">3</span>!==t.length)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> te(<span class="hljs-string">"Invalid JWT structure"</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> e=<span class="hljs-number">0</span>;e&lt;t.length;e++)<span class="hljs-keyword">if</span>(!eQ.test(t[e]))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> te(<span class="hljs-string">"JWT not in base64url format"</span>);<span class="hljs-keyword">return</span>{<span class="hljs-attr">header</span>:<span class="hljs-built_in">JSON</span>.parse(ta(t[<span class="hljs-number">0</span>])),<span class="hljs-attr">payload</span>:<span class="hljs-built_in">JSON</span>.parse(ta(t[<span class="hljs-number">1</span>])),<span class="hljs-attr">signature</span>:to(t[<span class="hljs-number">2</span>]),<span class="hljs-attr">raw</span>:{<span class="hljs-attr">header</span>:t[<span class="hljs-number">0</span>],<span class="hljs-attr">payload</span>:t[<span class="hljs-number">1</span>]}}}<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tg</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">t</span>=&gt;</span>{setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>t(<span class="hljs-literal">null</span>),e)})}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ty</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-string">"0"</span>+e.toString(<span class="hljs-number">16</span></span>)).<span class="hljs-params">substr</span>(<span class="hljs-params"><span class="hljs-number">-2</span></span>)}<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">t_</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">new</span> <span class="hljs-params">TextEncoder</span><span class="hljs-params">()</span>.<span class="hljs-params">encode</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span> <span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-keyword">await</span> crypto.subtle.digest(<span class="hljs-string">"SHA-256"</span>,t</span>))).<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;<span class="hljs-built_in">String</span>.fromCharCode(e</span>)).<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>)}<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">tw</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">undefined</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">crypto</span>||<span class="hljs-params">void</span> 0===<span class="hljs-params">crypto</span>.<span class="hljs-params">subtle</span>||"<span class="hljs-params">undefined</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">TextEncoder</span>?(<span class="hljs-params"><span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."</span></span>),<span class="hljs-params">e</span>):<span class="hljs-params">btoa</span>(<span class="hljs-params"><span class="hljs-keyword">await</span> t_(e</span>)).<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\+/g</span>,<span class="hljs-string">"-"</span></span>).<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/\//g</span>,<span class="hljs-string">"_"</span></span>).<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-regexp">/=+$/</span>,<span class="hljs-string">""</span></span>)}<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">tm</span>(<span class="hljs-params">e,t,r=!<span class="hljs-number">1</span></span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">function</span><span class="hljs-params">()</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">Uint32Array</span>(<span class="hljs-params"><span class="hljs-number">56</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"undefined"</span>==<span class="hljs-keyword">typeof</span> crypto</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>="<span class="hljs-params">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span>-.<span class="hljs-params">_</span>~",<span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">length</span>,<span class="hljs-params">r</span>="";<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> s=<span class="hljs-number">0</span>;s&lt;<span class="hljs-number">56</span>;s++</span>)<span class="hljs-params">r</span>+=<span class="hljs-params">e</span>.<span class="hljs-params">charAt</span>(<span class="hljs-params"><span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random(</span>)*<span class="hljs-params">t</span>));<span class="hljs-params">return</span> <span class="hljs-params">r</span>}<span class="hljs-params">return</span> <span class="hljs-params">crypto</span>.<span class="hljs-params">getRandomValues</span>(<span class="hljs-params">e</span>),<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params">e,ty</span>).<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">""</span></span>)}<span class="hljs-params">()</span>,<span class="hljs-params">i</span>=<span class="hljs-params">s</span>;<span class="hljs-params">r</span>&amp;&amp;(<span class="hljs-params">i+=<span class="hljs-string">"/PASSWORD_RECOVERY"</span></span>),<span class="hljs-params">await</span> <span class="hljs-params">tu</span>(<span class="hljs-params">e,<span class="hljs-string">`<span class="hljs-subst">${t}</span>-code-verifier`</span>,i</span>);<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">await</span> <span class="hljs-params">tw</span>(<span class="hljs-params">s</span>),<span class="hljs-params">a</span>=<span class="hljs-params">s</span>===<span class="hljs-params">n</span>?"<span class="hljs-params">plain</span>":"<span class="hljs-params">s256</span>";<span class="hljs-params">return</span>[<span class="hljs-params">n</span>,<span class="hljs-params">a</span>]}<span class="hljs-params">tf</span>.<span class="hljs-params">promiseConstructor</span>=<span class="hljs-params">Promise</span>;<span class="hljs-params">let</span> <span class="hljs-params">tb</span>=/^2[0-9]{3}-(<span class="hljs-params"><span class="hljs-number">0</span>[<span class="hljs-number">1</span><span class="hljs-number">-9</span>]|<span class="hljs-number">1</span>[<span class="hljs-number">0</span><span class="hljs-number">-2</span>]</span>)-(<span class="hljs-params"><span class="hljs-number">0</span>[<span class="hljs-number">1</span><span class="hljs-number">-9</span>]|<span class="hljs-number">1</span>[<span class="hljs-number">0</span><span class="hljs-number">-9</span>]|<span class="hljs-number">2</span>[<span class="hljs-number">0</span><span class="hljs-number">-9</span>]|<span class="hljs-number">3</span>[<span class="hljs-number">0</span><span class="hljs-number">-1</span>]</span>)<span class="hljs-params">$</span>/<span class="hljs-params">i</span>,<span class="hljs-params">tv</span>=/^[0-9<span class="hljs-params">a</span>-<span class="hljs-params">f</span>]{8}-[0-9<span class="hljs-params">a</span>-<span class="hljs-params">f</span>]{4}-[0-9<span class="hljs-params">a</span>-<span class="hljs-params">f</span>]{4}-[0-9<span class="hljs-params">a</span>-<span class="hljs-params">f</span>]{4}-[0-9<span class="hljs-params">a</span>-<span class="hljs-params">f</span>]{12}<span class="hljs-params">$</span>/;<span class="hljs-params">function</span> <span class="hljs-params">tS</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!tv.test(e</span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Expected parameter to be UUID but is not"</span></span>)}<span class="hljs-params">function</span> <span class="hljs-params">tk</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Proxy</span>(<span class="hljs-params">{},{get:(e,t</span>)=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"__isUserNotAvailableProxy"</span>===t)<span class="hljs-keyword">return</span>!<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"symbol"</span>==<span class="hljs-keyword">typeof</span> t){<span class="hljs-keyword">let</span> e=t.toString();<span class="hljs-keyword">if</span>(<span class="hljs-string">"Symbol(Symbol.toPrimitive)"</span>===e||<span class="hljs-string">"Symbol(Symbol.toStringTag)"</span>===e||<span class="hljs-string">"Symbol(util.inspect.custom)"</span>===e)<span class="hljs-keyword">return</span>}<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "<span class="hljs-subst">${t}</span>" property of the session object is not supported. Please use getUser() instead.`</span>)},<span class="hljs-attr">set</span>:<span class="hljs-function">(<span class="hljs-params">e,t</span>)=&gt;</span>{<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "<span class="hljs-subst">${t}</span>" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`</span>)},<span class="hljs-attr">deleteProperty</span>:<span class="hljs-function">(<span class="hljs-params">e,t</span>)=&gt;</span>{<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "<span class="hljs-subst">${t}</span>" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`</span>)}})}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tE</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(e))}<span class="hljs-keyword">let</span> tO=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e.msg||e.message||e.error_description||e.error||<span class="hljs-built_in">JSON</span>.stringify(e),tT=[<span class="hljs-number">502</span>,<span class="hljs-number">503</span>,<span class="hljs-number">504</span>];<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tj</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">var</span> t;<span class="hljs-keyword">let</span> r,s;<span class="hljs-keyword">if</span>(!<span class="hljs-function">(<span class="hljs-params"><span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> e&amp;&amp;<span class="hljs-literal">null</span>!==e&amp;&amp;<span class="hljs-string">"status"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"ok"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"json"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> e.json</span>))<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e5</span>(<span class="hljs-params">tO(e</span>),0);<span class="hljs-params">if</span>(<span class="hljs-params">tT.includes(e.status</span>))<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e5</span>(<span class="hljs-params">tO(e</span>),<span class="hljs-params">e</span>.<span class="hljs-params">status</span>);<span class="hljs-params">try</span>{<span class="hljs-params">r</span>=<span class="hljs-params">await</span> <span class="hljs-params">e</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e1</span>(<span class="hljs-params">tO(e</span>),<span class="hljs-params">e</span>)}<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">headers</span>.<span class="hljs-params">get</span>(<span class="hljs-params">ez</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!t||!t.match(tb</span>))<span class="hljs-params">return</span> <span class="hljs-params">null</span>;<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">Date</span>(<span class="hljs-params"><span class="hljs-string">`<span class="hljs-subst">${t}</span>T00:00:00.0Z`</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">null</span>}}(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">i&amp;&amp;i.getTime(</span>)&gt;=<span class="hljs-params">eY</span>["2024-01-01"].<span class="hljs-params">timestamp</span>&amp;&amp;"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">r</span>&amp;&amp;<span class="hljs-params">r</span>&amp;&amp;"<span class="hljs-params">string</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">r</span>.<span class="hljs-params">code</span>?<span class="hljs-params">s</span>=<span class="hljs-params">r</span>.<span class="hljs-params">code</span>:"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">r</span>&amp;&amp;<span class="hljs-params">r</span>&amp;&amp;"<span class="hljs-params">string</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">r</span>.<span class="hljs-params">error_code</span>&amp;&amp;(<span class="hljs-params">s=r.error_code</span>),<span class="hljs-params">s</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"weak_password"</span>===s</span>)<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e7</span>(<span class="hljs-params">tO(r</span>),<span class="hljs-params">e</span>.<span class="hljs-params">status</span>,(<span class="hljs-params"><span class="hljs-literal">null</span>==(t=r.weak_password</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">reasons</span>)||[]);<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"session_not_found"</span>===s</span>)<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e2</span>}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> r&amp;&amp;r&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> r.weak_password&amp;&amp;r.weak_password&amp;&amp;<span class="hljs-built_in">Array</span>.isArray(r.weak_password.reasons</span>)&amp;&amp;<span class="hljs-params">r</span>.<span class="hljs-params">weak_password</span>.<span class="hljs-params">reasons</span>.<span class="hljs-params">length</span>&amp;&amp;<span class="hljs-params">r</span>.<span class="hljs-params">weak_password</span>.<span class="hljs-params">reasons</span>.<span class="hljs-params">reduce</span>(<span class="hljs-params">(e,t</span>)=&gt;</span>e&amp;&amp;<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> t,!<span class="hljs-number">0</span>))<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> e7(tO(r),e.status,r.weak_password.reasons);<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> e0(tO(r),e.status||<span class="hljs-number">500</span>,s)}<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tR</span>(<span class="hljs-params">e,t,r,s</span>)</span>{<span class="hljs-keyword">var</span> i;<span class="hljs-keyword">let</span> n=<span class="hljs-built_in">Object</span>.assign({},<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers);n[ez]||<span class="hljs-function">(<span class="hljs-params">n[ez]=eY[<span class="hljs-string">"2024-01-01"</span>].name</span>),(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.jwt</span>)&amp;&amp;(<span class="hljs-params">n.Authorization=<span class="hljs-string">`Bearer <span class="hljs-subst">${s.jwt}</span>`</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">a</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">i=<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.query</span>)?<span class="hljs-params">i</span>:{};(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.redirectTo</span>)&amp;&amp;(<span class="hljs-params">a.redirect_to=s.redirectTo</span>);<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">keys</span>(<span class="hljs-params">a</span>).<span class="hljs-params">length</span>?"?"+<span class="hljs-params">new</span> <span class="hljs-params">URLSearchParams</span>(<span class="hljs-params">a</span>).<span class="hljs-params">toString</span><span class="hljs-params">()</span>:"",<span class="hljs-params">l</span>=<span class="hljs-params">await</span> <span class="hljs-params">tA</span>(<span class="hljs-params">e,t,r+o,{headers:n,noResolveJson:<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.noResolveJson},{},<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.body</span>);<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.xform</span>)?<span class="hljs-params">null</span>==<span class="hljs-params">s</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">xform</span>(<span class="hljs-params">l</span>):{<span class="hljs-params">data</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{},l</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">tA</span>(<span class="hljs-params">e,t,r,s,i,n</span>){<span class="hljs-params">let</span> <span class="hljs-params">a</span>,<span class="hljs-params">o</span>,<span class="hljs-params">l</span>=(<span class="hljs-params">o={method:t,headers:(<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>)||{}},"<span class="hljs-params">GET</span>"===<span class="hljs-params">t</span>?<span class="hljs-params">o</span>:(<span class="hljs-params">o.headers=<span class="hljs-built_in">Object</span>.assign({<span class="hljs-string">"Content-Type"</span>:<span class="hljs-string">"application/json;charset=UTF-8"</span>},<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.headers</span>),<span class="hljs-params">o</span>.<span class="hljs-params">body</span>=<span class="hljs-params">JSON</span>.<span class="hljs-params">stringify</span>(<span class="hljs-params">n</span>),<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},o</span>),<span class="hljs-params">i</span>)));<span class="hljs-params">try</span>{<span class="hljs-params">a</span>=<span class="hljs-params">await</span> <span class="hljs-params">e</span>(<span class="hljs-params">r,<span class="hljs-built_in">Object</span>.assign({},l</span>))}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">throw</span> <span class="hljs-params">console</span>.<span class="hljs-params">error</span>(<span class="hljs-params">e</span>),<span class="hljs-params">new</span> <span class="hljs-params">e5</span>(<span class="hljs-params">tO(e</span>),0)}<span class="hljs-params">if</span>(<span class="hljs-params">a.ok||<span class="hljs-keyword">await</span> tj(a</span>),<span class="hljs-params">null</span>==<span class="hljs-params">s</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">noResolveJson</span>)<span class="hljs-params">return</span> <span class="hljs-params">a</span>;<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">a</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">await</span> <span class="hljs-params">tj</span>(<span class="hljs-params">e</span>)}}<span class="hljs-params">function</span> <span class="hljs-params">tP</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>;<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">null</span>;(<span class="hljs-params">s=e</span>).<span class="hljs-params">access_token</span>&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">refresh_token</span>&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">expires_in</span>&amp;&amp;(<span class="hljs-params">i=<span class="hljs-built_in">Object</span>.assign({},e</span>),<span class="hljs-params">e</span>.<span class="hljs-params">expires_at</span>||(<span class="hljs-params">i.expires_at=(r=e.expires_in,<span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">Date</span>.now(</span>)/1<span class="hljs-params">e3</span>)+<span class="hljs-params">r</span>)));<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">session</span>:<span class="hljs-params">i</span>,<span class="hljs-params">user</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">t=e.user</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">e</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">function</span> <span class="hljs-params">tI</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">tP</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span>!<span class="hljs-params">t</span>.<span class="hljs-params">error</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">weak_password</span>&amp;&amp;"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>.<span class="hljs-params">weak_password</span>&amp;&amp;<span class="hljs-params">Array</span>.<span class="hljs-params">isArray</span>(<span class="hljs-params">e.weak_password.reasons</span>)&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">weak_password</span>.<span class="hljs-params">reasons</span>.<span class="hljs-params">length</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">weak_password</span>.<span class="hljs-params">message</span>&amp;&amp;"<span class="hljs-params">string</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>.<span class="hljs-params">weak_password</span>.<span class="hljs-params">message</span>&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">weak_password</span>.<span class="hljs-params">reasons</span>.<span class="hljs-params">reduce</span>(<span class="hljs-params">(e,t</span>)=&gt;</span>e&amp;&amp;<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> t,!<span class="hljs-number">0</span>)&amp;&amp;<span class="hljs-function">(<span class="hljs-params">t.data.weak_password=e.weak_password</span>),<span class="hljs-params">t</span>}<span class="hljs-params">function</span> <span class="hljs-params">t$</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">t=e.user</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">e</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">function</span> <span class="hljs-params">tC</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">e</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">function</span> <span class="hljs-params">tx</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">action_link</span>:<span class="hljs-params">t</span>,<span class="hljs-params">email_otp</span>:<span class="hljs-params">r</span>,<span class="hljs-params">hashed_token</span>:<span class="hljs-params">s</span>,<span class="hljs-params">redirect_to</span>:<span class="hljs-params">i</span>,<span class="hljs-params">verification_type</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">e</span>;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">properties</span>:{<span class="hljs-params">action_link</span>:<span class="hljs-params">t</span>,<span class="hljs-params">email_otp</span>:<span class="hljs-params">r</span>,<span class="hljs-params">hashed_token</span>:<span class="hljs-params">s</span>,<span class="hljs-params">redirect_to</span>:<span class="hljs-params">i</span>,<span class="hljs-params">verification_type</span>:<span class="hljs-params">n</span>},<span class="hljs-params">user</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{},(<span class="hljs-number">0</span>,T.__rest</span>)(<span class="hljs-params">e,[<span class="hljs-string">"action_link"</span>,<span class="hljs-string">"email_otp"</span>,<span class="hljs-string">"hashed_token"</span>,<span class="hljs-string">"redirect_to"</span>,<span class="hljs-string">"verification_type"</span>]</span>))},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">function</span> <span class="hljs-params">tU</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">e</span>}<span class="hljs-params">let</span> <span class="hljs-params">tN</span>=["<span class="hljs-params">global</span>","<span class="hljs-params">local</span>","<span class="hljs-params">others</span>"];<span class="hljs-params">class</span> <span class="hljs-params">tD</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">{url:e=<span class="hljs-string">""</span>,headers:t={},fetch:r}</span>){<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">t</span>,<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">th</span>(<span class="hljs-params">r</span>),<span class="hljs-params">this</span>.<span class="hljs-params">mfa</span>={<span class="hljs-params">listFactors</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_listFactors</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">deleteFactor</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_deleteFactor</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>)},<span class="hljs-params">this</span>.<span class="hljs-params">oauth</span>={<span class="hljs-params">listClients</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_listOAuthClients</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">createClient</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_createOAuthClient</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">getClient</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_getOAuthClient</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">updateClient</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_updateOAuthClient</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">deleteClient</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_deleteOAuthClient</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">regenerateClientSecret</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_regenerateOAuthClientSecret</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>)}}<span class="hljs-params">async</span> <span class="hljs-params">signOut</span>(<span class="hljs-params">e,t=tN[<span class="hljs-number">0</span>]</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-number">0</span>&gt;tN.indexOf(t</span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">`@supabase/auth-js: Parameter scope must be one of <span class="hljs-subst">${tN.join(<span class="hljs-string">", "</span>)}</span>`</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/logout?scope=<span class="hljs-subst">${t}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:e,noResolveJson:!<span class="hljs-number">0</span>}</span>),{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">inviteUserByEmail</span>(<span class="hljs-params">e,t={}</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/invite`</span>,{body:{email:e,data:t.data},headers:<span class="hljs-keyword">this</span>.headers,redirectTo:t.redirectTo,xform:t$}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">generateLink</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">options</span>:<span class="hljs-params">t</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">r</span>=(<span class="hljs-params"><span class="hljs-number">0</span>,T.__rest</span>)(<span class="hljs-params">e,[<span class="hljs-string">"options"</span>]</span>),<span class="hljs-params">s</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},r</span>),<span class="hljs-params">t</span>);<span class="hljs-params">return</span>"<span class="hljs-params">newEmail</span>"<span class="hljs-params">in</span> <span class="hljs-params">r</span>&amp;&amp;(<span class="hljs-params">s.new_email=<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.newEmail,<span class="hljs-keyword">delete</span> s.newEmail</span>),<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/generate_link`</span>,{body:s,headers:<span class="hljs-keyword">this</span>.headers,xform:tx,redirectTo:<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.redirectTo}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">properties</span>:<span class="hljs-params">null</span>,<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">createUser</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users`</span>,{body:e,headers:<span class="hljs-keyword">this</span>.headers,xform:t$}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">listUsers</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>,<span class="hljs-params">a</span>,<span class="hljs-params">o</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">l</span>={<span class="hljs-params">nextPage</span>:<span class="hljs-params">null</span>,<span class="hljs-params">lastPage</span>:0,<span class="hljs-params">total</span>:0},<span class="hljs-params">h</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users`</span>,{headers:<span class="hljs-keyword">this</span>.headers,noResolveJson:!<span class="hljs-number">0</span>,query:{page:<span class="hljs-literal">null</span>!=(r=<span class="hljs-literal">null</span>==(t=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.page</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>)?<span class="hljs-params">r</span>:"",<span class="hljs-params">per_page</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">i=<span class="hljs-literal">null</span>==(s=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.perPage</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>)?<span class="hljs-params">i</span>:""},<span class="hljs-params">xform</span>:<span class="hljs-params">tU</span>});<span class="hljs-params">if</span>(<span class="hljs-params">h.error</span>)<span class="hljs-params">throw</span> <span class="hljs-params">h</span>.<span class="hljs-params">error</span>;<span class="hljs-params">let</span> <span class="hljs-params">u</span>=<span class="hljs-params">await</span> <span class="hljs-params">h</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>,<span class="hljs-params">c</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">n=h.headers.get(<span class="hljs-string">"x-total-count"</span></span>))?<span class="hljs-params">n</span>:0,<span class="hljs-params">d</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">o=<span class="hljs-literal">null</span>==(a=h.headers.get(<span class="hljs-string">"link"</span></span>))?<span class="hljs-params">void</span> 0:<span class="hljs-params">a</span>.<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">","</span></span>))?<span class="hljs-params">o</span>:[];<span class="hljs-params">return</span> <span class="hljs-params">d</span>.<span class="hljs-params">length</span>&gt;0&amp;&amp;(<span class="hljs-params">d.forEach(e=&gt;{<span class="hljs-keyword">let</span> t=<span class="hljs-built_in">parseInt</span>(e.split(<span class="hljs-string">";"</span></span>)[0].<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">"="</span></span>)[1].<span class="hljs-params">substring</span>(<span class="hljs-params"><span class="hljs-number">0</span>,<span class="hljs-number">1</span></span>)),<span class="hljs-params">r</span>=<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">e.split(<span class="hljs-string">";"</span></span>)[1].<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">"="</span></span>)[1]);<span class="hljs-params">l</span>[`<span class="hljs-params">$</span>{<span class="hljs-params">r</span>}<span class="hljs-params">Page</span>`]=<span class="hljs-params">t</span>}),<span class="hljs-params">l</span>.<span class="hljs-params">total</span>=<span class="hljs-params">parseInt</span>(<span class="hljs-params">c</span>)),{<span class="hljs-params">data</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},u</span>),<span class="hljs-params">l</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">users</span>:[]},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">getUserById</span>(<span class="hljs-params">e</span>){<span class="hljs-params">tS</span>(<span class="hljs-params">e</span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users/<span class="hljs-subst">${e}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,xform:t$}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">updateUserById</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">tS</span>(<span class="hljs-params">e</span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"PUT"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users/<span class="hljs-subst">${e}</span>`</span>,{body:t,headers:<span class="hljs-keyword">this</span>.headers,xform:t$}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">deleteUser</span>(<span class="hljs-params">e,t=!<span class="hljs-number">1</span></span>){<span class="hljs-params">tS</span>(<span class="hljs-params">e</span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"DELETE"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users/<span class="hljs-subst">${e}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{should_soft_delete:t},xform:t$}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_listFactors</span>(<span class="hljs-params">e</span>){<span class="hljs-params">tS</span>(<span class="hljs-params">e.userId</span>);<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users/<span class="hljs-subst">${e.userId}</span>/factors`</span>,{headers:<span class="hljs-keyword">this</span>.headers,xform:e=&gt;({data:{factors:e},error:<span class="hljs-literal">null</span>}</span>)});<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_deleteFactor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">tS</span>(<span class="hljs-params">e.userId</span>),<span class="hljs-params">tS</span>(<span class="hljs-params">e.id</span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"DELETE"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/users/<span class="hljs-subst">${e.userId}</span>/factors/<span class="hljs-subst">${e.id}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers}</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_listOAuthClients</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>,<span class="hljs-params">a</span>,<span class="hljs-params">o</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">l</span>={<span class="hljs-params">nextPage</span>:<span class="hljs-params">null</span>,<span class="hljs-params">lastPage</span>:0,<span class="hljs-params">total</span>:0},<span class="hljs-params">h</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/oauth/clients`</span>,{headers:<span class="hljs-keyword">this</span>.headers,noResolveJson:!<span class="hljs-number">0</span>,query:{page:<span class="hljs-literal">null</span>!=(r=<span class="hljs-literal">null</span>==(t=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.page</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>)?<span class="hljs-params">r</span>:"",<span class="hljs-params">per_page</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">i=<span class="hljs-literal">null</span>==(s=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.perPage</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">toString</span><span class="hljs-params">()</span>)?<span class="hljs-params">i</span>:""},<span class="hljs-params">xform</span>:<span class="hljs-params">tU</span>});<span class="hljs-params">if</span>(<span class="hljs-params">h.error</span>)<span class="hljs-params">throw</span> <span class="hljs-params">h</span>.<span class="hljs-params">error</span>;<span class="hljs-params">let</span> <span class="hljs-params">u</span>=<span class="hljs-params">await</span> <span class="hljs-params">h</span>.<span class="hljs-params">json</span><span class="hljs-params">()</span>,<span class="hljs-params">c</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">n=h.headers.get(<span class="hljs-string">"x-total-count"</span></span>))?<span class="hljs-params">n</span>:0,<span class="hljs-params">d</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">o=<span class="hljs-literal">null</span>==(a=h.headers.get(<span class="hljs-string">"link"</span></span>))?<span class="hljs-params">void</span> 0:<span class="hljs-params">a</span>.<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">","</span></span>))?<span class="hljs-params">o</span>:[];<span class="hljs-params">return</span> <span class="hljs-params">d</span>.<span class="hljs-params">length</span>&gt;0&amp;&amp;(<span class="hljs-params">d.forEach(e=&gt;{<span class="hljs-keyword">let</span> t=<span class="hljs-built_in">parseInt</span>(e.split(<span class="hljs-string">";"</span></span>)[0].<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">"="</span></span>)[1].<span class="hljs-params">substring</span>(<span class="hljs-params"><span class="hljs-number">0</span>,<span class="hljs-number">1</span></span>)),<span class="hljs-params">r</span>=<span class="hljs-params">JSON</span>.<span class="hljs-params">parse</span>(<span class="hljs-params">e.split(<span class="hljs-string">";"</span></span>)[1].<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">"="</span></span>)[1]);<span class="hljs-params">l</span>[`<span class="hljs-params">$</span>{<span class="hljs-params">r</span>}<span class="hljs-params">Page</span>`]=<span class="hljs-params">t</span>}),<span class="hljs-params">l</span>.<span class="hljs-params">total</span>=<span class="hljs-params">parseInt</span>(<span class="hljs-params">c</span>)),{<span class="hljs-params">data</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},u</span>),<span class="hljs-params">l</span>),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">clients</span>:[]},<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_createOAuthClient</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/oauth/clients`</span>,{body:e,headers:<span class="hljs-keyword">this</span>.headers,xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_getOAuthClient</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/oauth/clients/<span class="hljs-subst">${e}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_updateOAuthClient</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"PUT"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/oauth/clients/<span class="hljs-subst">${e}</span>`</span>,{body:t,headers:<span class="hljs-keyword">this</span>.headers,xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_deleteOAuthClient</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"DELETE"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/oauth/clients/<span class="hljs-subst">${e}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,noResolveJson:!<span class="hljs-number">0</span>}</span>),{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_regenerateOAuthClientSecret</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/admin/oauth/clients/<span class="hljs-subst">${e}</span>/regenerate_secret`</span>,{headers:<span class="hljs-keyword">this</span>.headers,xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}}<span class="hljs-params">function</span> <span class="hljs-params">tB</span>(<span class="hljs-params">e={}</span>){<span class="hljs-params">return</span>{<span class="hljs-params">getItem</span>:<span class="hljs-params">t</span>=&gt;</span>e[t]||<span class="hljs-literal">null</span>,<span class="hljs-attr">setItem</span>:<span class="hljs-function">(<span class="hljs-params">t,r</span>)=&gt;</span>{e[t]=r},<span class="hljs-attr">removeItem</span>:<span class="hljs-function"><span class="hljs-params">t</span>=&gt;</span>{<span class="hljs-keyword">delete</span> e[t]}}}globalThis;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tL</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">super</span>(e),<span class="hljs-keyword">this</span>.isAcquireTimeout=!<span class="hljs-number">0</span>}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tq</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/^0x[a-fA-F0-9]{40}$/</span>.test(e))<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Address "<span class="hljs-subst">${e}</span>" is invalid.`</span>);<span class="hljs-keyword">return</span> e.toLowerCase()}<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tK</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>{<span class="hljs-keyword">constructor</span>({message:e,<span class="hljs-attr">code</span>:t,<span class="hljs-attr">cause</span>:r,<span class="hljs-attr">name</span>:s}){<span class="hljs-keyword">var</span> i;<span class="hljs-keyword">super</span>(e,{<span class="hljs-attr">cause</span>:r}),<span class="hljs-keyword">this</span>.__isWebAuthnError=!<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.name=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">i=<span class="hljs-literal">null</span>!=s?s:r <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>?r.name:<span class="hljs-keyword">void</span> <span class="hljs-number">0</span></span>)?<span class="hljs-params">i</span>:"<span class="hljs-params">Unknown</span> <span class="hljs-params">Error</span>",<span class="hljs-params">this</span>.<span class="hljs-params">code</span>=<span class="hljs-params">t</span>}}<span class="hljs-params">class</span> <span class="hljs-params">tW</span> <span class="hljs-params">extends</span> <span class="hljs-params">tK</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">super</span>(<span class="hljs-params">{code:<span class="hljs-string">"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY"</span>,cause:t,message:e}</span>),<span class="hljs-params">this</span>.<span class="hljs-params">name</span>="<span class="hljs-params">WebAuthnUnknownError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">originalError</span>=<span class="hljs-params">t</span>}}<span class="hljs-params">let</span> <span class="hljs-params">tV</span>=<span class="hljs-params">new</span> <span class="hljs-params">class</span>{<span class="hljs-params">createNewAbortSignal</span><span class="hljs-params">()</span>{<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.controller</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Cancelling existing WebAuthn API call for new one"</span></span>);<span class="hljs-params">e</span>.<span class="hljs-params">name</span>="<span class="hljs-params">AbortError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">controller</span>.<span class="hljs-params">abort</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">AbortController</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">controller</span>=<span class="hljs-params">e</span>,<span class="hljs-params">e</span>.<span class="hljs-params">signal</span>}<span class="hljs-params">cancelCeremony</span><span class="hljs-params">()</span>{<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.controller</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Manually cancelling existing WebAuthn API call"</span></span>);<span class="hljs-params">e</span>.<span class="hljs-params">name</span>="<span class="hljs-params">AbortError</span>",<span class="hljs-params">this</span>.<span class="hljs-params">controller</span>.<span class="hljs-params">abort</span>(<span class="hljs-params">e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">controller</span>=<span class="hljs-params">void</span> 0}}};<span class="hljs-params">function</span> <span class="hljs-params">tH</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">localhost</span>"===<span class="hljs-params">e</span>||/^(<span class="hljs-params">[a-z0<span class="hljs-number">-9</span>]+(-[a-z0<span class="hljs-number">-9</span>]+</span>)*\.)+[<span class="hljs-params">a</span>-<span class="hljs-params">z</span>]{2,}<span class="hljs-params">$</span>/<span class="hljs-params">i</span>.<span class="hljs-params">test</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">tM</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">navigator</span>.<span class="hljs-params">credentials</span>.<span class="hljs-params">create</span>(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">tW</span>(<span class="hljs-params"><span class="hljs-string">"Empty credential response"</span>,t</span>)};<span class="hljs-params">if</span>(<span class="hljs-params">!(t <span class="hljs-keyword">instanceof</span> PublicKeyCredential</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">tW</span>(<span class="hljs-params"><span class="hljs-string">"Browser returned unexpected credential type"</span>,t</span>)};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">t</span>){<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">function</span>(<span class="hljs-params">{error:e,options:t}</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">let</span>{<span class="hljs-params">publicKey</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!n</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"options was missing required publicKey property"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"AbortError"</span>===e.name</span>){<span class="hljs-params">if</span>(<span class="hljs-params">t.signal <span class="hljs-keyword">instanceof</span> AbortSignal</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"Registration ceremony was sent an abort signal"</span>,code:<span class="hljs-string">"ERROR_CEREMONY_ABORTED"</span>,cause:e}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"ConstraintError"</span>===e.name</span>){<span class="hljs-params">if</span>(<span class="hljs-params">(<span class="hljs-literal">null</span>==(r=n.authenticatorSelection</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">requireResidentKey</span>)===!0)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"Discoverable credentials were required but no available authenticator supported it"</span>,code:<span class="hljs-string">"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT"</span>,cause:e}</span>);<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"conditional"</span>===t.mediation&amp;&amp;(<span class="hljs-literal">null</span>==(s=n.authenticatorSelection</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">userVerification</span>)==="<span class="hljs-params">required</span>")<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"User verification was required during automatic registration but it could not be performed"</span>,code:<span class="hljs-string">"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE"</span>,cause:e}</span>);<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params">(<span class="hljs-literal">null</span>==(i=n.authenticatorSelection</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">userVerification</span>)==="<span class="hljs-params">required</span>")<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"User verification was required but no available authenticator supported it"</span>,code:<span class="hljs-string">"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT"</span>,cause:e}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"InvalidStateError"</span>===e.name</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"The authenticator was previously registered"</span>,code:<span class="hljs-string">"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"</span>,cause:e}</span>);<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"NotAllowedError"</span>===e.name</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:e.message,code:<span class="hljs-string">"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY"</span>,cause:e}</span>);<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"NotSupportedError"</span>===e.name</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params"><span class="hljs-number">0</span>===n.pubKeyCredParams.filter(e=&gt;<span class="hljs-string">"public-key"</span>===e.type</span>).<span class="hljs-params">length</span>?{<span class="hljs-params">message</span>:'<span class="hljs-params">No</span> <span class="hljs-params">entry</span> <span class="hljs-params">in</span> <span class="hljs-params">pubKeyCredParams</span> <span class="hljs-params">was</span> <span class="hljs-params">of</span> <span class="hljs-params">type</span> "<span class="hljs-params">public</span>-<span class="hljs-params">key</span>"',<span class="hljs-params">code</span>:"<span class="hljs-params">ERROR_MALFORMED_PUBKEYCREDPARAMS</span>",<span class="hljs-params">cause</span>:<span class="hljs-params">e</span>}:{<span class="hljs-params">message</span>:"<span class="hljs-params">No</span> <span class="hljs-params">available</span> <span class="hljs-params">authenticator</span> <span class="hljs-params">supported</span> <span class="hljs-params">any</span> <span class="hljs-params">of</span> <span class="hljs-params">the</span> <span class="hljs-params">specified</span> <span class="hljs-params">pubKeyCredParams</span> <span class="hljs-params">algorithms</span>",<span class="hljs-params">code</span>:"<span class="hljs-params">ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG</span>",<span class="hljs-params">cause</span>:<span class="hljs-params">e</span>});<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"SecurityError"</span>===e.name</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">window</span>.<span class="hljs-params">location</span>.<span class="hljs-params">hostname</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!tH(t</span>))<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">window</span>.location.hostname}</span> is an invalid domain`</span>,code:<span class="hljs-string">"ERROR_INVALID_DOMAIN"</span>,cause:e}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">n.rp.id!==t</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">`The RP ID "<span class="hljs-subst">${n.rp.id}</span>" is invalid for this domain`</span>,code:<span class="hljs-string">"ERROR_INVALID_RP_ID"</span>,cause:e}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"TypeError"</span>===e.name</span>){<span class="hljs-params">if</span>(<span class="hljs-params">n.user.id.byteLength&lt;<span class="hljs-number">1</span>||n.user.id.byteLength&gt;<span class="hljs-number">64</span></span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"User ID was not between 1 and 64 characters"</span>,code:<span class="hljs-string">"ERROR_INVALID_USER_ID_LENGTH"</span>,cause:e}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"UnknownError"</span>===e.name</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"The authenticator was unable to process the specified options, or could not create a new credential"</span>,code:<span class="hljs-string">"ERROR_AUTHENTICATOR_GENERAL_ERROR"</span>,cause:e}</span>);<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"a Non-Webauthn related error has occurred"</span>,code:<span class="hljs-string">"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY"</span>,cause:e}</span>)}(<span class="hljs-params">{error:t,options:e}</span>)}}}<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">tJ</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">navigator</span>.<span class="hljs-params">credentials</span>.<span class="hljs-params">get</span>(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">tW</span>(<span class="hljs-params"><span class="hljs-string">"Empty credential response"</span>,t</span>)};<span class="hljs-params">if</span>(<span class="hljs-params">!(t <span class="hljs-keyword">instanceof</span> PublicKeyCredential</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">tW</span>(<span class="hljs-params"><span class="hljs-string">"Browser returned unexpected credential type"</span>,t</span>)};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">t</span>){<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">function</span>(<span class="hljs-params">{error:e,options:t}</span>){<span class="hljs-params">let</span>{<span class="hljs-params">publicKey</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"options was missing required publicKey property"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"AbortError"</span>===e.name</span>){<span class="hljs-params">if</span>(<span class="hljs-params">t.signal <span class="hljs-keyword">instanceof</span> AbortSignal</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"Authentication ceremony was sent an abort signal"</span>,code:<span class="hljs-string">"ERROR_CEREMONY_ABORTED"</span>,cause:e}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"NotAllowedError"</span>===e.name</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:e.message,code:<span class="hljs-string">"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY"</span>,cause:e}</span>);<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"SecurityError"</span>===e.name</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">window</span>.<span class="hljs-params">location</span>.<span class="hljs-params">hostname</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!tH(t</span>))<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">window</span>.location.hostname}</span> is an invalid domain`</span>,code:<span class="hljs-string">"ERROR_INVALID_DOMAIN"</span>,cause:e}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r.rpId!==t</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">`The RP ID "<span class="hljs-subst">${r.rpId}</span>" is invalid for this domain`</span>,code:<span class="hljs-string">"ERROR_INVALID_RP_ID"</span>,cause:e}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"UnknownError"</span>===e.name</span>)<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"The authenticator was unable to process the specified options, or could not create a new assertion signature"</span>,code:<span class="hljs-string">"ERROR_AUTHENTICATOR_GENERAL_ERROR"</span>,cause:e}</span>);<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">tK</span>(<span class="hljs-params">{message:<span class="hljs-string">"a Non-Webauthn related error has occurred"</span>,code:<span class="hljs-string">"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY"</span>,cause:e}</span>)}(<span class="hljs-params">{error:t,options:e}</span>)}}}<span class="hljs-params">let</span> <span class="hljs-params">tG</span>={<span class="hljs-params">hints</span>:["<span class="hljs-params">security</span>-<span class="hljs-params">key</span>"],<span class="hljs-params">authenticatorSelection</span>:{<span class="hljs-params">authenticatorAttachment</span>:"<span class="hljs-params">cross</span>-<span class="hljs-params">platform</span>",<span class="hljs-params">requireResidentKey</span>:!1,<span class="hljs-params">userVerification</span>:"<span class="hljs-params">preferred</span>",<span class="hljs-params">residentKey</span>:"<span class="hljs-params">discouraged</span>"},<span class="hljs-params">attestation</span>:"<span class="hljs-params">direct</span>"},<span class="hljs-params">tF</span>={<span class="hljs-params">userVerification</span>:"<span class="hljs-params">preferred</span>",<span class="hljs-params">hints</span>:["<span class="hljs-params">security</span>-<span class="hljs-params">key</span>"],<span class="hljs-params">attestation</span>:"<span class="hljs-params">direct</span>"};<span class="hljs-params">function</span> <span class="hljs-params">tz</span>(<span class="hljs-params">...e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>=&gt;</span><span class="hljs-literal">null</span>!==e&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> e&amp;&amp;!<span class="hljs-built_in">Array</span>.isArray(e),r=<span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>e <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>||<span class="hljs-built_in">ArrayBuffer</span>.isView(e),s={};<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> e)<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> e <span class="hljs-keyword">in</span> i){<span class="hljs-keyword">let</span> n=i[e];<span class="hljs-keyword">if</span>(<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>!==n)<span class="hljs-keyword">if</span>(<span class="hljs-built_in">Array</span>.isArray(n))s[e]=n;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(r(n))s[e]=n;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(t(n)){<span class="hljs-keyword">let</span> r=s[e];t(r)?s[e]=tz(r,n):s[e]=tz(n)}<span class="hljs-keyword">else</span> s[e]=n}<span class="hljs-keyword">return</span> s}<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tY</span></span>{<span class="hljs-keyword">constructor</span>(e){<span class="hljs-keyword">this</span>.client=e,<span class="hljs-keyword">this</span>.enroll=<span class="hljs-keyword">this</span>._enroll.bind(<span class="hljs-keyword">this</span>),<span class="hljs-keyword">this</span>.challenge=<span class="hljs-keyword">this</span>._challenge.bind(<span class="hljs-keyword">this</span>),<span class="hljs-keyword">this</span>.verify=<span class="hljs-keyword">this</span>._verify.bind(<span class="hljs-keyword">this</span>),<span class="hljs-keyword">this</span>.authenticate=<span class="hljs-keyword">this</span>._authenticate.bind(<span class="hljs-keyword">this</span>),<span class="hljs-keyword">this</span>.register=<span class="hljs-keyword">this</span>._register.bind(<span class="hljs-keyword">this</span>)}<span class="hljs-keyword">async</span> _enroll(e){<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.client.mfa.enroll(<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e),{<span class="hljs-attr">factorType</span>:<span class="hljs-string">"webauthn"</span>}))}<span class="hljs-keyword">async</span> _challenge({<span class="hljs-attr">factorId</span>:e,<span class="hljs-attr">webauthn</span>:t,<span class="hljs-attr">friendlyName</span>:r,<span class="hljs-attr">signal</span>:s},i){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> n,a,o,l;<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:h,<span class="hljs-attr">error</span>:u}=<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.client.mfa.challenge({<span class="hljs-attr">factorId</span>:e,<span class="hljs-attr">webauthn</span>:t});<span class="hljs-keyword">if</span>(!h)<span class="hljs-keyword">return</span>{<span class="hljs-attr">data</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">error</span>:u};<span class="hljs-keyword">let</span> c=<span class="hljs-literal">null</span>!=s?s:tV.createNewAbortSignal();<span class="hljs-keyword">if</span>(<span class="hljs-string">"create"</span>===h.webauthn.type){<span class="hljs-keyword">let</span>{<span class="hljs-attr">user</span>:e}=h.webauthn.credential_options.publicKey;e.name||<span class="hljs-function">(<span class="hljs-params">e.name=<span class="hljs-string">`<span class="hljs-subst">${e.id}</span>:<span class="hljs-subst">${r}</span>`</span></span>),<span class="hljs-params">e</span>.<span class="hljs-params">displayName</span>||(<span class="hljs-params">e.displayName=e.name</span>)}<span class="hljs-params">switch</span>(<span class="hljs-params">h.webauthn.type</span>){<span class="hljs-params">case</span>"<span class="hljs-params">create</span>":{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=(<span class="hljs-params">n=h.webauthn.credential_options.publicKey,a=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.create,tz(tG,n,a||{}</span>)),{<span class="hljs-params">data</span>:<span class="hljs-params">r</span>,<span class="hljs-params">error</span>:<span class="hljs-params">s</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tM</span>(<span class="hljs-params">{publicKey:t,signal:c}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">factorId</span>:<span class="hljs-params">e</span>,<span class="hljs-params">challengeId</span>:<span class="hljs-params">h</span>.<span class="hljs-params">id</span>,<span class="hljs-params">webauthn</span>:{<span class="hljs-params">type</span>:<span class="hljs-params">h</span>.<span class="hljs-params">webauthn</span>.<span class="hljs-params">type</span>,<span class="hljs-params">credential_response</span>:<span class="hljs-params">r</span>}},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">s</span>}}<span class="hljs-params">case</span>"<span class="hljs-params">request</span>":{<span class="hljs-params">let</span> <span class="hljs-params">t</span>=(<span class="hljs-params">o=h.webauthn.credential_options.publicKey,l=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.request,tz(tF,o,l||{}</span>)),{<span class="hljs-params">data</span>:<span class="hljs-params">r</span>,<span class="hljs-params">error</span>:<span class="hljs-params">s</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tJ</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},h.webauthn.credential_options</span>),{<span class="hljs-params">publicKey</span>:<span class="hljs-params">t</span>,<span class="hljs-params">signal</span>:<span class="hljs-params">c</span>}));<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">factorId</span>:<span class="hljs-params">e</span>,<span class="hljs-params">challengeId</span>:<span class="hljs-params">h</span>.<span class="hljs-params">id</span>,<span class="hljs-params">webauthn</span>:{<span class="hljs-params">type</span>:<span class="hljs-params">h</span>.<span class="hljs-params">webauthn</span>.<span class="hljs-params">type</span>,<span class="hljs-params">credential_response</span>:<span class="hljs-params">r</span>}},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">s</span>}}}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">e1</span>(<span class="hljs-params"><span class="hljs-string">"Unexpected error in challenge"</span>,e</span>)}}}<span class="hljs-params">async</span> <span class="hljs-params">_verify</span>(<span class="hljs-params">{challengeId:e,factorId:t,webauthn:r}</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">client</span>.<span class="hljs-params">mfa</span>.<span class="hljs-params">verify</span>(<span class="hljs-params">{factorId:t,challengeId:e,webauthn:r}</span>)}<span class="hljs-params">async</span> <span class="hljs-params">_authenticate</span>(<span class="hljs-params">{factorId:e,webauthn:{rpId:t,rpOrigins:r,signal:s}={}},i</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">eX</span>(<span class="hljs-params"><span class="hljs-string">"rpId is required for WebAuthn authentication"</span></span>)};<span class="hljs-params">try</span>{1;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">e1</span>(<span class="hljs-params"><span class="hljs-string">"Browser does not support WebAuthn"</span>,<span class="hljs-literal">null</span></span>)}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">e1</span>(<span class="hljs-params"><span class="hljs-string">"Unexpected error in authenticate"</span>,e</span>)}}}<span class="hljs-params">async</span> <span class="hljs-params">_register</span>(<span class="hljs-params">{friendlyName:e,webauthn:{rpId:t,rpOrigins:r,signal:s}={}},i</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">eX</span>(<span class="hljs-params"><span class="hljs-string">"rpId is required for WebAuthn registration"</span></span>)};<span class="hljs-params">try</span>{1;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">e1</span>(<span class="hljs-params"><span class="hljs-string">"Browser does not support WebAuthn"</span>,<span class="hljs-literal">null</span></span>)}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">e1</span>(<span class="hljs-params"><span class="hljs-string">"Unexpected error in register"</span>,e</span>)}}}}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> globalThis</span>)<span class="hljs-params">try</span>{<span class="hljs-params">Object</span>.<span class="hljs-params">defineProperty</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.prototype,<span class="hljs-string">"__magic__"</span>,{get:<span class="hljs-keyword">function</span>(</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>},<span class="hljs-params">configurable</span>:!0}),<span class="hljs-params">__magic__</span>.<span class="hljs-params">globalThis</span>=<span class="hljs-params">__magic__</span>,<span class="hljs-params">delete</span> <span class="hljs-params">Object</span>.<span class="hljs-params">prototype</span>.<span class="hljs-params">__magic__</span>}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){"<span class="hljs-params">undefined</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">self</span>&amp;&amp;(<span class="hljs-params">self.globalThis=self</span>)}<span class="hljs-params">let</span> <span class="hljs-params">tQ</span>={<span class="hljs-params">url</span>:"<span class="hljs-params">http</span>://<span class="hljs-params">localhost</span>:9999",<span class="hljs-params">storageKey</span>:"<span class="hljs-params">supabase</span>.<span class="hljs-params">auth</span>.<span class="hljs-params">token</span>",<span class="hljs-params">autoRefreshToken</span>:!0,<span class="hljs-params">persistSession</span>:!0,<span class="hljs-params">detectSessionInUrl</span>:!0,<span class="hljs-params">headers</span>:<span class="hljs-params">eF</span>,<span class="hljs-params">flowType</span>:"<span class="hljs-params">implicit</span>",<span class="hljs-params">debug</span>:!1,<span class="hljs-params">hasCustomAuthorizationHeader</span>:!1,<span class="hljs-params">throwOnError</span>:!1};<span class="hljs-params">async</span> <span class="hljs-params">function</span> <span class="hljs-params">tX</span>(<span class="hljs-params">e,t,r</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">r</span><span class="hljs-params">()</span>}<span class="hljs-params">let</span> <span class="hljs-params">tZ</span>={};<span class="hljs-params">class</span> <span class="hljs-params">t0</span>{<span class="hljs-params">get</span> <span class="hljs-params">jwks</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>,<span class="hljs-params">t</span>;<span class="hljs-params">return</span> <span class="hljs-params">null</span>!=(<span class="hljs-params">t=<span class="hljs-literal">null</span>==(e=tZ[<span class="hljs-keyword">this</span>.storageKey]</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">e</span>.<span class="hljs-params">jwks</span>)?<span class="hljs-params">t</span>:{<span class="hljs-params">keys</span>:[]}}<span class="hljs-params">set</span> <span class="hljs-params">jwks</span>(<span class="hljs-params">e</span>){<span class="hljs-params">tZ</span>[<span class="hljs-params">this</span>.<span class="hljs-params">storageKey</span>]=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},tZ[<span class="hljs-keyword">this</span>.storageKey]</span>),{<span class="hljs-params">jwks</span>:<span class="hljs-params">e</span>})}<span class="hljs-params">get</span> <span class="hljs-params">jwks_cached_at</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>,<span class="hljs-params">t</span>;<span class="hljs-params">return</span> <span class="hljs-params">null</span>!=(<span class="hljs-params">t=<span class="hljs-literal">null</span>==(e=tZ[<span class="hljs-keyword">this</span>.storageKey]</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">e</span>.<span class="hljs-params">cachedAt</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">Number</span>.<span class="hljs-params">MIN_SAFE_INTEGER</span>}<span class="hljs-params">set</span> <span class="hljs-params">jwks_cached_at</span>(<span class="hljs-params">e</span>){<span class="hljs-params">tZ</span>[<span class="hljs-params">this</span>.<span class="hljs-params">storageKey</span>]=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},tZ[<span class="hljs-keyword">this</span>.storageKey]</span>),{<span class="hljs-params">cachedAt</span>:<span class="hljs-params">e</span>})}<span class="hljs-params">constructor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">this</span>.<span class="hljs-params">userStorage</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">memoryStorage</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">stateChangeEmitters</span>=<span class="hljs-params">new</span> <span class="hljs-params">Map</span>,<span class="hljs-params">this</span>.<span class="hljs-params">autoRefreshTicker</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">visibilityChangedCallback</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">refreshingDeferred</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">detectSessionInUrl</span>=!0,<span class="hljs-params">this</span>.<span class="hljs-params">hasCustomAuthorizationHeader</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">suppressGetSessionWarning</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">lockAcquired</span>=!1,<span class="hljs-params">this</span>.<span class="hljs-params">pendingInLock</span>=[],<span class="hljs-params">this</span>.<span class="hljs-params">broadcastChannel</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">logger</span>=<span class="hljs-params">console</span>.<span class="hljs-params">log</span>;<span class="hljs-params">const</span> <span class="hljs-params">r</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},tQ</span>),<span class="hljs-params">e</span>);<span class="hljs-params">this</span>.<span class="hljs-params">storageKey</span>=<span class="hljs-params">r</span>.<span class="hljs-params">storageKey</span>,<span class="hljs-params">this</span>.<span class="hljs-params">instanceID</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">t=t0.nextInstanceID[<span class="hljs-keyword">this</span>.storageKey]</span>)?<span class="hljs-params">t</span>:0,<span class="hljs-params">t0</span>.<span class="hljs-params">nextInstanceID</span>[<span class="hljs-params">this</span>.<span class="hljs-params">storageKey</span>]=<span class="hljs-params">this</span>.<span class="hljs-params">instanceID</span>+1,<span class="hljs-params">this</span>.<span class="hljs-params">logDebugMessages</span>=!!<span class="hljs-params">r</span>.<span class="hljs-params">debug</span>,"<span class="hljs-params">function</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">r</span>.<span class="hljs-params">debug</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.logger=r.debug</span>),<span class="hljs-params">this</span>.<span class="hljs-params">instanceID</span>,<span class="hljs-params">this</span>.<span class="hljs-params">persistSession</span>=<span class="hljs-params">r</span>.<span class="hljs-params">persistSession</span>,<span class="hljs-params">this</span>.<span class="hljs-params">autoRefreshToken</span>=<span class="hljs-params">r</span>.<span class="hljs-params">autoRefreshToken</span>,<span class="hljs-params">this</span>.<span class="hljs-params">admin</span>=<span class="hljs-params">new</span> <span class="hljs-params">tD</span>(<span class="hljs-params">{url:r.url,headers:r.headers,fetch:r.fetch}</span>),<span class="hljs-params">this</span>.<span class="hljs-params">url</span>=<span class="hljs-params">r</span>.<span class="hljs-params">url</span>,<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">r</span>.<span class="hljs-params">headers</span>,<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=<span class="hljs-params">th</span>(<span class="hljs-params">r.fetch</span>),<span class="hljs-params">this</span>.<span class="hljs-params">lock</span>=<span class="hljs-params">r</span>.<span class="hljs-params">lock</span>||<span class="hljs-params">tX</span>,<span class="hljs-params">this</span>.<span class="hljs-params">detectSessionInUrl</span>=<span class="hljs-params">r</span>.<span class="hljs-params">detectSessionInUrl</span>,<span class="hljs-params">this</span>.<span class="hljs-params">flowType</span>=<span class="hljs-params">r</span>.<span class="hljs-params">flowType</span>,<span class="hljs-params">this</span>.<span class="hljs-params">hasCustomAuthorizationHeader</span>=<span class="hljs-params">r</span>.<span class="hljs-params">hasCustomAuthorizationHeader</span>,<span class="hljs-params">this</span>.<span class="hljs-params">throwOnError</span>=<span class="hljs-params">r</span>.<span class="hljs-params">throwOnError</span>,<span class="hljs-params">r</span>.<span class="hljs-params">lock</span>?<span class="hljs-params">this</span>.<span class="hljs-params">lock</span>=<span class="hljs-params">r</span>.<span class="hljs-params">lock</span>:<span class="hljs-params">this</span>.<span class="hljs-params">lock</span>=<span class="hljs-params">tX</span>,<span class="hljs-params">this</span>.<span class="hljs-params">jwks</span>||(<span class="hljs-params"><span class="hljs-keyword">this</span>.jwks={keys:[]},<span class="hljs-keyword">this</span>.jwks_cached_at=<span class="hljs-built_in">Number</span>.MIN_SAFE_INTEGER</span>),<span class="hljs-params">this</span>.<span class="hljs-params">mfa</span>={<span class="hljs-params">verify</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_verify</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">enroll</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_enroll</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">unenroll</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_unenroll</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">challenge</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_challenge</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">listFactors</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_listFactors</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">challengeAndVerify</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_challengeAndVerify</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">getAuthenticatorAssuranceLevel</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_getAuthenticatorAssuranceLevel</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">webauthn</span>:<span class="hljs-params">new</span> <span class="hljs-params">tY</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>)},<span class="hljs-params">this</span>.<span class="hljs-params">oauth</span>={<span class="hljs-params">getAuthorizationDetails</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_getAuthorizationDetails</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">approveAuthorization</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_approveAuthorization</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">denyAuthorization</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_denyAuthorization</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">listGrants</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_listOAuthGrants</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>),<span class="hljs-params">revokeGrant</span>:<span class="hljs-params">this</span>.<span class="hljs-params">_revokeOAuthGrant</span>.<span class="hljs-params">bind</span>(<span class="hljs-params"><span class="hljs-keyword">this</span></span>)},<span class="hljs-params">this</span>.<span class="hljs-params">persistSession</span>?(<span class="hljs-params">r.storage?<span class="hljs-keyword">this</span>.storage=r.storage:(<span class="hljs-keyword">this</span>.memoryStorage={},<span class="hljs-keyword">this</span>.storage=tB(<span class="hljs-keyword">this</span>.memoryStorage</span>)),<span class="hljs-params">r</span>.<span class="hljs-params">userStorage</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.userStorage=r.userStorage</span>)):(<span class="hljs-params"><span class="hljs-keyword">this</span>.memoryStorage={},<span class="hljs-keyword">this</span>.storage=tB(<span class="hljs-keyword">this</span>.memoryStorage</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">initialize</span><span class="hljs-params">()</span>}<span class="hljs-params">isThrowOnErrorEnabled</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">throwOnError</span>}<span class="hljs-params">_returnResult</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.throwOnError&amp;&amp;e&amp;&amp;e.error</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>.<span class="hljs-params">error</span>;<span class="hljs-params">return</span> <span class="hljs-params">e</span>}<span class="hljs-params">_logPrefix</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span>`<span class="hljs-params">GoTrueClient</span>@<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">storageKey</span>}:<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">instanceID</span>} (<span class="hljs-params">${eG}</span>) <span class="hljs-params">$</span>{<span class="hljs-params">new</span> <span class="hljs-params">Date</span><span class="hljs-params">()</span>.<span class="hljs-params">toISOString</span><span class="hljs-params">()</span>}`}<span class="hljs-params">_debug</span>(<span class="hljs-params">...e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">logDebugMessages</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">logger</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._logPrefix(</span>),...<span class="hljs-params">e</span>),<span class="hljs-params">this</span>}<span class="hljs-params">async</span> <span class="hljs-params">initialize</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>||(<span class="hljs-params"><span class="hljs-keyword">this</span>.initializePromise=(<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._acquireLock(<span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>()=&gt;<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._initialize()))()),<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializePromise}<span class="hljs-keyword">async</span> _initialize(){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._recoverAndRefresh(),{<span class="hljs-attr">error</span>:<span class="hljs-literal">null</span>}}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">if</span>(eZ(e))<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">error</span>:e});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">error</span>:<span class="hljs-keyword">new</span> e1(<span class="hljs-string">"Unexpected error during initialization"</span>,e)})}<span class="hljs-keyword">finally</span>{<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._handleVisibilityChange(),<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_initialize()"</span>,<span class="hljs-string">"end"</span>)}}<span class="hljs-keyword">async</span> signInAnonymously(e){<span class="hljs-keyword">var</span> t,r,s;<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:i,<span class="hljs-attr">error</span>:n}=<span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/signup`</span>,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">body</span>:{<span class="hljs-attr">data</span>:<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">r=<span class="hljs-literal">null</span>==(t=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">data</span>)?<span class="hljs-params">r</span>:{},<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">s=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">captchaToken</span>}},<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>});<span class="hljs-params">if</span>(<span class="hljs-params">n||!i</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:n}</span>);<span class="hljs-params">let</span> <span class="hljs-params">a</span>=<span class="hljs-params">i</span>.<span class="hljs-params">session</span>,<span class="hljs-params">o</span>=<span class="hljs-params">i</span>.<span class="hljs-params">user</span>;<span class="hljs-params">return</span> <span class="hljs-params">i</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(i.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,a</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:o,session:a},error:<span class="hljs-literal">null</span>}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signUp</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"email"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">email</span>:<span class="hljs-params">r</span>,<span class="hljs-params">password</span>:<span class="hljs-params">s</span>,<span class="hljs-params">options</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">a</span>=<span class="hljs-params">null</span>,<span class="hljs-params">o</span>=<span class="hljs-params">null</span>;"<span class="hljs-params">pkce</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">flowType</span>&amp;&amp;(<span class="hljs-params">[a,o]=<span class="hljs-keyword">await</span> tm(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey</span>)),<span class="hljs-params">i</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/signup`</span>,{headers:<span class="hljs-keyword">this</span>.headers,redirectTo:<span class="hljs-literal">null</span>==n?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.emailRedirectTo,body:{email:r,password:s,data:<span class="hljs-literal">null</span>!=(t=<span class="hljs-literal">null</span>==n?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.data</span>)?<span class="hljs-params">t</span>:{},<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==<span class="hljs-params">n</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">n</span>.<span class="hljs-params">captchaToken</span>},<span class="hljs-params">code_challenge</span>:<span class="hljs-params">a</span>,<span class="hljs-params">code_challenge_method</span>:<span class="hljs-params">o</span>},<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>})}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"phone"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">phone</span>:<span class="hljs-params">t</span>,<span class="hljs-params">password</span>:<span class="hljs-params">n</span>,<span class="hljs-params">options</span>:<span class="hljs-params">a</span>}=<span class="hljs-params">e</span>;<span class="hljs-params">i</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/signup`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{phone:t,password:n,data:<span class="hljs-literal">null</span>!=(r=<span class="hljs-literal">null</span>==a?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:a.data</span>)?<span class="hljs-params">r</span>:{},<span class="hljs-params">channel</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">s=<span class="hljs-literal">null</span>==a?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:a.channel</span>)?<span class="hljs-params">s</span>:"<span class="hljs-params">sms</span>",<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==<span class="hljs-params">a</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">a</span>.<span class="hljs-params">captchaToken</span>}},<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>})}<span class="hljs-params">else</span> <span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e6</span>(<span class="hljs-params"><span class="hljs-string">"You must provide either an email or phone number and a password"</span></span>);<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">n</span>,<span class="hljs-params">error</span>:<span class="hljs-params">a</span>}=<span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params">a||!n</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:a}</span>);<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">n</span>.<span class="hljs-params">session</span>,<span class="hljs-params">l</span>=<span class="hljs-params">n</span>.<span class="hljs-params">user</span>;<span class="hljs-params">return</span> <span class="hljs-params">n</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(n.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,o</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:l,session:o},error:<span class="hljs-literal">null</span>}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signInWithPassword</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"email"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">email</span>:<span class="hljs-params">r</span>,<span class="hljs-params">password</span>:<span class="hljs-params">s</span>,<span class="hljs-params">options</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">e</span>;<span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=password`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.captchaToken}},xform:tI}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"phone"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">phone</span>:<span class="hljs-params">r</span>,<span class="hljs-params">password</span>:<span class="hljs-params">s</span>,<span class="hljs-params">options</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">e</span>;<span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=password`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.captchaToken}},xform:tI}</span>)}<span class="hljs-params">else</span> <span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e6</span>(<span class="hljs-params"><span class="hljs-string">"You must provide either an email or phone number and a password"</span></span>);<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">r</span>,<span class="hljs-params">error</span>:<span class="hljs-params">s</span>}=<span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params">s</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:s}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!r||!r.session||!r.user</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">e3</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>)}<span class="hljs-params">return</span> <span class="hljs-params">r</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(r.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,r.session</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-built_in">Object</span>.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:<span class="hljs-literal">null</span></span>),<span class="hljs-params">error</span>:<span class="hljs-params">s</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signInWithOAuth</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_handleProviderSignIn</span>(<span class="hljs-params">e.provider,{redirectTo:<span class="hljs-literal">null</span>==(t=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">redirectTo</span>,<span class="hljs-params">scopes</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">r=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">scopes</span>,<span class="hljs-params">queryParams</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">s=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">queryParams</span>,<span class="hljs-params">skipBrowserRedirect</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">i=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">skipBrowserRedirect</span>})}<span class="hljs-params">async</span> <span class="hljs-params">exchangeCodeForSession</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>,<span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">this</span>._exchangeCodeForSession(e))}<span class="hljs-keyword">async</span> signInWithWeb3(e){<span class="hljs-keyword">let</span>{<span class="hljs-attr">chain</span>:t}=e;<span class="hljs-keyword">switch</span>(t){<span class="hljs-keyword">case</span><span class="hljs-string">"ethereum"</span>:<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.signInWithEthereum(e);<span class="hljs-keyword">case</span><span class="hljs-string">"solana"</span>:<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.signInWithSolana(e);<span class="hljs-keyword">default</span>:<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Unsupported chain "<span class="hljs-subst">${t}</span>"`</span>)}}<span class="hljs-keyword">async</span> signInWithEthereum(e){<span class="hljs-keyword">var</span> t,r,s,i,n,a,o,l,h,u,c,d;<span class="hljs-keyword">let</span> f,p;<span class="hljs-keyword">if</span>(<span class="hljs-string">"message"</span><span class="hljs-keyword">in</span> e)f=e.message,p=e.signature;<span class="hljs-keyword">else</span>{<span class="hljs-keyword">let</span>{<span class="hljs-attr">chain</span>:u,<span class="hljs-attr">wallet</span>:c,<span class="hljs-attr">statement</span>:g,<span class="hljs-attr">options</span>:y}=e;<span class="hljs-keyword">if</span>(<span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> c||!<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.url</span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Both wallet and url must be specified in non-browser environments."</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">_</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-literal">null</span>!=(t=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.url</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">window</span>.<span class="hljs-params">location</span>.<span class="hljs-params">href</span>),<span class="hljs-params">w</span>=<span class="hljs-params">await</span> <span class="hljs-params">c</span>.<span class="hljs-params">request</span>(<span class="hljs-params">{method:<span class="hljs-string">"eth_requestAccounts"</span>}</span>).<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;e</span>).<span class="hljs-params">catch</span>(<span class="hljs-params">(</span>)=&gt;</span>{<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid"</span>)});<span class="hljs-keyword">if</span>(!w||<span class="hljs-number">0</span>===w.length)<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"@supabase/auth-js: No accounts available. Please ensure the wallet is connected."</span>);<span class="hljs-keyword">let</span> m=tq(w[<span class="hljs-number">0</span>]),b=<span class="hljs-literal">null</span>==(r=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum)?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.chainId;b||(b=<span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">await</span> c.request({<span class="hljs-attr">method</span>:<span class="hljs-string">"eth_chainId"</span>}),<span class="hljs-number">16</span>)),f=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">var</span> t;<span class="hljs-keyword">let</span>{<span class="hljs-attr">chainId</span>:r,<span class="hljs-attr">domain</span>:s,<span class="hljs-attr">expirationTime</span>:i,<span class="hljs-attr">issuedAt</span>:n=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>,<span class="hljs-attr">nonce</span>:a,<span class="hljs-attr">notBefore</span>:o,<span class="hljs-attr">requestId</span>:l,<span class="hljs-attr">resources</span>:h,<span class="hljs-attr">scheme</span>:u,<span class="hljs-attr">uri</span>:c,<span class="hljs-attr">version</span>:d}=e;<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">Number</span>.isInteger(r))<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: <span class="hljs-subst">${r}</span>`</span>);<span class="hljs-keyword">if</span>(!s)<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.'</span>);<span class="hljs-keyword">if</span>(a&amp;&amp;a.length&lt;<span class="hljs-number">8</span>)<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: <span class="hljs-subst">${a}</span>`</span>);<span class="hljs-keyword">if</span>(!c)<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.'</span>);<span class="hljs-keyword">if</span>(<span class="hljs-string">"1"</span>!==d)<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: <span class="hljs-subst">${d}</span>`</span>);<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==(t=e.statement)?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.includes(<span class="hljs-string">"\n"</span>))<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: <span class="hljs-subst">${e.statement}</span>`</span>);<span class="hljs-keyword">let</span> f=tq(e.address),p=u?<span class="hljs-string">`<span class="hljs-subst">${u}</span>://<span class="hljs-subst">${s}</span>`</span>:s,g=e.statement?<span class="hljs-string">`<span class="hljs-subst">${e.statement}</span>
`</span>:<span class="hljs-string">""</span>,y=<span class="hljs-string">`<span class="hljs-subst">${p}</span> wants you to sign in with your Ethereum account:
<span class="hljs-subst">${f}</span>

<span class="hljs-subst">${g}</span>`</span>,_=<span class="hljs-string">`URI: <span class="hljs-subst">${c}</span>
Version: <span class="hljs-subst">${d}</span>
Chain ID: <span class="hljs-subst">${r}</span><span class="hljs-subst">${a?<span class="hljs-string">`
Nonce: <span class="hljs-subst">${a}</span>`</span>:<span class="hljs-string">""</span>}</span>
Issued At: <span class="hljs-subst">${n.toISOString()}</span>`</span>;<span class="hljs-keyword">if</span>(i&amp;&amp;(_+=<span class="hljs-string">`
Expiration Time: <span class="hljs-subst">${i.toISOString()}</span>`</span>),o&amp;&amp;(_+=<span class="hljs-string">`
Not Before: <span class="hljs-subst">${o.toISOString()}</span>`</span>),l&amp;&amp;(_+=<span class="hljs-string">`
Request ID: <span class="hljs-subst">${l}</span>`</span>),h){<span class="hljs-keyword">let</span> e=<span class="hljs-string">"\nResources:"</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> t <span class="hljs-keyword">of</span> h){<span class="hljs-keyword">if</span>(!t||<span class="hljs-string">"string"</span>!=<span class="hljs-keyword">typeof</span> t)<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: <span class="hljs-subst">${t}</span>`</span>);e+=<span class="hljs-string">`
- <span class="hljs-subst">${t}</span>`</span>}_+=e}<span class="hljs-keyword">return</span><span class="hljs-string">`<span class="hljs-subst">${y}</span>
<span class="hljs-subst">${_}</span>`</span>}({<span class="hljs-attr">domain</span>:_.host,<span class="hljs-attr">address</span>:m,<span class="hljs-attr">statement</span>:g,<span class="hljs-attr">uri</span>:_.href,<span class="hljs-attr">version</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">chainId</span>:b,<span class="hljs-attr">nonce</span>:<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">s=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">nonce</span>,<span class="hljs-params">issuedAt</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">n=<span class="hljs-literal">null</span>==(i=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">issuedAt</span>)?<span class="hljs-params">n</span>:<span class="hljs-params">new</span> <span class="hljs-params">Date</span>,<span class="hljs-params">expirationTime</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">a=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">a</span>.<span class="hljs-params">expirationTime</span>,<span class="hljs-params">notBefore</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">o=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">o</span>.<span class="hljs-params">notBefore</span>,<span class="hljs-params">requestId</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">l=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">l</span>.<span class="hljs-params">requestId</span>,<span class="hljs-params">resources</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">h=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithEthereum</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">h</span>.<span class="hljs-params">resources</span>}),<span class="hljs-params">p</span>=<span class="hljs-params">await</span> <span class="hljs-params">c</span>.<span class="hljs-params">request</span>(<span class="hljs-params">{method:<span class="hljs-string">"personal_sign"</span>,params:[(d=f,<span class="hljs-string">"0x"</span>+<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(<span class="hljs-keyword">new</span> TextEncoder(</span>).<span class="hljs-params">encode</span>(<span class="hljs-params">d</span>),<span class="hljs-params">e</span>=&gt;</span>e.toString(<span class="hljs-number">16</span>).padStart(<span class="hljs-number">2</span>,<span class="hljs-string">"0"</span>)).join(<span class="hljs-string">""</span>)),m]})}<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:t,<span class="hljs-attr">error</span>:r}=<span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=web3`</span>,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">body</span>:<span class="hljs-built_in">Object</span>.assign({<span class="hljs-attr">chain</span>:<span class="hljs-string">"ethereum"</span>,<span class="hljs-attr">message</span>:f,<span class="hljs-attr">signature</span>:p},(<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">u=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">u</span>.<span class="hljs-params">captchaToken</span>)?{<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">c=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">c</span>.<span class="hljs-params">captchaToken</span>}}:<span class="hljs-params">null</span>),<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>});<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">r</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!t||!t.session||!t.user</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">e3</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>)}<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(t.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,t.session</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-built_in">Object</span>.assign({},t</span>),<span class="hljs-params">error</span>:<span class="hljs-params">r</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signInWithSolana</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>,<span class="hljs-params">a</span>,<span class="hljs-params">o</span>,<span class="hljs-params">l</span>,<span class="hljs-params">h</span>,<span class="hljs-params">u</span>,<span class="hljs-params">c</span>,<span class="hljs-params">d</span>;<span class="hljs-params">let</span> <span class="hljs-params">f</span>,<span class="hljs-params">p</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"message"</span><span class="hljs-keyword">in</span> e</span>)<span class="hljs-params">f</span>=<span class="hljs-params">e</span>.<span class="hljs-params">message</span>,<span class="hljs-params">p</span>=<span class="hljs-params">e</span>.<span class="hljs-params">signature</span>;<span class="hljs-params">else</span>{<span class="hljs-params">let</span>{<span class="hljs-params">chain</span>:<span class="hljs-params">c</span>,<span class="hljs-params">wallet</span>:<span class="hljs-params">d</span>,<span class="hljs-params">statement</span>:<span class="hljs-params">g</span>,<span class="hljs-params">options</span>:<span class="hljs-params">y</span>}=<span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"object"</span>!=<span class="hljs-keyword">typeof</span> d||!(<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.url</span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Both wallet and url must be specified in non-browser environments."</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">_</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-literal">null</span>!=(t=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.url</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">window</span>.<span class="hljs-params">location</span>.<span class="hljs-params">href</span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"signIn"</span><span class="hljs-keyword">in</span> d&amp;&amp;d.signIn</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>,<span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">d</span>.<span class="hljs-params">signIn</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({issuedAt:<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(</span>).<span class="hljs-params">toISOString</span><span class="hljs-params">()</span>},<span class="hljs-params">null</span>==<span class="hljs-params">y</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>),{<span class="hljs-params">version</span>:"1",<span class="hljs-params">domain</span>:<span class="hljs-params">_</span>.<span class="hljs-params">host</span>,<span class="hljs-params">uri</span>:<span class="hljs-params">_</span>.<span class="hljs-params">href</span>}),<span class="hljs-params">g</span>?{<span class="hljs-params">statement</span>:<span class="hljs-params">g</span>}:<span class="hljs-params">null</span>));<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-built_in">Array</span>.isArray(t</span>)&amp;&amp;<span class="hljs-params">t</span>[0]&amp;&amp;"<span class="hljs-params">object</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">t</span>[0])<span class="hljs-params">e</span>=<span class="hljs-params">t</span>[0];<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params">t&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> t&amp;&amp;<span class="hljs-string">"signedMessage"</span><span class="hljs-keyword">in</span> t&amp;&amp;<span class="hljs-string">"signature"</span><span class="hljs-keyword">in</span> t</span>)<span class="hljs-params">e</span>=<span class="hljs-params">t</span>;<span class="hljs-params">else</span> <span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Wallet method signIn() returned unrecognized value"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"signedMessage"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"signature"</span><span class="hljs-keyword">in</span> e&amp;&amp;(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> e.signedMessage||e.signedMessage <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Uint8Array</span></span>)&amp;&amp;<span class="hljs-params">e</span>.<span class="hljs-params">signature</span> <span class="hljs-params">instanceof</span> <span class="hljs-params">Uint8Array</span>)<span class="hljs-params">f</span>="<span class="hljs-params">string</span>"==<span class="hljs-params">typeof</span> <span class="hljs-params">e</span>.<span class="hljs-params">signedMessage</span>?<span class="hljs-params">e</span>.<span class="hljs-params">signedMessage</span>:<span class="hljs-params">new</span> <span class="hljs-params">TextDecoder</span><span class="hljs-params">()</span>.<span class="hljs-params">decode</span>(<span class="hljs-params">e.signedMessage</span>),<span class="hljs-params">p</span>=<span class="hljs-params">e</span>.<span class="hljs-params">signature</span>;<span class="hljs-params">else</span> <span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields"</span></span>)}<span class="hljs-params">else</span>{<span class="hljs-params">if</span>(<span class="hljs-params">!(<span class="hljs-string">"signMessage"</span><span class="hljs-keyword">in</span> d</span>)||"<span class="hljs-params">function</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">d</span>.<span class="hljs-params">signMessage</span>||!(<span class="hljs-params"><span class="hljs-string">"publicKey"</span><span class="hljs-keyword">in</span> d</span>)||"<span class="hljs-params">object</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">d</span>||!<span class="hljs-params">d</span>.<span class="hljs-params">publicKey</span>||!(<span class="hljs-params"><span class="hljs-string">"toBase58"</span><span class="hljs-keyword">in</span> d.publicKey</span>)||"<span class="hljs-params">function</span>"!=<span class="hljs-params">typeof</span> <span class="hljs-params">d</span>.<span class="hljs-params">publicKey</span>.<span class="hljs-params">toBase58</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API"</span></span>);<span class="hljs-params">f</span>=[`<span class="hljs-params">$</span>{<span class="hljs-params">_</span>.<span class="hljs-params">host</span>} <span class="hljs-params">wants</span> <span class="hljs-params">you</span> <span class="hljs-params">to</span> <span class="hljs-params">sign</span> <span class="hljs-params">in</span> <span class="hljs-params">with</span> <span class="hljs-params">your</span> <span class="hljs-params">Solana</span> <span class="hljs-params">account</span>:`,<span class="hljs-params">d</span>.<span class="hljs-params">publicKey</span>.<span class="hljs-params">toBase58</span><span class="hljs-params">()</span>,...<span class="hljs-params">g</span>?["",<span class="hljs-params">g</span>,""]:[""],"<span class="hljs-params">Version</span>: 1",`<span class="hljs-params">URI</span>: <span class="hljs-params">$</span>{<span class="hljs-params">_</span>.<span class="hljs-params">href</span>}`,`<span class="hljs-params">Issued</span> <span class="hljs-params">At</span>: <span class="hljs-params">$</span>{<span class="hljs-params">null</span>!=(<span class="hljs-params">s=<span class="hljs-literal">null</span>==(r=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">issuedAt</span>)?<span class="hljs-params">s</span>:<span class="hljs-params">new</span> <span class="hljs-params">Date</span><span class="hljs-params">()</span>.<span class="hljs-params">toISOString</span><span class="hljs-params">()</span>}`,...(<span class="hljs-params"><span class="hljs-literal">null</span>==(i=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">notBefore</span>)?[`<span class="hljs-params">Not</span> <span class="hljs-params">Before</span>: <span class="hljs-params">$</span>{<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>.<span class="hljs-params">notBefore</span>}`]:[],...(<span class="hljs-params"><span class="hljs-literal">null</span>==(n=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">n</span>.<span class="hljs-params">expirationTime</span>)?[`<span class="hljs-params">Expiration</span> <span class="hljs-params">Time</span>: <span class="hljs-params">$</span>{<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>.<span class="hljs-params">expirationTime</span>}`]:[],...(<span class="hljs-params"><span class="hljs-literal">null</span>==(a=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">a</span>.<span class="hljs-params">chainId</span>)?[`<span class="hljs-params">Chain</span> <span class="hljs-params">ID</span>: <span class="hljs-params">$</span>{<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>.<span class="hljs-params">chainId</span>}`]:[],...(<span class="hljs-params"><span class="hljs-literal">null</span>==(o=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">o</span>.<span class="hljs-params">nonce</span>)?[`<span class="hljs-params">Nonce</span>: <span class="hljs-params">$</span>{<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>.<span class="hljs-params">nonce</span>}`]:[],...(<span class="hljs-params"><span class="hljs-literal">null</span>==(l=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">l</span>.<span class="hljs-params">requestId</span>)?[`<span class="hljs-params">Request</span> <span class="hljs-params">ID</span>: <span class="hljs-params">$</span>{<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>.<span class="hljs-params">requestId</span>}`]:[],...(<span class="hljs-params"><span class="hljs-literal">null</span>==(u=<span class="hljs-literal">null</span>==(h=<span class="hljs-literal">null</span>==y?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:y.signInWithSolana</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">h</span>.<span class="hljs-params">resources</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">u</span>.<span class="hljs-params">length</span>)?["<span class="hljs-params">Resources</span>",...<span class="hljs-params">y</span>.<span class="hljs-params">signInWithSolana</span>.<span class="hljs-params">resources</span>.<span class="hljs-params">map</span>(<span class="hljs-params">e=&gt;<span class="hljs-string">`- <span class="hljs-subst">${e}</span>`</span></span>)]:[]].<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">"\n"</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">await</span> <span class="hljs-params">d</span>.<span class="hljs-params">signMessage</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> TextEncoder(</span>).<span class="hljs-params">encode</span>(<span class="hljs-params">f</span>),"<span class="hljs-params">utf8</span>");<span class="hljs-params">if</span>(<span class="hljs-params">!e||!(e <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Uint8Array</span></span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"@supabase/auth-js: Wallet signMessage() API returned an recognized value"</span></span>);<span class="hljs-params">p</span>=<span class="hljs-params">e</span>}}<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=web3`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:<span class="hljs-built_in">Object</span>.assign({chain:<span class="hljs-string">"solana"</span>,message:f,signature:tl(p</span>)},(<span class="hljs-params"><span class="hljs-literal">null</span>==(c=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">c</span>.<span class="hljs-params">captchaToken</span>)?{<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">d=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">d</span>.<span class="hljs-params">captchaToken</span>}}:<span class="hljs-params">null</span>),<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>});<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">r</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!t||!t.session||!t.user</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">e3</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>)}<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(t.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,t.session</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-built_in">Object</span>.assign({},t</span>),<span class="hljs-params">error</span>:<span class="hljs-params">r</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_exchangeCodeForSession</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">tc</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.storageKey}</span>-code-verifier`</span></span>),[<span class="hljs-params">r</span>,<span class="hljs-params">s</span>]=(<span class="hljs-params"><span class="hljs-literal">null</span>!=t?t:<span class="hljs-string">""</span></span>).<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">"/"</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=pkce`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{auth_code:e,code_verifier:r},xform:tP}</span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">await</span> td(<span class="hljs-keyword">this</span>.storage,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.storageKey}</span>-code-verifier`</span></span>),<span class="hljs-params">i</span>)<span class="hljs-params">throw</span> <span class="hljs-params">i</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!t||!t.session||!t.user</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">e3</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>,redirectType:<span class="hljs-literal">null</span>},error:e}</span>)}<span class="hljs-params">return</span> <span class="hljs-params">t</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(t.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,t.session</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},t</span>),{<span class="hljs-params">redirectType</span>:<span class="hljs-params">null</span>!=<span class="hljs-params">s</span>?<span class="hljs-params">s</span>:<span class="hljs-params">null</span>}),<span class="hljs-params">error</span>:<span class="hljs-params">i</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>,redirectType:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signInWithIdToken</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">options</span>:<span class="hljs-params">t</span>,<span class="hljs-params">provider</span>:<span class="hljs-params">r</span>,<span class="hljs-params">token</span>:<span class="hljs-params">s</span>,<span class="hljs-params">access_token</span>:<span class="hljs-params">i</span>,<span class="hljs-params">nonce</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">e</span>,{<span class="hljs-params">data</span>:<span class="hljs-params">a</span>,<span class="hljs-params">error</span>:<span class="hljs-params">o</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=id_token`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{provider:r,id_token:s,access_token:i,nonce:n,gotrue_meta_security:{captcha_token:<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.captchaToken}},xform:tP}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">o</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:o}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!a||!a.session||!a.user</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">e3</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>)}<span class="hljs-params">return</span> <span class="hljs-params">a</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(a.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,a.session</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:a,error:o}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signInWithOtp</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>;<span class="hljs-params">try</span>{<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"email"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">email</span>:<span class="hljs-params">s</span>,<span class="hljs-params">options</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">n</span>=<span class="hljs-params">null</span>,<span class="hljs-params">a</span>=<span class="hljs-params">null</span>;"<span class="hljs-params">pkce</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">flowType</span>&amp;&amp;(<span class="hljs-params">[n,a]=<span class="hljs-keyword">await</span> tm(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey</span>));<span class="hljs-params">let</span>{<span class="hljs-params">error</span>:<span class="hljs-params">o</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/otp`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{email:s,data:<span class="hljs-literal">null</span>!=(t=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.data</span>)?<span class="hljs-params">t</span>:{},<span class="hljs-params">create_user</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">r=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.shouldCreateUser</span>)||<span class="hljs-params">r</span>,<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==<span class="hljs-params">i</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">captchaToken</span>},<span class="hljs-params">code_challenge</span>:<span class="hljs-params">n</span>,<span class="hljs-params">code_challenge_method</span>:<span class="hljs-params">a</span>},<span class="hljs-params">redirectTo</span>:<span class="hljs-params">null</span>==<span class="hljs-params">i</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">emailRedirectTo</span>});<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:o}</span>)}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"phone"</span><span class="hljs-keyword">in</span> e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">phone</span>:<span class="hljs-params">t</span>,<span class="hljs-params">options</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">e</span>,{<span class="hljs-params">data</span>:<span class="hljs-params">a</span>,<span class="hljs-params">error</span>:<span class="hljs-params">o</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/otp`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:{phone:t,data:<span class="hljs-literal">null</span>!=(s=<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.data</span>)?<span class="hljs-params">s</span>:{},<span class="hljs-params">create_user</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">i=<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.shouldCreateUser</span>)||<span class="hljs-params">i</span>,<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==<span class="hljs-params">r</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">captchaToken</span>},<span class="hljs-params">channel</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">n=<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.channel</span>)?<span class="hljs-params">n</span>:"<span class="hljs-params">sms</span>"}});<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>,messageId:<span class="hljs-literal">null</span>==a?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:a.message_id},error:o}</span>)}<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e6</span>(<span class="hljs-params"><span class="hljs-string">"You must provide either an email or phone number."</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">verifyOtp</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>;"<span class="hljs-params">options</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params">s=<span class="hljs-literal">null</span>==(t=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">redirectTo</span>,<span class="hljs-params">i</span>=<span class="hljs-params">null</span>==(<span class="hljs-params">r=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">captchaToken</span>);<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">n</span>,<span class="hljs-params">error</span>:<span class="hljs-params">a</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/verify`</span>,{headers:<span class="hljs-keyword">this</span>.headers,body:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">i</span>}}),<span class="hljs-params">redirectTo</span>:<span class="hljs-params">s</span>,<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>});<span class="hljs-params">if</span>(<span class="hljs-params">a</span>)<span class="hljs-params">throw</span> <span class="hljs-params">a</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!n</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"An error occurred on token verification."</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">n</span>.<span class="hljs-params">session</span>,<span class="hljs-params">l</span>=<span class="hljs-params">n</span>.<span class="hljs-params">user</span>;<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==o?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:o.access_token</span>)&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(o</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"recovery"</span>==e.type?<span class="hljs-string">"PASSWORD_RECOVERY"</span>:<span class="hljs-string">"SIGNED_IN"</span>,o</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:l,session:o},error:<span class="hljs-literal">null</span>}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">signInWithSSO</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>,<span class="hljs-params">s</span>,<span class="hljs-params">i</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span> <span class="hljs-params">n</span>=<span class="hljs-params">null</span>,<span class="hljs-params">a</span>=<span class="hljs-params">null</span>;"<span class="hljs-params">pkce</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">flowType</span>&amp;&amp;(<span class="hljs-params">[n,a]=<span class="hljs-keyword">await</span> tm(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey</span>));<span class="hljs-params">let</span> <span class="hljs-params">o</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/sso`</span>,{body:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},<span class="hljs-string">"providerId"</span><span class="hljs-keyword">in</span> e?{provider_id:e.providerId}:<span class="hljs-literal">null</span></span>),"<span class="hljs-params">domain</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>?{<span class="hljs-params">domain</span>:<span class="hljs-params">e</span>.<span class="hljs-params">domain</span>}:<span class="hljs-params">null</span>),{<span class="hljs-params">redirect_to</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">r=<span class="hljs-literal">null</span>==(t=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">redirectTo</span>)?<span class="hljs-params">r</span>:<span class="hljs-params">void</span> 0}),(<span class="hljs-params"><span class="hljs-literal">null</span>==(s=<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">captchaToken</span>)?{<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">e</span>.<span class="hljs-params">options</span>.<span class="hljs-params">captchaToken</span>}}:<span class="hljs-params">null</span>),{<span class="hljs-params">skip_http_redirect</span>:!0,<span class="hljs-params">code_challenge</span>:<span class="hljs-params">n</span>,<span class="hljs-params">code_challenge_method</span>:<span class="hljs-params">a</span>}),<span class="hljs-params">headers</span>:<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>,<span class="hljs-params">xform</span>:<span class="hljs-params">tC</span>});<span class="hljs-params">return</span> <span class="hljs-params">null</span>==(<span class="hljs-params">i=o.data</span>)||<span class="hljs-params">i</span>.<span class="hljs-params">url</span>,<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">o</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">reauthenticate</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>,<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._reauthenticate())}<span class="hljs-keyword">async</span> _reauthenticate(){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> e=&gt;{<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:{<span class="hljs-attr">session</span>:t},<span class="hljs-attr">error</span>:r}=e;<span class="hljs-keyword">if</span>(r)<span class="hljs-keyword">throw</span> r;<span class="hljs-keyword">if</span>(!t)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> e2;<span class="hljs-keyword">let</span>{<span class="hljs-attr">error</span>:s}=<span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/reauthenticate`</span>,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">jwt</span>:t.access_token});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:{<span class="hljs-attr">user</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">session</span>:<span class="hljs-literal">null</span>},<span class="hljs-attr">error</span>:s})})}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">if</span>(eZ(e))<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:{<span class="hljs-attr">user</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">session</span>:<span class="hljs-literal">null</span>},<span class="hljs-attr">error</span>:e});<span class="hljs-keyword">throw</span> e}}<span class="hljs-keyword">async</span> resend(e){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> t=<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/resend`</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"email"</span><span class="hljs-keyword">in</span> e){<span class="hljs-keyword">let</span>{<span class="hljs-attr">email</span>:r,<span class="hljs-attr">type</span>:s,<span class="hljs-attr">options</span>:i}=e,{<span class="hljs-attr">error</span>:n}=<span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,t,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">body</span>:{<span class="hljs-attr">email</span>:r,<span class="hljs-attr">type</span>:s,<span class="hljs-attr">gotrue_meta_security</span>:{<span class="hljs-attr">captcha_token</span>:<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.captchaToken}},<span class="hljs-attr">redirectTo</span>:<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.emailRedirectTo});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:{<span class="hljs-attr">user</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">session</span>:<span class="hljs-literal">null</span>},<span class="hljs-attr">error</span>:n})}<span class="hljs-keyword">if</span>(<span class="hljs-string">"phone"</span><span class="hljs-keyword">in</span> e){<span class="hljs-keyword">let</span>{<span class="hljs-attr">phone</span>:r,<span class="hljs-attr">type</span>:s,<span class="hljs-attr">options</span>:i}=e,{<span class="hljs-attr">data</span>:n,<span class="hljs-attr">error</span>:a}=<span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,t,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">body</span>:{<span class="hljs-attr">phone</span>:r,<span class="hljs-attr">type</span>:s,<span class="hljs-attr">gotrue_meta_security</span>:{<span class="hljs-attr">captcha_token</span>:<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.captchaToken}}});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:{<span class="hljs-attr">user</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">session</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">messageId</span>:<span class="hljs-literal">null</span>==n?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.message_id},<span class="hljs-attr">error</span>:a})}<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> e6(<span class="hljs-string">"You must provide either an email or phone number and a type"</span>)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">if</span>(eZ(e))<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:{<span class="hljs-attr">user</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">session</span>:<span class="hljs-literal">null</span>},<span class="hljs-attr">error</span>:e});<span class="hljs-keyword">throw</span> e}}<span class="hljs-keyword">async</span> getSession(){<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializePromise,<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._acquireLock(<span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>()=&gt;<span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> e=&gt;e))}<span class="hljs-keyword">async</span> _acquireLock(e,t){<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_acquireLock"</span>,<span class="hljs-string">"begin"</span>,e);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.lockAcquired){<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">this</span>.pendingInLock.length?<span class="hljs-keyword">this</span>.pendingInLock[<span class="hljs-keyword">this</span>.pendingInLock.length<span class="hljs-number">-1</span>]:<span class="hljs-built_in">Promise</span>.resolve(),r=<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">await</span> e,<span class="hljs-keyword">await</span> t(</span>)))<span class="hljs-params">()</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">pendingInLock</span>.<span class="hljs-params">push</span>(<span class="hljs-params">(<span class="hljs-keyword">async</span>(</span>)=&gt;</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">await</span> r}<span class="hljs-keyword">catch</span>(e){}})()),r}<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.lock(<span class="hljs-string">`lock:<span class="hljs-subst">${<span class="hljs-keyword">this</span>.storageKey}</span>`</span>,e,<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_acquireLock"</span>,<span class="hljs-string">"lock acquired for storage key"</span>,<span class="hljs-keyword">this</span>.storageKey);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">this</span>.lockAcquired=!<span class="hljs-number">0</span>;<span class="hljs-keyword">let</span> e=t();<span class="hljs-keyword">for</span>(<span class="hljs-keyword">this</span>.pendingInLock.push(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">async</span>(</span>)=&gt;</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">await</span> e}<span class="hljs-keyword">catch</span>(e){}})()),<span class="hljs-keyword">await</span> e;<span class="hljs-keyword">this</span>.pendingInLock.length;){<span class="hljs-keyword">let</span> e=[...this.pendingInLock];<span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(e),<span class="hljs-keyword">this</span>.pendingInLock.splice(<span class="hljs-number">0</span>,e.length)}<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> e}<span class="hljs-keyword">finally</span>{<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_acquireLock"</span>,<span class="hljs-string">"lock released for storage key"</span>,<span class="hljs-keyword">this</span>.storageKey),<span class="hljs-keyword">this</span>.lockAcquired=!<span class="hljs-number">1</span>}})}<span class="hljs-keyword">finally</span>{<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_acquireLock"</span>,<span class="hljs-string">"end"</span>)}}<span class="hljs-keyword">async</span> _useSession(e){<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_useSession"</span>,<span class="hljs-string">"begin"</span>);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> t=<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.__loadSession();<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> e(t)}<span class="hljs-keyword">finally</span>{<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_useSession"</span>,<span class="hljs-string">"end"</span>)}}<span class="hljs-keyword">async</span> __loadSession(){<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#__loadSession()"</span>,<span class="hljs-string">"begin"</span>),<span class="hljs-keyword">this</span>.lockAcquired||<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#__loadSession()"</span>,<span class="hljs-string">"used outside of an acquired lock!"</span>,<span class="hljs-built_in">Error</span>().stack);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> t=<span class="hljs-literal">null</span>,r=<span class="hljs-keyword">await</span> tc(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#getSession()"</span>,<span class="hljs-string">"session from storage"</span>,r),<span class="hljs-literal">null</span>!==r&amp;&amp;<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">this</span>._isValidSession(r</span>)?<span class="hljs-params">t</span>=<span class="hljs-params">r</span>:(<span class="hljs-params"><span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#getSession()"</span>,<span class="hljs-string">"session from storage is not valid"</span></span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_removeSession</span><span class="hljs-params">()</span>)),!<span class="hljs-params">t</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">session</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">let</span> <span class="hljs-params">s</span>=!!<span class="hljs-params">t</span>.<span class="hljs-params">expires_at</span>&amp;&amp;1<span class="hljs-params">e3</span>*<span class="hljs-params">t</span>.<span class="hljs-params">expires_at</span>-<span class="hljs-params">Date</span>.<span class="hljs-params">now</span><span class="hljs-params">()</span>&lt;9<span class="hljs-params">e4</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#__loadSession()"</span>,<span class="hljs-string">`session has<span class="hljs-subst">${s?<span class="hljs-string">""</span>:<span class="hljs-string">" not"</span>}</span> expired`</span>,<span class="hljs-string">"expires_at"</span>,t.expires_at</span>),!<span class="hljs-params">s</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.userStorage</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">await</span> <span class="hljs-params">tc</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.userStorage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span></span>);(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.user</span>)?<span class="hljs-params">t</span>.<span class="hljs-params">user</span>=<span class="hljs-params">e</span>.<span class="hljs-params">user</span>:<span class="hljs-params">t</span>.<span class="hljs-params">user</span>=<span class="hljs-params">tk</span><span class="hljs-params">()</span>}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage.isServer&amp;&amp;t.user&amp;&amp;!t.user.__isUserNotAvailableProxy</span>){<span class="hljs-params">var</span> <span class="hljs-params">e</span>;<span class="hljs-params">let</span> <span class="hljs-params">r</span>={<span class="hljs-params">value</span>:<span class="hljs-params">this</span>.<span class="hljs-params">suppressGetSessionWarning</span>};<span class="hljs-params">t</span>.<span class="hljs-params">user</span>=(<span class="hljs-params">e=t.user,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(e,{get:(e,t,s</span>)=&gt;</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"__isInsecureUserWarningProxy"</span>===t)<span class="hljs-keyword">return</span>!<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"symbol"</span>==<span class="hljs-keyword">typeof</span> t){<span class="hljs-keyword">let</span> r=t.toString();<span class="hljs-keyword">if</span>(<span class="hljs-string">"Symbol(Symbol.toPrimitive)"</span>===r||<span class="hljs-string">"Symbol(Symbol.toStringTag)"</span>===r||<span class="hljs-string">"Symbol(util.inspect.custom)"</span>===r||<span class="hljs-string">"Symbol(nodejs.util.inspect.custom)"</span>===r)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.get(e,t,s)}<span class="hljs-keyword">return</span> r.value||<span class="hljs-string">"string"</span>!=<span class="hljs-keyword">typeof</span> t||<span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."</span></span>),<span class="hljs-params">r</span>.<span class="hljs-params">value</span>=!0),<span class="hljs-params">Reflect</span>.<span class="hljs-params">get</span>(<span class="hljs-params">e,t,s</span>)}})),<span class="hljs-params">r</span>.<span class="hljs-params">value</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.suppressGetSessionWarning=!<span class="hljs-number">0</span></span>)}<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">session</span>:<span class="hljs-params">t</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">i</span>,<span class="hljs-params">error</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">t.refresh_token</span>);<span class="hljs-params">if</span>(<span class="hljs-params">n</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{session:<span class="hljs-literal">null</span>},error:n}</span>);<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{session:i},error:<span class="hljs-literal">null</span>}</span>)}<span class="hljs-params">finally</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#__loadSession()"</span>,<span class="hljs-string">"end"</span></span>)}}<span class="hljs-params">async</span> <span class="hljs-params">getUser</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">e</span>?<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_getUser</span>(<span class="hljs-params">e</span>):(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializePromise,<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._acquireLock(<span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._getUser()))}<span class="hljs-keyword">async</span> _getUser(e){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(e)<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user`</span>,{<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">jwt</span>:e,<span class="hljs-attr">xform</span>:t$});<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> e=&gt;{<span class="hljs-keyword">var</span> t,r,s;<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:i,<span class="hljs-attr">error</span>:n}=e;<span class="hljs-keyword">if</span>(n)<span class="hljs-keyword">throw</span> n;<span class="hljs-keyword">return</span><span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==(t=i.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">access_token</span>)||<span class="hljs-params">this</span>.<span class="hljs-params">hasCustomAuthorizationHeader</span>?<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>!=(s=<span class="hljs-literal">null</span>==(r=i.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>)?<span class="hljs-params">s</span>:<span class="hljs-params">void</span> 0,<span class="hljs-params">xform</span>:<span class="hljs-params">t$</span>}):{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">new</span> <span class="hljs-params">e2</span>}})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">eZ</span>(<span class="hljs-params">e</span>)&amp;&amp;"<span class="hljs-params">AuthSessionMissingError</span>"===<span class="hljs-params">e</span>.<span class="hljs-params">name</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._removeSession(</span>),<span class="hljs-params">await</span> <span class="hljs-params">td</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.storageKey}</span>-code-verifier`</span></span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">updateUser</span>(<span class="hljs-params">e,t={}</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>,<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._updateUser(e,t))}<span class="hljs-keyword">async</span> _updateUser(e,t={}){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> r=&gt;{<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:s,<span class="hljs-attr">error</span>:i}=r;<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">throw</span> i;<span class="hljs-keyword">if</span>(!s.session)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> e2;<span class="hljs-keyword">let</span> n=s.session,a=<span class="hljs-literal">null</span>,o=<span class="hljs-literal">null</span>;<span class="hljs-string">"pkce"</span>===<span class="hljs-keyword">this</span>.flowType&amp;&amp;<span class="hljs-literal">null</span>!=e.email&amp;&amp;<span class="hljs-function">(<span class="hljs-params">[a,o]=<span class="hljs-keyword">await</span> tm(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey</span>));<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">l</span>,<span class="hljs-params">error</span>:<span class="hljs-params">h</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"PUT"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user`</span>,{headers:<span class="hljs-keyword">this</span>.headers,redirectTo:<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.emailRedirectTo,body:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">code_challenge</span>:<span class="hljs-params">a</span>,<span class="hljs-params">code_challenge_method</span>:<span class="hljs-params">o</span>}),<span class="hljs-params">jwt</span>:<span class="hljs-params">n</span>.<span class="hljs-params">access_token</span>,<span class="hljs-params">xform</span>:<span class="hljs-params">t$</span>});<span class="hljs-params">if</span>(<span class="hljs-params">h</span>)<span class="hljs-params">throw</span> <span class="hljs-params">h</span>;<span class="hljs-params">return</span> <span class="hljs-params">n</span>.<span class="hljs-params">user</span>=<span class="hljs-params">l</span>.<span class="hljs-params">user</span>,<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_saveSession</span>(<span class="hljs-params">n</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"USER_UPDATED"</span>,n</span>),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:n.user},error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">setSession</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>,<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._setSession(e))}<span class="hljs-keyword">async</span> _setSession(e){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(!e.access_token||!e.refresh_token)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> e2;<span class="hljs-keyword">let</span> t=<span class="hljs-built_in">Date</span>.now()/<span class="hljs-number">1e3</span>,r=t,s=!<span class="hljs-number">0</span>,i=<span class="hljs-literal">null</span>,{<span class="hljs-attr">payload</span>:n}=tp(e.access_token);<span class="hljs-keyword">if</span>(n.exp&amp;&amp;<span class="hljs-function">(<span class="hljs-params">s=(r=n.exp</span>)&lt;=<span class="hljs-params">t</span>),<span class="hljs-params">s</span>){<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">e.refresh_token</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:r}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">null</span>,<span class="hljs-params">session</span>:<span class="hljs-params">null</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">i</span>=<span class="hljs-params">t</span>}<span class="hljs-params">else</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">s</span>,<span class="hljs-params">error</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_getUser</span>(<span class="hljs-params">e.access_token</span>);<span class="hljs-params">if</span>(<span class="hljs-params">n</span>)<span class="hljs-params">throw</span> <span class="hljs-params">n</span>;<span class="hljs-params">i</span>={<span class="hljs-params">access_token</span>:<span class="hljs-params">e</span>.<span class="hljs-params">access_token</span>,<span class="hljs-params">refresh_token</span>:<span class="hljs-params">e</span>.<span class="hljs-params">refresh_token</span>,<span class="hljs-params">user</span>:<span class="hljs-params">s</span>.<span class="hljs-params">user</span>,<span class="hljs-params">token_type</span>:"<span class="hljs-params">bearer</span>",<span class="hljs-params">expires_in</span>:<span class="hljs-params">r</span>-<span class="hljs-params">t</span>,<span class="hljs-params">expires_at</span>:<span class="hljs-params">r</span>},<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_saveSession</span>(<span class="hljs-params">i</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,i</span>)}<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:i.user,session:i},error:<span class="hljs-literal">null</span>}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{session:<span class="hljs-literal">null</span>,user:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">refreshSession</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>,<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._refreshSession(e))}<span class="hljs-keyword">async</span> _refreshSession(e){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">if</span>(!e){<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:s,<span class="hljs-attr">error</span>:i}=t;<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">throw</span> i;e=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">r=s.session</span>)?<span class="hljs-params">r</span>:<span class="hljs-params">void</span> 0}<span class="hljs-params">if</span>(<span class="hljs-params">!(<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.refresh_token</span>))<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e2</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">s</span>,<span class="hljs-params">error</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">e.refresh_token</span>);<span class="hljs-params">return</span> <span class="hljs-params">i</span>?<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:i}</span>):<span class="hljs-params">s</span>?<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:s.user,session:s},error:<span class="hljs-literal">null</span>}</span>):<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_getSessionFromURL</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">try</span>{<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e4</span>(<span class="hljs-params"><span class="hljs-string">"No browser detected."</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{session:<span class="hljs-literal">null</span>,redirectType:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">_isImplicitGrantCallback</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>!!(<span class="hljs-params">e.access_token||e.error_description</span>)}<span class="hljs-params">async</span> <span class="hljs-params">_isPKCECallback</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">await</span> <span class="hljs-params">tc</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.storageKey}</span>-code-verifier`</span></span>);<span class="hljs-params">return</span>!!(<span class="hljs-params">e.code&amp;&amp;t</span>)}<span class="hljs-params">async</span> <span class="hljs-params">signOut</span>(<span class="hljs-params">e={scope:<span class="hljs-string">"global"</span>}</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">initializePromise</span>,<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._signOut(e))}<span class="hljs-keyword">async</span> _signOut({<span class="hljs-attr">scope</span>:e}={<span class="hljs-attr">scope</span>:<span class="hljs-string">"global"</span>}){<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:s,<span class="hljs-attr">error</span>:i}=t;<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">error</span>:i});<span class="hljs-keyword">let</span> n=<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">r=s.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>;<span class="hljs-params">if</span>(<span class="hljs-params">n</span>){<span class="hljs-params">let</span>{<span class="hljs-params">error</span>:<span class="hljs-params">t</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">admin</span>.<span class="hljs-params">signOut</span>(<span class="hljs-params">n,e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">t&amp;&amp;!(eZ(t</span>)&amp;&amp;"<span class="hljs-params">AuthApiError</span>"===<span class="hljs-params">t</span>.<span class="hljs-params">name</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-number">404</span>===t.status||<span class="hljs-number">401</span>===t.status||<span class="hljs-number">403</span>===t.status</span>)))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{error:t}</span>)}<span class="hljs-params">return</span>"<span class="hljs-params">others</span>"!==<span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._removeSession(</span>),<span class="hljs-params">await</span> <span class="hljs-params">td</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.storageKey}</span>-code-verifier`</span></span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{error:<span class="hljs-literal">null</span>}</span>)})}<span class="hljs-params">onAuthStateChange</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Symbol</span>(<span class="hljs-params"><span class="hljs-string">"auth-callback"</span></span>),<span class="hljs-params">r</span>={<span class="hljs-params">id</span>:<span class="hljs-params">t</span>,<span class="hljs-params">callback</span>:<span class="hljs-params">e</span>,<span class="hljs-params">unsubscribe</span>:<span class="hljs-params">()</span>=&gt;</span>{<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#unsubscribe()"</span>,<span class="hljs-string">"state change callback with id removed"</span>,t),<span class="hljs-keyword">this</span>.stateChangeEmitters.delete(t)}};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#onAuthStateChange()"</span>,<span class="hljs-string">"registered callback with id"</span>,t),<span class="hljs-keyword">this</span>.stateChangeEmitters.set(t,r),(<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializePromise,<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._acquireLock(<span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">this</span>._emitInitialSession(t)})})(),{<span class="hljs-attr">data</span>:{<span class="hljs-attr">subscription</span>:r}}}<span class="hljs-keyword">async</span> _emitInitialSession(e){<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r,s;<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:{<span class="hljs-attr">session</span>:s},<span class="hljs-attr">error</span>:i}=t;<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">throw</span> i;<span class="hljs-keyword">await</span> (<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">r=<span class="hljs-keyword">this</span>.stateChangeEmitters.get(e</span>))?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">callback</span>(<span class="hljs-params"><span class="hljs-string">"INITIAL_SESSION"</span>,s</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"INITIAL_SESSION"</span>,<span class="hljs-string">"callback id"</span>,e,<span class="hljs-string">"session"</span>,s</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">t</span>){<span class="hljs-params">await</span> (<span class="hljs-params"><span class="hljs-literal">null</span>==(s=<span class="hljs-keyword">this</span>.stateChangeEmitters.get(e</span>))?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">callback</span>(<span class="hljs-params"><span class="hljs-string">"INITIAL_SESSION"</span>,<span class="hljs-literal">null</span></span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"INITIAL_SESSION"</span>,<span class="hljs-string">"callback id"</span>,e,<span class="hljs-string">"error"</span>,t</span>),<span class="hljs-params">console</span>.<span class="hljs-params">error</span>(<span class="hljs-params">t</span>)}})}<span class="hljs-params">async</span> <span class="hljs-params">resetPasswordForEmail</span>(<span class="hljs-params">e,t={}</span>){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">null</span>,<span class="hljs-params">s</span>=<span class="hljs-params">null</span>;"<span class="hljs-params">pkce</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">flowType</span>&amp;&amp;(<span class="hljs-params">[r,s]=<span class="hljs-keyword">await</span> tm(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey,!<span class="hljs-number">0</span></span>));<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/recover`</span>,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:<span class="hljs-keyword">this</span>.headers,redirectTo:t.redirectTo}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">getUserIdentities</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>;<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">getUser</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">r</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{identities:<span class="hljs-literal">null</span>!=(e=t.user.identities</span>)?<span class="hljs-params">e</span>:[]},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">linkIdentity</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span>"<span class="hljs-params">token</span>"<span class="hljs-params">in</span> <span class="hljs-params">e</span>?<span class="hljs-params">this</span>.<span class="hljs-params">linkIdentityIdToken</span>(<span class="hljs-params">e</span>):<span class="hljs-params">this</span>.<span class="hljs-params">linkIdentityOAuth</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">async</span> <span class="hljs-params">linkIdentityOAuth</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r,s,i,n,a;<span class="hljs-keyword">let</span>{data:o,error:l}=t;<span class="hljs-keyword">if</span>(l</span>)<span class="hljs-params">throw</span> <span class="hljs-params">l</span>;<span class="hljs-params">let</span> <span class="hljs-params">h</span>=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_getUrlForProvider</span>(<span class="hljs-params"><span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user/identities/authorize`</span>,e.provider,{redirectTo:<span class="hljs-literal">null</span>==(r=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">redirectTo</span>,<span class="hljs-params">scopes</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">s=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">scopes</span>,<span class="hljs-params">queryParams</span>:<span class="hljs-params">null</span>==(<span class="hljs-params">i=e.options</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">i</span>.<span class="hljs-params">queryParams</span>,<span class="hljs-params">skipBrowserRedirect</span>:!0});<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,h,{headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>!=(a=<span class="hljs-literal">null</span>==(n=o.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">n</span>.<span class="hljs-params">access_token</span>)?<span class="hljs-params">a</span>:<span class="hljs-params">void</span> 0})});<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">r</span>;<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{provider:e.provider,url:<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.url},error:<span class="hljs-literal">null</span>}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">t</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(t</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{provider:e.provider,url:<span class="hljs-literal">null</span>},error:t}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">t</span>}}<span class="hljs-params">async</span> <span class="hljs-params">linkIdentityIdToken</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span>{error:s,data:{session:i}}=t;<span class="hljs-keyword">if</span>(s</span>)<span class="hljs-params">throw</span> <span class="hljs-params">s</span>;<span class="hljs-params">let</span>{<span class="hljs-params">options</span>:<span class="hljs-params">n</span>,<span class="hljs-params">provider</span>:<span class="hljs-params">a</span>,<span class="hljs-params">token</span>:<span class="hljs-params">o</span>,<span class="hljs-params">access_token</span>:<span class="hljs-params">l</span>,<span class="hljs-params">nonce</span>:<span class="hljs-params">h</span>}=<span class="hljs-params">e</span>,{<span class="hljs-params">data</span>:<span class="hljs-params">u</span>,<span class="hljs-params">error</span>:<span class="hljs-params">c</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=id_token`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>!=(r=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.access_token</span>)?<span class="hljs-params">r</span>:<span class="hljs-params">void</span> 0,<span class="hljs-params">body</span>:{<span class="hljs-params">provider</span>:<span class="hljs-params">a</span>,<span class="hljs-params">id_token</span>:<span class="hljs-params">o</span>,<span class="hljs-params">access_token</span>:<span class="hljs-params">l</span>,<span class="hljs-params">nonce</span>:<span class="hljs-params">h</span>,<span class="hljs-params">link_identity</span>:!0,<span class="hljs-params">gotrue_meta_security</span>:{<span class="hljs-params">captcha_token</span>:<span class="hljs-params">null</span>==<span class="hljs-params">n</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">n</span>.<span class="hljs-params">captchaToken</span>}},<span class="hljs-params">xform</span>:<span class="hljs-params">tP</span>});<span class="hljs-params">if</span>(<span class="hljs-params">c</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:c}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!u||!u.session||!u.user</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:<span class="hljs-keyword">new</span> e3}</span>);<span class="hljs-params">return</span> <span class="hljs-params">u</span>.<span class="hljs-params">session</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(u.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"USER_UPDATED"</span>,u.session</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:u,error:c}</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:{user:<span class="hljs-literal">null</span>,session:<span class="hljs-literal">null</span>},error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">async</span> <span class="hljs-params">unlinkIdentity</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r,s;<span class="hljs-keyword">let</span>{data:i,error:n}=t;<span class="hljs-keyword">if</span>(n</span>)<span class="hljs-params">throw</span> <span class="hljs-params">n</span>;<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"DELETE"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user/identities/<span class="hljs-subst">${e.identity_id}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>!=(s=<span class="hljs-literal">null</span>==(r=i.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>)?<span class="hljs-params">s</span>:<span class="hljs-params">void</span> 0})})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_refreshAccessToken</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=`#<span class="hljs-params">_refreshAccessToken</span>(<span class="hljs-params">${e.substring(<span class="hljs-number">0</span>,<span class="hljs-number">5</span></span>)}...)`;<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">t,<span class="hljs-string">"begin"</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>;<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">Date</span>.<span class="hljs-params">now</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span> <span class="hljs-params">await</span> (<span class="hljs-params">r=<span class="hljs-keyword">async</span> r=&gt;(r&gt;<span class="hljs-number">0</span>&amp;&amp;<span class="hljs-keyword">await</span> tg(<span class="hljs-number">200</span>*<span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>,r<span class="hljs-number">-1</span></span>)),<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">t,<span class="hljs-string">"refreshing attempt"</span>,r</span>),<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/token?grant_type=refresh_token`</span>,{body:{refresh_token:e},headers:<span class="hljs-keyword">this</span>.headers,xform:tP}</span>)),<span class="hljs-params">s</span>=(<span class="hljs-params">e,t</span>)=&gt;</span>{<span class="hljs-keyword">let</span> r=<span class="hljs-number">200</span>*<span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>,e);<span class="hljs-keyword">return</span> t&amp;&amp;e9(t)&amp;&amp;<span class="hljs-built_in">Date</span>.now()+r-i&lt;<span class="hljs-number">3e4</span>},<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">e,t</span>)=&gt;</span>{(<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1</span>/<span class="hljs-number">0</span>;i++)<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> t=<span class="hljs-keyword">await</span> r(i);<span class="hljs-keyword">if</span>(!s(i,<span class="hljs-literal">null</span>,t))<span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> e(t)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">if</span>(!s(i,e))<span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> t(e)}})()}))}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._debug(t,<span class="hljs-string">"error"</span>,e),eZ(e))<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:{<span class="hljs-attr">session</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">user</span>:<span class="hljs-literal">null</span>},<span class="hljs-attr">error</span>:e});<span class="hljs-keyword">throw</span> e}<span class="hljs-keyword">finally</span>{<span class="hljs-keyword">this</span>._debug(t,<span class="hljs-string">"end"</span>)}}_isValidSession(e){<span class="hljs-keyword">return</span><span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> e&amp;&amp;<span class="hljs-literal">null</span>!==e&amp;&amp;<span class="hljs-string">"access_token"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"refresh_token"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"expires_at"</span><span class="hljs-keyword">in</span> e}<span class="hljs-keyword">async</span> _handleProviderSignIn(e,t){<span class="hljs-keyword">let</span> r=<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._getUrlForProvider(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/authorize`</span>,e,{<span class="hljs-attr">redirectTo</span>:t.redirectTo,<span class="hljs-attr">scopes</span>:t.scopes,<span class="hljs-attr">queryParams</span>:t.queryParams});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_handleProviderSignIn()"</span>,<span class="hljs-string">"provider"</span>,e,<span class="hljs-string">"options"</span>,t,<span class="hljs-string">"url"</span>,r),{<span class="hljs-attr">data</span>:{<span class="hljs-attr">provider</span>:e,<span class="hljs-attr">url</span>:r},<span class="hljs-attr">error</span>:<span class="hljs-literal">null</span>}}<span class="hljs-keyword">async</span> _recoverAndRefresh(){<span class="hljs-keyword">var</span> e,t;<span class="hljs-keyword">let</span> r=<span class="hljs-string">"#_recoverAndRefresh()"</span>;<span class="hljs-keyword">this</span>._debug(r,<span class="hljs-string">"begin"</span>);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> s=<span class="hljs-keyword">await</span> tc(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey);<span class="hljs-keyword">if</span>(s&amp;&amp;<span class="hljs-keyword">this</span>.userStorage){<span class="hljs-keyword">let</span> t=<span class="hljs-keyword">await</span> tc(<span class="hljs-keyword">this</span>.userStorage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span>);!<span class="hljs-keyword">this</span>.storage.isServer&amp;&amp;<span class="hljs-built_in">Object</span>.is(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.userStorage)&amp;&amp;!t&amp;&amp;<span class="hljs-function">(<span class="hljs-params">t={user:s.user},<span class="hljs-keyword">await</span> tu(<span class="hljs-keyword">this</span>.userStorage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span>,t</span>)),<span class="hljs-params">s</span>.<span class="hljs-params">user</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">e=<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.user</span>)?<span class="hljs-params">e</span>:<span class="hljs-params">tk</span><span class="hljs-params">()</span>}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params">s&amp;&amp;!s.user&amp;&amp;!s.user</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">await</span> <span class="hljs-params">tc</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span></span>);<span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.user</span>)?(<span class="hljs-params">s.user=e.user,<span class="hljs-keyword">await</span> td(<span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span></span>),<span class="hljs-params">await</span> <span class="hljs-params">tu</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey,s</span>)):<span class="hljs-params">s</span>.<span class="hljs-params">user</span>=<span class="hljs-params">tk</span><span class="hljs-params">()</span>}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._debug(r,<span class="hljs-string">"session from storage"</span>,s</span>),!<span class="hljs-params">this</span>.<span class="hljs-params">_isValidSession</span>(<span class="hljs-params">s</span>)){<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">r,<span class="hljs-string">"session is not valid"</span></span>),<span class="hljs-params">null</span>!==<span class="hljs-params">s</span>&amp;&amp;<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_removeSession</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span>}<span class="hljs-params">let</span> <span class="hljs-params">i</span>=(<span class="hljs-params"><span class="hljs-literal">null</span>!=(t=s.expires_at</span>)?<span class="hljs-params">t</span>:1/0)*1<span class="hljs-params">e3</span>-<span class="hljs-params">Date</span>.<span class="hljs-params">now</span><span class="hljs-params">()</span>&lt;9<span class="hljs-params">e4</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._debug(r,<span class="hljs-string">`session has<span class="hljs-subst">${i?<span class="hljs-string">""</span>:<span class="hljs-string">" not"</span>}</span> expired with margin of 90000s`</span></span>),<span class="hljs-params">i</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.autoRefreshToken&amp;&amp;s.refresh_token</span>){<span class="hljs-params">let</span>{<span class="hljs-params">error</span>:<span class="hljs-params">e</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">s.refresh_token</span>);<span class="hljs-params">e</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-built_in">console</span>.error(e</span>),<span class="hljs-params">e9</span>(<span class="hljs-params">e</span>)||(<span class="hljs-params"><span class="hljs-keyword">this</span>._debug(r,<span class="hljs-string">"refresh failed with a non-retryable error, removing the session"</span>,e</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_removeSession</span><span class="hljs-params">()</span>))}}<span class="hljs-params">else</span> <span class="hljs-params">if</span>(<span class="hljs-params">s.user&amp;&amp;!<span class="hljs-number">0</span>===s.user.__isUserNotAvailableProxy</span>)<span class="hljs-params">try</span>{<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">e</span>,<span class="hljs-params">error</span>:<span class="hljs-params">t</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_getUser</span>(<span class="hljs-params">s.access_token</span>);!<span class="hljs-params">t</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.user</span>)?(<span class="hljs-params">s.user=e.user,<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(s</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,s</span>)):<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">r,<span class="hljs-string">"could not get user data, skipping SIGNED_IN notification"</span></span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">console</span>.<span class="hljs-params">error</span>(<span class="hljs-params"><span class="hljs-string">"Error getting user data:"</span>,e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">r,<span class="hljs-string">"error getting user data, skipping SIGNED_IN notification"</span>,e</span>)}<span class="hljs-params">else</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_IN"</span>,s</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">r,<span class="hljs-string">"error"</span>,e</span>),<span class="hljs-params">console</span>.<span class="hljs-params">error</span>(<span class="hljs-params">e</span>);<span class="hljs-params">return</span>}<span class="hljs-params">finally</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">r,<span class="hljs-string">"end"</span></span>)}}<span class="hljs-params">async</span> <span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>,<span class="hljs-params">r</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!e</span>)<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e2</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.refreshingDeferred</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">refreshingDeferred</span>.<span class="hljs-params">promise</span>;<span class="hljs-params">let</span> <span class="hljs-params">s</span>=`#<span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">${e.substring(<span class="hljs-number">0</span>,<span class="hljs-number">5</span></span>)}...)`;<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">s,<span class="hljs-string">"begin"</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">refreshingDeferred</span>=<span class="hljs-params">new</span> <span class="hljs-params">tf</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_refreshAccessToken</span>(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">throw</span> <span class="hljs-params">r</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!t.session</span>)<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">e2</span>;<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_saveSession</span>(<span class="hljs-params">t.session</span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"TOKEN_REFRESHED"</span>,t.session</span>);<span class="hljs-params">let</span> <span class="hljs-params">s</span>={<span class="hljs-params">data</span>:<span class="hljs-params">t</span>.<span class="hljs-params">session</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">refreshingDeferred</span>.<span class="hljs-params">resolve</span>(<span class="hljs-params">s</span>),<span class="hljs-params">s</span>}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>._debug(s,<span class="hljs-string">"error"</span>,e</span>),<span class="hljs-params">eZ</span>(<span class="hljs-params">e</span>)){<span class="hljs-params">let</span> <span class="hljs-params">r</span>={<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">e</span>};<span class="hljs-params">return</span> <span class="hljs-params">e9</span>(<span class="hljs-params">e</span>)||<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_removeSession</span><span class="hljs-params">()</span>,<span class="hljs-params">null</span>==(<span class="hljs-params">t=<span class="hljs-keyword">this</span>.refreshingDeferred</span>)||<span class="hljs-params">t</span>.<span class="hljs-params">resolve</span>(<span class="hljs-params">r</span>),<span class="hljs-params">r</span>}<span class="hljs-params">throw</span> <span class="hljs-params">null</span>==(<span class="hljs-params">r=<span class="hljs-keyword">this</span>.refreshingDeferred</span>)||<span class="hljs-params">r</span>.<span class="hljs-params">reject</span>(<span class="hljs-params">e</span>),<span class="hljs-params">e</span>}<span class="hljs-params">finally</span>{<span class="hljs-params">this</span>.<span class="hljs-params">refreshingDeferred</span>=<span class="hljs-params">null</span>,<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">s,<span class="hljs-string">"end"</span></span>)}}<span class="hljs-params">async</span> <span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params">e,t,r=!<span class="hljs-number">0</span></span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=`#<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params">${e}</span>)`;<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">s,<span class="hljs-string">"begin"</span>,t,<span class="hljs-string">`broadcast = <span class="hljs-subst">${r}</span>`</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">this</span>.<span class="hljs-params">broadcastChannel</span>&amp;&amp;<span class="hljs-params">r</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">broadcastChannel</span>.<span class="hljs-params">postMessage</span>(<span class="hljs-params">{event:e,session:t}</span>);<span class="hljs-params">let</span> <span class="hljs-params">s</span>=[],<span class="hljs-params">i</span>=<span class="hljs-params">Array</span>.<span class="hljs-params">from</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.stateChangeEmitters.values(</span>)).<span class="hljs-params">map</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> r=&gt;{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">await</span> r.callback(e,t</span>)}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params">e</span>)}});<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(i</span>),<span class="hljs-params">s</span>.<span class="hljs-params">length</span>&gt;0){<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> e=<span class="hljs-number">0</span>;e&lt;s.length;e+=<span class="hljs-number">1</span></span>)<span class="hljs-params">console</span>.<span class="hljs-params">error</span>(<span class="hljs-params">s[e]</span>);<span class="hljs-params">throw</span> <span class="hljs-params">s</span>[0]}}<span class="hljs-params">finally</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">s,<span class="hljs-string">"end"</span></span>)}}<span class="hljs-params">async</span> <span class="hljs-params">_saveSession</span>(<span class="hljs-params">e</span>){<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_saveSession()"</span>,e</span>),<span class="hljs-params">this</span>.<span class="hljs-params">suppressGetSessionWarning</span>=!0;<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{},e</span>),<span class="hljs-params">r</span>=<span class="hljs-params">t</span>.<span class="hljs-params">user</span>&amp;&amp;!0===<span class="hljs-params">t</span>.<span class="hljs-params">user</span>.<span class="hljs-params">__isUserNotAvailableProxy</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.userStorage</span>){!<span class="hljs-params">r</span>&amp;&amp;<span class="hljs-params">t</span>.<span class="hljs-params">user</span>&amp;&amp;<span class="hljs-params">await</span> <span class="hljs-params">tu</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.userStorage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span>,{user:t.user}</span>);<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{},t</span>);<span class="hljs-params">delete</span> <span class="hljs-params">e</span>.<span class="hljs-params">user</span>;<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">tE</span>(<span class="hljs-params">e</span>);<span class="hljs-params">await</span> <span class="hljs-params">tu</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey,s</span>)}<span class="hljs-params">else</span>{<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">tE</span>(<span class="hljs-params">t</span>);<span class="hljs-params">await</span> <span class="hljs-params">tu</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey,e</span>)}}<span class="hljs-params">async</span> <span class="hljs-params">_removeSession</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_removeSession()"</span></span>),<span class="hljs-params">await</span> <span class="hljs-params">td</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey</span>),<span class="hljs-params">await</span> <span class="hljs-params">td</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-code-verifier"</span></span>),<span class="hljs-params">await</span> <span class="hljs-params">td</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">userStorage</span>&amp;&amp;<span class="hljs-params">await</span> <span class="hljs-params">td</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.userStorage,<span class="hljs-keyword">this</span>.storageKey+<span class="hljs-string">"-user"</span></span>),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"SIGNED_OUT"</span>,<span class="hljs-literal">null</span></span>)}<span class="hljs-params">_removeVisibilityChangedCallback</span><span class="hljs-params">()</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_removeVisibilityChangedCallback()"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">visibilityChangedCallback</span>,<span class="hljs-params">this</span>.<span class="hljs-params">visibilityChangedCallback</span>=<span class="hljs-params">null</span>}<span class="hljs-params">async</span> <span class="hljs-params">_startAutoRefresh</span><span class="hljs-params">()</span>{<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_stopAutoRefresh</span><span class="hljs-params">()</span>,<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_startAutoRefresh()"</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">setInterval</span>(<span class="hljs-params">(</span>)=&gt;</span><span class="hljs-keyword">this</span>._autoRefreshTokenTick(),<span class="hljs-number">3e4</span>);<span class="hljs-keyword">this</span>.autoRefreshTicker=e,e&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> e&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> e.unref?e.unref():<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> Deno&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> Deno.unrefTimer&amp;&amp;Deno.unrefTimer(e),setTimeout(<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializePromise,<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._autoRefreshTokenTick()},<span class="hljs-number">0</span>)}<span class="hljs-keyword">async</span> _stopAutoRefresh(){<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_stopAutoRefresh()"</span>);<span class="hljs-keyword">let</span> e=<span class="hljs-keyword">this</span>.autoRefreshTicker;<span class="hljs-keyword">this</span>.autoRefreshTicker=<span class="hljs-literal">null</span>,e&amp;&amp;clearInterval(e)}<span class="hljs-keyword">async</span> startAutoRefresh(){<span class="hljs-keyword">this</span>._removeVisibilityChangedCallback(),<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._startAutoRefresh()}<span class="hljs-keyword">async</span> stopAutoRefresh(){<span class="hljs-keyword">this</span>._removeVisibilityChangedCallback(),<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._stopAutoRefresh()}<span class="hljs-keyword">async</span> _autoRefreshTokenTick(){<span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_autoRefreshTokenTick()"</span>,<span class="hljs-string">"begin"</span>);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._acquireLock(<span class="hljs-number">0</span>,<span class="hljs-keyword">async</span>()=&gt;{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">let</span> e=<span class="hljs-built_in">Date</span>.now();<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:{<span class="hljs-attr">session</span>:r}}=t;<span class="hljs-keyword">if</span>(!r||!r.refresh_token||!r.expires_at)<span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> <span class="hljs-keyword">this</span>._debug(<span class="hljs-string">"#_autoRefreshTokenTick()"</span>,<span class="hljs-string">"no session"</span>);<span class="hljs-keyword">let</span> s=<span class="hljs-built_in">Math</span>.floor(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">1e3</span>*r.expires_at-e</span>)/3<span class="hljs-params">e4</span>);<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_autoRefreshTokenTick()"</span>,<span class="hljs-string">`access token expires in <span class="hljs-subst">${s}</span> ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`</span></span>),<span class="hljs-params">s</span>&lt;=3&amp;&amp;<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_callRefreshToken</span>(<span class="hljs-params">r.refresh_token</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">console</span>.<span class="hljs-params">error</span>(<span class="hljs-params"><span class="hljs-string">"Auto refresh tick failed with error. This is likely a transient error."</span>,e</span>)}}<span class="hljs-params">finally</span>{<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_autoRefreshTokenTick()"</span>,<span class="hljs-string">"end"</span></span>)}})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">e.isAcquireTimeout||e <span class="hljs-keyword">instanceof</span> tL</span>)<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"auto refresh token tick lock not available"</span></span>);<span class="hljs-params">else</span> <span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_handleVisibilityChange</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params"><span class="hljs-string">"#_handleVisibilityChange()"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">autoRefreshToken</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">startAutoRefresh</span><span class="hljs-params">()</span>,!1}<span class="hljs-params">async</span> <span class="hljs-params">_onVisibilityChanged</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=`#<span class="hljs-params">_onVisibilityChanged</span>(<span class="hljs-params">${e}</span>)`;<span class="hljs-params">this</span>.<span class="hljs-params">_debug</span>(<span class="hljs-params">t,<span class="hljs-string">"visibilityState"</span>,<span class="hljs-built_in">document</span>.visibilityState</span>),"<span class="hljs-params">visible</span>"===<span class="hljs-params">document</span>.<span class="hljs-params">visibilityState</span>?(<span class="hljs-params"><span class="hljs-keyword">this</span>.autoRefreshToken&amp;&amp;<span class="hljs-keyword">this</span>._startAutoRefresh(</span>),<span class="hljs-params">e</span>||(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializePromise,<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._acquireLock(<span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span>{<span class="hljs-string">"visible"</span>!==<span class="hljs-built_in">document</span>.visibilityState?<span class="hljs-keyword">this</span>._debug(t,<span class="hljs-string">"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"</span>):<span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._recoverAndRefresh()}))):<span class="hljs-string">"hidden"</span>===<span class="hljs-built_in">document</span>.visibilityState&amp;&amp;<span class="hljs-keyword">this</span>.autoRefreshToken&amp;&amp;<span class="hljs-keyword">this</span>._stopAutoRefresh()}<span class="hljs-keyword">async</span> _getUrlForProvider(e,t,r){<span class="hljs-keyword">let</span> s=[<span class="hljs-string">`provider=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(t)}</span>`</span>];<span class="hljs-keyword">if</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.redirectTo</span>)&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`redirect_to=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(r.redirectTo)}</span>`</span></span>),(<span class="hljs-params"><span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.scopes</span>)&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`scopes=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(r.scopes)}</span>`</span></span>),"<span class="hljs-params">pkce</span>"===<span class="hljs-params">this</span>.<span class="hljs-params">flowType</span>){<span class="hljs-params">let</span>[<span class="hljs-params">e</span>,<span class="hljs-params">t</span>]=<span class="hljs-params">await</span> <span class="hljs-params">tm</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storage,<span class="hljs-keyword">this</span>.storageKey</span>),<span class="hljs-params">r</span>=<span class="hljs-params">new</span> <span class="hljs-params">URLSearchParams</span>(<span class="hljs-params">{code_challenge:<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(e)}</span>`</span>,code_challenge_method:<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(t)}</span>`</span>}</span>);<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params">r.toString(</span>))}<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.queryParams</span>){<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">new</span> <span class="hljs-params">URLSearchParams</span>(<span class="hljs-params">r.queryParams</span>);<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params">e.toString(</span>))}<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.skipBrowserRedirect</span>)&amp;&amp;<span class="hljs-params">s</span>.<span class="hljs-params">push</span>(<span class="hljs-params"><span class="hljs-string">`skip_http_redirect=<span class="hljs-subst">${r.skipBrowserRedirect}</span>`</span></span>),`<span class="hljs-params">$</span>{<span class="hljs-params">e</span>}?<span class="hljs-params">$</span>{<span class="hljs-params">s</span>.<span class="hljs-params">join</span>(<span class="hljs-params"><span class="hljs-string">"&amp;"</span></span>)}`}<span class="hljs-params">async</span> <span class="hljs-params">_unenroll</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">let</span>{data:s,error:i}=t;<span class="hljs-keyword">return</span> i?<span class="hljs-keyword">this</span>._returnResult({data:<span class="hljs-literal">null</span>,error:i}</span>):<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"DELETE"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/factors/<span class="hljs-subst">${e.factorId}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>==(r=<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>})})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_enroll</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r,s;<span class="hljs-keyword">let</span>{data:i,error:n}=t;<span class="hljs-keyword">if</span>(n</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:n}</span>);<span class="hljs-params">let</span> <span class="hljs-params">a</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{friendly_name:e.friendlyName,factor_type:e.factorType},<span class="hljs-string">"phone"</span>===e.factorType?{phone:e.phone}:<span class="hljs-string">"totp"</span>===e.factorType?{issuer:e.issuer}:{}</span>),{<span class="hljs-params">data</span>:<span class="hljs-params">o</span>,<span class="hljs-params">error</span>:<span class="hljs-params">l</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/factors`</span>,{body:a,headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>==(r=<span class="hljs-literal">null</span>==i?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:i.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>});<span class="hljs-params">return</span> <span class="hljs-params">l</span>?<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:l}</span>):(<span class="hljs-params"><span class="hljs-string">"totp"</span>===e.factorType&amp;&amp;<span class="hljs-string">"totp"</span>===o.type&amp;&amp;(<span class="hljs-literal">null</span>==(s=<span class="hljs-literal">null</span>==o?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:o.totp</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">s</span>.<span class="hljs-params">qr_code</span>)&amp;&amp;(<span class="hljs-params">o.totp.qr_code=<span class="hljs-string">`data:image/svg+xml;utf-8,<span class="hljs-subst">${o.totp.qr_code}</span>`</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:o,error:<span class="hljs-literal">null</span>}</span>))})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_verify</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r,s,i;<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:n,<span class="hljs-attr">error</span>:a}=t;<span class="hljs-keyword">if</span>(a)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">error</span>:a});<span class="hljs-keyword">let</span> o=<span class="hljs-built_in">Object</span>.assign({<span class="hljs-attr">challenge_id</span>:e.challengeId},<span class="hljs-string">"webauthn"</span><span class="hljs-keyword">in</span> e?{<span class="hljs-attr">webauthn</span>:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e.webauthn),{<span class="hljs-attr">credential_response</span>:<span class="hljs-string">"create"</span>===e.webauthn.type?<span class="hljs-function">(<span class="hljs-params">s=e.webauthn.credential_response,<span class="hljs-string">"toJSON"</span><span class="hljs-keyword">in</span> s&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> s.toJSON?s.toJSON(</span>):{<span class="hljs-params">id</span>:<span class="hljs-params">s</span>.<span class="hljs-params">id</span>,<span class="hljs-params">rawId</span>:<span class="hljs-params">s</span>.<span class="hljs-params">id</span>,<span class="hljs-params">response</span>:{<span class="hljs-params">attestationObject</span>:<span class="hljs-params">tl</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s.response.attestationObject</span>)),<span class="hljs-params">clientDataJSON</span>:<span class="hljs-params">tl</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s.response.clientDataJSON</span>))},<span class="hljs-params">type</span>:"<span class="hljs-params">public</span>-<span class="hljs-params">key</span>",<span class="hljs-params">clientExtensionResults</span>:<span class="hljs-params">s</span>.<span class="hljs-params">getClientExtensionResults</span><span class="hljs-params">()</span>,<span class="hljs-params">authenticatorAttachment</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">i=s.authenticatorAttachment</span>)?<span class="hljs-params">i</span>:<span class="hljs-params">void</span> 0}):<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">var</span> <span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"toJSON"</span><span class="hljs-keyword">in</span> e&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> e.toJSON</span>)<span class="hljs-params">return</span> <span class="hljs-params">e</span>.<span class="hljs-params">toJSON</span><span class="hljs-params">()</span>;<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">e</span>.<span class="hljs-params">getClientExtensionResults</span><span class="hljs-params">()</span>,<span class="hljs-params">s</span>=<span class="hljs-params">e</span>.<span class="hljs-params">response</span>;<span class="hljs-params">return</span>{<span class="hljs-params">id</span>:<span class="hljs-params">e</span>.<span class="hljs-params">id</span>,<span class="hljs-params">rawId</span>:<span class="hljs-params">e</span>.<span class="hljs-params">id</span>,<span class="hljs-params">response</span>:{<span class="hljs-params">authenticatorData</span>:<span class="hljs-params">tl</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s.authenticatorData</span>)),<span class="hljs-params">clientDataJSON</span>:<span class="hljs-params">tl</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s.clientDataJSON</span>)),<span class="hljs-params">signature</span>:<span class="hljs-params">tl</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s.signature</span>)),<span class="hljs-params">userHandle</span>:<span class="hljs-params">s</span>.<span class="hljs-params">userHandle</span>?<span class="hljs-params">tl</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(s.userHandle</span>)):<span class="hljs-params">void</span> 0},<span class="hljs-params">type</span>:"<span class="hljs-params">public</span>-<span class="hljs-params">key</span>",<span class="hljs-params">clientExtensionResults</span>:<span class="hljs-params">r</span>,<span class="hljs-params">authenticatorAttachment</span>:<span class="hljs-params">null</span>!=(<span class="hljs-params">t=e.authenticatorAttachment</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">void</span> 0}}(<span class="hljs-params">e.webauthn.credential_response</span>)})}:{<span class="hljs-params">code</span>:<span class="hljs-params">e</span>.<span class="hljs-params">code</span>}),{<span class="hljs-params">data</span>:<span class="hljs-params">l</span>,<span class="hljs-params">error</span>:<span class="hljs-params">h</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/factors/<span class="hljs-subst">${e.factorId}</span>/verify`</span>,{body:o,headers:<span class="hljs-keyword">this</span>.headers,jwt:<span class="hljs-literal">null</span>==(r=<span class="hljs-literal">null</span>==n?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>});<span class="hljs-params">return</span> <span class="hljs-params">h</span>?<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:h}</span>):(<span class="hljs-params"><span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._saveSession(<span class="hljs-built_in">Object</span>.assign({expires_at:<span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">Date</span>.now(</span>)/1<span class="hljs-params">e3</span>)+<span class="hljs-params">l</span>.<span class="hljs-params">expires_in</span>},<span class="hljs-params">l</span>)),<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_notifyAllSubscribers</span>(<span class="hljs-params"><span class="hljs-string">"MFA_CHALLENGE_VERIFIED"</span>,l</span>),<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:l,error:h}</span>))})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">async</span> <span class="hljs-params">_challenge</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_acquireLock</span>(<span class="hljs-params"><span class="hljs-number">-1</span>,<span class="hljs-keyword">async</span>(</span>)=&gt;</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>._useSession(<span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">let</span>{<span class="hljs-attr">data</span>:s,<span class="hljs-attr">error</span>:i}=t;<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._returnResult({<span class="hljs-attr">data</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">error</span>:i});<span class="hljs-keyword">let</span> n=<span class="hljs-keyword">await</span> tR(<span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/factors/<span class="hljs-subst">${e.factorId}</span>/challenge`</span>,{<span class="hljs-attr">body</span>:e,<span class="hljs-attr">headers</span>:<span class="hljs-keyword">this</span>.headers,<span class="hljs-attr">jwt</span>:<span class="hljs-literal">null</span>==<span class="hljs-function">(<span class="hljs-params">r=<span class="hljs-literal">null</span>==s?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:s.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">r</span>.<span class="hljs-params">access_token</span>});<span class="hljs-params">if</span>(<span class="hljs-params">n.error</span>)<span class="hljs-params">return</span> <span class="hljs-params">n</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">a</span>}=<span class="hljs-params">n</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"webauthn"</span>!==a.type</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">a</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">switch</span>(<span class="hljs-params">a.webauthn.type</span>){<span class="hljs-params">case</span>"<span class="hljs-params">create</span>":<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a</span>),{<span class="hljs-params">webauthn</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a.webauthn</span>),{<span class="hljs-params">credential_options</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a.webauthn.credential_options</span>),{<span class="hljs-params">publicKey</span>:<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!e</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Credential creation options are required"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> PublicKeyCredential&amp;&amp;<span class="hljs-string">"parseCreationOptionsFromJSON"</span><span class="hljs-keyword">in</span> PublicKeyCredential&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> PublicKeyCredential.parseCreationOptionsFromJSON</span>)<span class="hljs-params">return</span> <span class="hljs-params">PublicKeyCredential</span>.<span class="hljs-params">parseCreationOptionsFromJSON</span>(<span class="hljs-params">e</span>);<span class="hljs-params">let</span>{<span class="hljs-params">challenge</span>:<span class="hljs-params">t</span>,<span class="hljs-params">user</span>:<span class="hljs-params">r</span>,<span class="hljs-params">excludeCredentials</span>:<span class="hljs-params">s</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">i</span>=(<span class="hljs-params"><span class="hljs-number">0</span>,T.__rest</span>)(<span class="hljs-params">e,[<span class="hljs-string">"challenge"</span>,<span class="hljs-string">"user"</span>,<span class="hljs-string">"excludeCredentials"</span>]</span>),<span class="hljs-params">n</span>=<span class="hljs-params">to</span>(<span class="hljs-params">t</span>).<span class="hljs-params">buffer</span>,<span class="hljs-params">a</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},r</span>),{<span class="hljs-params">id</span>:<span class="hljs-params">to</span>(<span class="hljs-params">r.id</span>).<span class="hljs-params">buffer</span>}),<span class="hljs-params">o</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},i</span>),{<span class="hljs-params">challenge</span>:<span class="hljs-params">n</span>,<span class="hljs-params">user</span>:<span class="hljs-params">a</span>});<span class="hljs-params">if</span>(<span class="hljs-params">s&amp;&amp;s.length&gt;<span class="hljs-number">0</span></span>){<span class="hljs-params">o</span>.<span class="hljs-params">excludeCredentials</span>=<span class="hljs-params">Array</span>(<span class="hljs-params">s.length</span>);<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> e=<span class="hljs-number">0</span>;e&lt;s.length;e++</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">s</span>[<span class="hljs-params">e</span>];<span class="hljs-params">o</span>.<span class="hljs-params">excludeCredentials</span>[<span class="hljs-params">e</span>]=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},t</span>),{<span class="hljs-params">id</span>:<span class="hljs-params">to</span>(<span class="hljs-params">t.id</span>).<span class="hljs-params">buffer</span>,<span class="hljs-params">type</span>:<span class="hljs-params">t</span>.<span class="hljs-params">type</span>||"<span class="hljs-params">public</span>-<span class="hljs-params">key</span>",<span class="hljs-params">transports</span>:<span class="hljs-params">t</span>.<span class="hljs-params">transports</span>})}}<span class="hljs-params">return</span> <span class="hljs-params">o</span>}(<span class="hljs-params">a.webauthn.credential_options.publicKey</span>)})})}),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">case</span>"<span class="hljs-params">request</span>":<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a</span>),{<span class="hljs-params">webauthn</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a.webauthn</span>),{<span class="hljs-params">credential_options</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},a.webauthn.credential_options</span>),{<span class="hljs-params">publicKey</span>:<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!e</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Credential request options are required"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> PublicKeyCredential&amp;&amp;<span class="hljs-string">"parseRequestOptionsFromJSON"</span><span class="hljs-keyword">in</span> PublicKeyCredential&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> PublicKeyCredential.parseRequestOptionsFromJSON</span>)<span class="hljs-params">return</span> <span class="hljs-params">PublicKeyCredential</span>.<span class="hljs-params">parseRequestOptionsFromJSON</span>(<span class="hljs-params">e</span>);<span class="hljs-params">let</span>{<span class="hljs-params">challenge</span>:<span class="hljs-params">t</span>,<span class="hljs-params">allowCredentials</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">e</span>,<span class="hljs-params">s</span>=(<span class="hljs-params"><span class="hljs-number">0</span>,T.__rest</span>)(<span class="hljs-params">e,[<span class="hljs-string">"challenge"</span>,<span class="hljs-string">"allowCredentials"</span>]</span>),<span class="hljs-params">i</span>=<span class="hljs-params">to</span>(<span class="hljs-params">t</span>).<span class="hljs-params">buffer</span>,<span class="hljs-params">n</span>=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},s</span>),{<span class="hljs-params">challenge</span>:<span class="hljs-params">i</span>});<span class="hljs-params">if</span>(<span class="hljs-params">r&amp;&amp;r.length&gt;<span class="hljs-number">0</span></span>){<span class="hljs-params">n</span>.<span class="hljs-params">allowCredentials</span>=<span class="hljs-params">Array</span>(<span class="hljs-params">r.length</span>);<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> e=<span class="hljs-number">0</span>;e&lt;r.length;e++</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">r</span>[<span class="hljs-params">e</span>];<span class="hljs-params">n</span>.<span class="hljs-params">allowCredentials</span>[<span class="hljs-params">e</span>]=<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},t</span>),{<span class="hljs-params">id</span>:<span class="hljs-params">to</span>(<span class="hljs-params">t.id</span>).<span class="hljs-params">buffer</span>,<span class="hljs-params">type</span>:<span class="hljs-params">t</span>.<span class="hljs-params">type</span>||"<span class="hljs-params">public</span>-<span class="hljs-params">key</span>",<span class="hljs-params">transports</span>:<span class="hljs-params">t</span>.<span class="hljs-params">transports</span>})}}<span class="hljs-params">return</span> <span class="hljs-params">n</span>}(<span class="hljs-params">a.webauthn.credential_options.publicKey</span>)})})}),<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}})}<span class="hljs-params">async</span> <span class="hljs-params">_challengeAndVerify</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">t</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_challenge</span>(<span class="hljs-params">{factorId:e.factorId}</span>);<span class="hljs-params">return</span> <span class="hljs-params">r</span>?<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:r}</span>):<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_verify</span>(<span class="hljs-params">{factorId:e.factorId,challengeId:t.id,code:e.code}</span>)}<span class="hljs-params">async</span> <span class="hljs-params">_listFactors</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">user</span>:<span class="hljs-params">t</span>},<span class="hljs-params">error</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">getUser</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">null</span>,<span class="hljs-params">error</span>:<span class="hljs-params">r</span>};<span class="hljs-params">let</span> <span class="hljs-params">s</span>={<span class="hljs-params">all</span>:[],<span class="hljs-params">phone</span>:[],<span class="hljs-params">totp</span>:[],<span class="hljs-params">webauthn</span>:[]};<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> r <span class="hljs-keyword">of</span> <span class="hljs-literal">null</span>!=(e=<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.factors</span>)?<span class="hljs-params">e</span>:[])<span class="hljs-params">s</span>.<span class="hljs-params">all</span>.<span class="hljs-params">push</span>(<span class="hljs-params">r</span>),"<span class="hljs-params">verified</span>"===<span class="hljs-params">r</span>.<span class="hljs-params">status</span>&amp;&amp;<span class="hljs-params">s</span>[<span class="hljs-params">r</span>.<span class="hljs-params">factor_type</span>].<span class="hljs-params">push</span>(<span class="hljs-params">r</span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:<span class="hljs-params">s</span>,<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_getAuthenticatorAssuranceLevel</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>,<span class="hljs-params">t</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">session</span>:<span class="hljs-params">r</span>},<span class="hljs-params">error</span>:<span class="hljs-params">s</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">getSession</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">s</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:s}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!r</span>)<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">currentLevel</span>:<span class="hljs-params">null</span>,<span class="hljs-params">nextLevel</span>:<span class="hljs-params">null</span>,<span class="hljs-params">currentAuthenticationMethods</span>:[]},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>};<span class="hljs-params">let</span>{<span class="hljs-params">payload</span>:<span class="hljs-params">i</span>}=<span class="hljs-params">tp</span>(<span class="hljs-params">r.access_token</span>),<span class="hljs-params">n</span>=<span class="hljs-params">null</span>;<span class="hljs-params">i</span>.<span class="hljs-params">aal</span>&amp;&amp;(<span class="hljs-params">n=i.aal</span>);<span class="hljs-params">let</span> <span class="hljs-params">a</span>=<span class="hljs-params">n</span>;<span class="hljs-params">return</span>(<span class="hljs-params"><span class="hljs-literal">null</span>!=(t=<span class="hljs-literal">null</span>==(e=r.user.factors</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">e</span>.<span class="hljs-params">filter</span>(<span class="hljs-params">e=&gt;<span class="hljs-string">"verified"</span>===e.status</span>))?<span class="hljs-params">t</span>:[]).<span class="hljs-params">length</span>&gt;0&amp;&amp;(<span class="hljs-params">a=<span class="hljs-string">"aal2"</span></span>),{<span class="hljs-params">data</span>:{<span class="hljs-params">currentLevel</span>:<span class="hljs-params">n</span>,<span class="hljs-params">nextLevel</span>:<span class="hljs-params">a</span>,<span class="hljs-params">currentAuthenticationMethods</span>:<span class="hljs-params">i</span>.<span class="hljs-params">amr</span>||[]},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_getAuthorizationDetails</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">let</span>{data:{session:r},error:s}=t;<span class="hljs-keyword">return</span> s?<span class="hljs-keyword">this</span>._returnResult({data:<span class="hljs-literal">null</span>,error:s}</span>):<span class="hljs-params">r</span>?<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/oauth/authorizations/<span class="hljs-subst">${e}</span>`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:r.access_token,xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)}):<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:<span class="hljs-keyword">new</span> e2}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_approveAuthorization</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">let</span>{data:{session:r},error:s}=t;<span class="hljs-keyword">if</span>(s</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:s}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!r</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:<span class="hljs-keyword">new</span> e2}</span>);<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/oauth/authorizations/<span class="hljs-subst">${e}</span>/consent`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:r.access_token,body:{action:<span class="hljs-string">"approve"</span>},xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)});<span class="hljs-params">return</span> <span class="hljs-params">i</span>.<span class="hljs-params">data</span>&amp;&amp;<span class="hljs-params">i</span>.<span class="hljs-params">data</span>.<span class="hljs-params">redirect_url</span>,<span class="hljs-params">i</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_denyAuthorization</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">let</span>{data:{session:r},error:s}=t;<span class="hljs-keyword">if</span>(s</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:s}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!r</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:<span class="hljs-keyword">new</span> e2}</span>);<span class="hljs-params">let</span> <span class="hljs-params">i</span>=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"POST"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/oauth/authorizations/<span class="hljs-subst">${e}</span>/consent`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:r.access_token,body:{action:<span class="hljs-string">"deny"</span>},xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)});<span class="hljs-params">return</span> <span class="hljs-params">i</span>.<span class="hljs-params">data</span>&amp;&amp;<span class="hljs-params">i</span>.<span class="hljs-params">data</span>.<span class="hljs-params">redirect_url</span>,<span class="hljs-params">i</span>})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_listOAuthGrants</span><span class="hljs-params">()</span>{<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> e=&gt;{<span class="hljs-keyword">let</span>{data:{session:t},error:r}=e;<span class="hljs-keyword">return</span> r?<span class="hljs-keyword">this</span>._returnResult({data:<span class="hljs-literal">null</span>,error:r}</span>):<span class="hljs-params">t</span>?<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user/oauth/grants`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:t.access_token,xform:e=&gt;({data:e,error:<span class="hljs-literal">null</span>}</span>)}):<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:<span class="hljs-keyword">new</span> e2}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">_revokeOAuthGrant</span>(<span class="hljs-params">e</span>){<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">_useSession</span>(<span class="hljs-params"><span class="hljs-keyword">async</span> t=&gt;{<span class="hljs-keyword">let</span>{data:{session:r},error:s}=t;<span class="hljs-keyword">return</span> s?<span class="hljs-keyword">this</span>._returnResult({data:<span class="hljs-literal">null</span>,error:s}</span>):<span class="hljs-params">r</span>?<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"DELETE"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/user/oauth/grants`</span>,{headers:<span class="hljs-keyword">this</span>.headers,jwt:r.access_token,query:{client_id:e.clientId},xform:(</span>)=&gt;</span><span class="hljs-function">(<span class="hljs-params">{data:{},error:<span class="hljs-literal">null</span>}</span>)}):<span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:<span class="hljs-keyword">new</span> e2}</span>)})}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}<span class="hljs-params">async</span> <span class="hljs-params">fetchJwk</span>(<span class="hljs-params">e,t={keys:[]}</span>){<span class="hljs-params">let</span> <span class="hljs-params">r</span>=<span class="hljs-params">t</span>.<span class="hljs-params">keys</span>.<span class="hljs-params">find</span>(<span class="hljs-params">t=&gt;t.kid===e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">r</span>)<span class="hljs-params">return</span> <span class="hljs-params">r</span>;<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">Date</span>.<span class="hljs-params">now</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">(r=<span class="hljs-keyword">this</span>.jwks.keys.find(t=&gt;t.kid===e</span>))&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">jwks_cached_at</span>+6<span class="hljs-params">e5</span>&gt;<span class="hljs-params">s</span>)<span class="hljs-params">return</span> <span class="hljs-params">r</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">i</span>,<span class="hljs-params">error</span>:<span class="hljs-params">n</span>}=<span class="hljs-params">await</span> <span class="hljs-params">tR</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.fetch,<span class="hljs-string">"GET"</span>,<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.url}</span>/.well-known/jwks.json`</span>,{headers:<span class="hljs-keyword">this</span>.headers}</span>);<span class="hljs-params">if</span>(<span class="hljs-params">n</span>)<span class="hljs-params">throw</span> <span class="hljs-params">n</span>;<span class="hljs-params">return</span> <span class="hljs-params">i</span>.<span class="hljs-params">keys</span>&amp;&amp;0!==<span class="hljs-params">i</span>.<span class="hljs-params">keys</span>.<span class="hljs-params">length</span>&amp;&amp;(<span class="hljs-params"><span class="hljs-keyword">this</span>.jwks=i,<span class="hljs-keyword">this</span>.jwks_cached_at=s,r=i.keys.find(t=&gt;t.kid===e</span>))?<span class="hljs-params">r</span>:<span class="hljs-params">null</span>}<span class="hljs-params">async</span> <span class="hljs-params">getClaims</span>(<span class="hljs-params">e,t={}</span>){<span class="hljs-params">try</span>{<span class="hljs-params">var</span> <span class="hljs-params">r</span>;<span class="hljs-params">let</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>=<span class="hljs-params">e</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!i</span>){<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">e</span>,<span class="hljs-params">error</span>:<span class="hljs-params">t</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">getSession</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">t||!e.session</span>)<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:t}</span>);<span class="hljs-params">i</span>=<span class="hljs-params">e</span>.<span class="hljs-params">session</span>.<span class="hljs-params">access_token</span>}<span class="hljs-params">let</span>{<span class="hljs-params">header</span>:<span class="hljs-params">n</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">a</span>,<span class="hljs-params">signature</span>:<span class="hljs-params">o</span>,<span class="hljs-params">raw</span>:{<span class="hljs-params">header</span>:<span class="hljs-params">l</span>,<span class="hljs-params">payload</span>:<span class="hljs-params">h</span>}}=<span class="hljs-params">tp</span>(<span class="hljs-params">i</span>);(<span class="hljs-params"><span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.allowExpired</span>)||<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">!e</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Missing exp claim"</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params">e&lt;=<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Date</span>.now(</span>)/1<span class="hljs-params">e3</span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"JWT has expired"</span></span>)}(<span class="hljs-params">a.exp</span>);<span class="hljs-params">let</span> <span class="hljs-params">u</span>=!<span class="hljs-params">n</span>.<span class="hljs-params">alg</span>||<span class="hljs-params">n</span>.<span class="hljs-params">alg</span>.<span class="hljs-params">startsWith</span>(<span class="hljs-params"><span class="hljs-string">"HS"</span></span>)||!<span class="hljs-params">n</span>.<span class="hljs-params">kid</span>||!(<span class="hljs-params"><span class="hljs-string">"crypto"</span><span class="hljs-keyword">in</span> globalThis&amp;&amp;<span class="hljs-string">"subtle"</span><span class="hljs-keyword">in</span> globalThis.crypto</span>)?<span class="hljs-params">null</span>:<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">fetchJwk</span>(<span class="hljs-params">n.kid,(<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.keys</span>)?{<span class="hljs-params">keys</span>:<span class="hljs-params">t</span>.<span class="hljs-params">keys</span>}:<span class="hljs-params">null</span>==<span class="hljs-params">t</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">t</span>.<span class="hljs-params">jwks</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!u</span>){<span class="hljs-params">let</span>{<span class="hljs-params">error</span>:<span class="hljs-params">e</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">getUser</span>(<span class="hljs-params">i</span>);<span class="hljs-params">if</span>(<span class="hljs-params">e</span>)<span class="hljs-params">throw</span> <span class="hljs-params">e</span>;<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">claims</span>:<span class="hljs-params">a</span>,<span class="hljs-params">header</span>:<span class="hljs-params">n</span>,<span class="hljs-params">signature</span>:<span class="hljs-params">o</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">let</span> <span class="hljs-params">c</span>=<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">switch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">case</span>"<span class="hljs-params">RS256</span>":<span class="hljs-params">return</span>{<span class="hljs-params">name</span>:"<span class="hljs-params">RSASSA</span>-<span class="hljs-params">PKCS1</span>-<span class="hljs-params">v1_5</span>",<span class="hljs-params">hash</span>:{<span class="hljs-params">name</span>:"<span class="hljs-params">SHA</span>-256"}};<span class="hljs-params">case</span>"<span class="hljs-params">ES256</span>":<span class="hljs-params">return</span>{<span class="hljs-params">name</span>:"<span class="hljs-params">ECDSA</span>",<span class="hljs-params">namedCurve</span>:"<span class="hljs-params">P</span>-256",<span class="hljs-params">hash</span>:{<span class="hljs-params">name</span>:"<span class="hljs-params">SHA</span>-256"}};<span class="hljs-params">default</span>:<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Invalid alg claim"</span></span>)}}(<span class="hljs-params">n.alg</span>),<span class="hljs-params">d</span>=<span class="hljs-params">await</span> <span class="hljs-params">crypto</span>.<span class="hljs-params">subtle</span>.<span class="hljs-params">importKey</span>(<span class="hljs-params"><span class="hljs-string">"jwk"</span>,u,c,!<span class="hljs-number">0</span>,[<span class="hljs-string">"verify"</span>]</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!<span class="hljs-keyword">await</span> crypto.subtle.verify(c,d,o,(r=<span class="hljs-string">`<span class="hljs-subst">${l}</span>.<span class="hljs-subst">${h}</span>`</span>,s=[],!<span class="hljs-keyword">function</span>(e,t</span>){<span class="hljs-params">for</span>(<span class="hljs-params"><span class="hljs-keyword">let</span> r=<span class="hljs-number">0</span>;r&lt;e.length;r+=<span class="hljs-number">1</span></span>){<span class="hljs-params">let</span> <span class="hljs-params">s</span>=<span class="hljs-params">e</span>.<span class="hljs-params">charCodeAt</span>(<span class="hljs-params">r</span>);<span class="hljs-params">if</span>(<span class="hljs-params">s&gt;<span class="hljs-number">55295</span>&amp;&amp;s&lt;=<span class="hljs-number">56319</span></span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=(<span class="hljs-params">s<span class="hljs-number">-55296</span></span>)*1024&amp;65535;<span class="hljs-params">s</span>=(<span class="hljs-params">e.charCodeAt(r+<span class="hljs-number">1</span></span>)-56320&amp;65535|<span class="hljs-params">t</span>)+65536,<span class="hljs-params">r</span>+=1}!<span class="hljs-params">function</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">if</span>(<span class="hljs-params">e&lt;=<span class="hljs-number">127</span></span>)<span class="hljs-params">return</span> <span class="hljs-params">t</span>(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">e&lt;=<span class="hljs-number">2047</span></span>){<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">192</span>|e&gt;&gt;<span class="hljs-number">6</span></span>),<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">128</span>|<span class="hljs-number">63</span>&amp;e</span>);<span class="hljs-params">return</span>}<span class="hljs-params">if</span>(<span class="hljs-params">e&lt;=<span class="hljs-number">65535</span></span>){<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">224</span>|e&gt;&gt;<span class="hljs-number">12</span></span>),<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">128</span>|e&gt;&gt;<span class="hljs-number">6</span>&amp;<span class="hljs-number">63</span></span>),<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">128</span>|<span class="hljs-number">63</span>&amp;e</span>);<span class="hljs-params">return</span>}<span class="hljs-params">if</span>(<span class="hljs-params">e&lt;=<span class="hljs-number">1114111</span></span>){<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">240</span>|e&gt;&gt;<span class="hljs-number">18</span></span>),<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">128</span>|e&gt;&gt;<span class="hljs-number">12</span>&amp;<span class="hljs-number">63</span></span>),<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">128</span>|e&gt;&gt;<span class="hljs-number">6</span>&amp;<span class="hljs-number">63</span></span>),<span class="hljs-params">t</span>(<span class="hljs-params"><span class="hljs-number">128</span>|<span class="hljs-number">63</span>&amp;e</span>);<span class="hljs-params">return</span>}<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">`Unrecognized Unicode codepoint: <span class="hljs-subst">${e.toString(<span class="hljs-number">16</span>)}</span>`</span></span>)}(<span class="hljs-params">s,t</span>)}}(<span class="hljs-params">r,e=&gt;s.push(e</span>)),<span class="hljs-params">new</span> <span class="hljs-params">Uint8Array</span>(<span class="hljs-params">s</span>))))<span class="hljs-params">throw</span> <span class="hljs-params">new</span> <span class="hljs-params">te</span>(<span class="hljs-params"><span class="hljs-string">"Invalid JWT signature"</span></span>);<span class="hljs-params">return</span>{<span class="hljs-params">data</span>:{<span class="hljs-params">claims</span>:<span class="hljs-params">a</span>,<span class="hljs-params">header</span>:<span class="hljs-params">n</span>,<span class="hljs-params">signature</span>:<span class="hljs-params">o</span>},<span class="hljs-params">error</span>:<span class="hljs-params">null</span>}}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">if</span>(<span class="hljs-params">eZ(e</span>))<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">_returnResult</span>(<span class="hljs-params">{data:<span class="hljs-literal">null</span>,error:e}</span>);<span class="hljs-params">throw</span> <span class="hljs-params">e</span>}}}<span class="hljs-params">t0</span>.<span class="hljs-params">nextInstanceID</span>={};<span class="hljs-params">let</span> <span class="hljs-params">t1</span>=<span class="hljs-params">t0</span>;<span class="hljs-params">class</span> <span class="hljs-params">t8</span> <span class="hljs-params">extends</span> <span class="hljs-params">t1</span>{<span class="hljs-params">constructor</span>(<span class="hljs-params">e</span>){<span class="hljs-params">super</span>(<span class="hljs-params">e</span>)}}(<span class="hljs-params"><span class="hljs-keyword">function</span>(</span>){<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-string">"undefined"</span>==<span class="hljs-keyword">typeof</span> process</span>)<span class="hljs-params">return</span>!1;<span class="hljs-params">let</span> <span class="hljs-params">e</span>=<span class="hljs-params">process</span>.<span class="hljs-params">version</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==e</span>)<span class="hljs-params">return</span>!1;<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">e</span>.<span class="hljs-params">match</span>(<span class="hljs-params"><span class="hljs-regexp">/^v(\d+)\./</span></span>);<span class="hljs-params">return</span>!!<span class="hljs-params">t</span>&amp;&amp;18&gt;=<span class="hljs-params">parseInt</span>(<span class="hljs-params">t[<span class="hljs-number">1</span>],<span class="hljs-number">10</span></span>)})<span class="hljs-params">()</span>&amp;&amp;<span class="hljs-params">console</span>.<span class="hljs-params">warn</span>(<span class="hljs-params"><span class="hljs-string">`  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217`</span></span>);<span class="hljs-params">let</span> <span class="hljs-params">t2</span>=(<span class="hljs-params">t=process.env.SUPABASE_SERVICE_ROLE_KEY,<span class="hljs-keyword">new</span> class e{constructor(e,t,r</span>){<span class="hljs-params">var</span> <span class="hljs-params">s</span>,<span class="hljs-params">i</span>,<span class="hljs-params">n</span>;<span class="hljs-params">this</span>.<span class="hljs-params">supabaseUrl</span>=<span class="hljs-params">e</span>,<span class="hljs-params">this</span>.<span class="hljs-params">supabaseKey</span>=<span class="hljs-params">t</span>;<span class="hljs-params">const</span> <span class="hljs-params">a</span>=<span class="hljs-params">function</span>(<span class="hljs-params">e</span>){<span class="hljs-params">let</span> <span class="hljs-params">t</span>=<span class="hljs-params">null</span>==<span class="hljs-params">e</span>?<span class="hljs-params">void</span> 0:<span class="hljs-params">e</span>.<span class="hljs-params">trim</span><span class="hljs-params">()</span>;<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"supabaseUrl is required."</span></span>);<span class="hljs-params">if</span>(<span class="hljs-params">!t.match(<span class="hljs-regexp">/^https?:\/\//i</span></span>))<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL."</span></span>);<span class="hljs-params">try</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params">t.endsWith(<span class="hljs-string">"/"</span></span>)?<span class="hljs-params">t</span>:<span class="hljs-params">t</span>+"/")}<span class="hljs-params">catch</span>(<span class="hljs-params">e</span>){<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"Invalid supabaseUrl: Provided URL is malformed."</span></span>)}}(<span class="hljs-params">e</span>);<span class="hljs-params">if</span>(<span class="hljs-params">!t</span>)<span class="hljs-params">throw</span> <span class="hljs-params">Error</span>(<span class="hljs-params"><span class="hljs-string">"supabaseKey is required."</span></span>);<span class="hljs-params">this</span>.<span class="hljs-params">realtimeUrl</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-string">"realtime/v1"</span>,a</span>),<span class="hljs-params">this</span>.<span class="hljs-params">realtimeUrl</span>.<span class="hljs-params">protocol</span>=<span class="hljs-params">this</span>.<span class="hljs-params">realtimeUrl</span>.<span class="hljs-params">protocol</span>.<span class="hljs-params">replace</span>(<span class="hljs-params"><span class="hljs-string">"http"</span>,<span class="hljs-string">"ws"</span></span>),<span class="hljs-params">this</span>.<span class="hljs-params">authUrl</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-string">"auth/v1"</span>,a</span>),<span class="hljs-params">this</span>.<span class="hljs-params">storageUrl</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-string">"storage/v1"</span>,a</span>),<span class="hljs-params">this</span>.<span class="hljs-params">functionsUrl</span>=<span class="hljs-params">new</span> <span class="hljs-params">URL</span>(<span class="hljs-params"><span class="hljs-string">"functions/v1"</span>,a</span>);<span class="hljs-params">const</span> <span class="hljs-params">o</span>=`<span class="hljs-params">sb</span>-<span class="hljs-params">$</span>{<span class="hljs-params">a</span>.<span class="hljs-params">hostname</span>.<span class="hljs-params">split</span>(<span class="hljs-params"><span class="hljs-string">"."</span></span>)[0]}-<span class="hljs-params">auth</span>-<span class="hljs-params">token</span>`,<span class="hljs-params">l</span>=<span class="hljs-params">function</span>(<span class="hljs-params">e,t</span>){<span class="hljs-params">var</span> <span class="hljs-params">r</span>,<span class="hljs-params">s</span>;<span class="hljs-params">let</span>{<span class="hljs-params">db</span>:<span class="hljs-params">i</span>,<span class="hljs-params">auth</span>:<span class="hljs-params">n</span>,<span class="hljs-params">realtime</span>:<span class="hljs-params">a</span>,<span class="hljs-params">global</span>:<span class="hljs-params">o</span>}=<span class="hljs-params">e</span>,{<span class="hljs-params">db</span>:<span class="hljs-params">l</span>,<span class="hljs-params">auth</span>:<span class="hljs-params">h</span>,<span class="hljs-params">realtime</span>:<span class="hljs-params">u</span>,<span class="hljs-params">global</span>:<span class="hljs-params">c</span>}=<span class="hljs-params">t</span>,<span class="hljs-params">d</span>={<span class="hljs-params">db</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},l</span>),<span class="hljs-params">i</span>),<span class="hljs-params">auth</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},h</span>),<span class="hljs-params">n</span>),<span class="hljs-params">realtime</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},u</span>),<span class="hljs-params">a</span>),<span class="hljs-params">storage</span>:{},<span class="hljs-params">global</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},c</span>),<span class="hljs-params">o</span>),{<span class="hljs-params">headers</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({},<span class="hljs-literal">null</span>!=(r=<span class="hljs-literal">null</span>==c?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:c.headers</span>)?<span class="hljs-params">r</span>:{}),<span class="hljs-params">null</span>!=(<span class="hljs-params">s=<span class="hljs-literal">null</span>==o?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:o.headers</span>)?<span class="hljs-params">s</span>:{})}),<span class="hljs-params">accessToken</span>:<span class="hljs-params">async</span><span class="hljs-params">()</span>=&gt;</span><span class="hljs-string">""</span>};<span class="hljs-keyword">return</span> e.accessToken?d.accessToken=e.accessToken:<span class="hljs-keyword">delete</span> d.accessToken,d}(<span class="hljs-literal">null</span>!=r?r:{},{<span class="hljs-attr">db</span>:eH,<span class="hljs-attr">realtime</span>:eJ,<span class="hljs-attr">auth</span>:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},eM),{<span class="hljs-attr">storageKey</span>:o}),<span class="hljs-attr">global</span>:eV});<span class="hljs-keyword">this</span>.storageKey=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">s=l.auth.storageKey</span>)?<span class="hljs-params">s</span>:"",<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>=<span class="hljs-params">null</span>!=(<span class="hljs-params">i=l.global.headers</span>)?<span class="hljs-params">i</span>:{},<span class="hljs-params">l</span>.<span class="hljs-params">accessToken</span>?(<span class="hljs-params"><span class="hljs-keyword">this</span>.accessToken=l.accessToken,<span class="hljs-keyword">this</span>.auth=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({},{get:(e,t</span>)=&gt;</span>{<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.<span class="hljs-subst">${<span class="hljs-built_in">String</span>(t)}</span> is not possible`</span>)}})):<span class="hljs-keyword">this</span>.auth=<span class="hljs-keyword">this</span>._initSupabaseAuthClient(<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">n=l.auth</span>)?<span class="hljs-params">n</span>:{},<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>,<span class="hljs-params">l</span>.<span class="hljs-params">global</span>.<span class="hljs-params">fetch</span>),<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>=(<span class="hljs-params">(e,t,r</span>)=&gt;</span>{<span class="hljs-keyword">let</span> s=r?<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>r(...e):<span class="hljs-function">(<span class="hljs-params">...e</span>)=&gt;</span>fetch(...e),i=Headers;<span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span>(r,n)=&gt;{<span class="hljs-keyword">var</span> a;<span class="hljs-keyword">let</span> o=<span class="hljs-literal">null</span>!=<span class="hljs-function">(<span class="hljs-params">a=<span class="hljs-keyword">await</span> t(</span>))?<span class="hljs-params">a</span>:<span class="hljs-params">e</span>,<span class="hljs-params">l</span>=<span class="hljs-params">new</span> <span class="hljs-params">i</span>(<span class="hljs-params"><span class="hljs-literal">null</span>==n?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:n.headers</span>);<span class="hljs-params">return</span> <span class="hljs-params">l</span>.<span class="hljs-params">has</span>(<span class="hljs-params"><span class="hljs-string">"apikey"</span></span>)||<span class="hljs-params">l</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"apikey"</span>,e</span>),<span class="hljs-params">l</span>.<span class="hljs-params">has</span>(<span class="hljs-params"><span class="hljs-string">"Authorization"</span></span>)||<span class="hljs-params">l</span>.<span class="hljs-params">set</span>(<span class="hljs-params"><span class="hljs-string">"Authorization"</span>,<span class="hljs-string">`Bearer <span class="hljs-subst">${o}</span>`</span></span>),<span class="hljs-params">s</span>(<span class="hljs-params">r,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},n</span>),{<span class="hljs-params">headers</span>:<span class="hljs-params">l</span>}))}})(<span class="hljs-params">t,<span class="hljs-keyword">this</span>._getAccessToken.bind(<span class="hljs-keyword">this</span></span>),<span class="hljs-params">l</span>.<span class="hljs-params">global</span>.<span class="hljs-params">fetch</span>),<span class="hljs-params">this</span>.<span class="hljs-params">realtime</span>=<span class="hljs-params">this</span>.<span class="hljs-params">_initRealtimeClient</span>(<span class="hljs-params"><span class="hljs-built_in">Object</span>.assign({headers:<span class="hljs-keyword">this</span>.headers,accessToken:<span class="hljs-keyword">this</span>._getAccessToken.bind(<span class="hljs-keyword">this</span></span>)},<span class="hljs-params">l</span>.<span class="hljs-params">realtime</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">accessToken</span>&amp;&amp;<span class="hljs-params">this</span>.<span class="hljs-params">accessToken</span><span class="hljs-params">()</span>.<span class="hljs-params">then</span>(<span class="hljs-params">e=&gt;<span class="hljs-keyword">this</span>.realtime.setAuth(e</span>)).<span class="hljs-params">catch</span>(<span class="hljs-params">e=&gt;<span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Failed to set initial Realtime auth token:"</span>,e</span>)),<span class="hljs-params">this</span>.<span class="hljs-params">rest</span>=<span class="hljs-params">new</span> <span class="hljs-params">C</span>(<span class="hljs-params"><span class="hljs-keyword">new</span> URL(<span class="hljs-string">"rest/v1"</span>,a</span>).<span class="hljs-params">href</span>,{<span class="hljs-params">headers</span>:<span class="hljs-params">this</span>.<span class="hljs-params">headers</span>,<span class="hljs-params">schema</span>:<span class="hljs-params">l</span>.<span class="hljs-params">db</span>.<span class="hljs-params">schema</span>,<span class="hljs-params">fetch</span>:<span class="hljs-params">this</span>.<span class="hljs-params">fetch</span>}),<span class="hljs-params">this</span>.<span class="hljs-params">storage</span>=<span class="hljs-params">new</span> <span class="hljs-params">eK</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.storageUrl.href,<span class="hljs-keyword">this</span>.headers,<span class="hljs-keyword">this</span>.fetch,<span class="hljs-literal">null</span>==r?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:r.storage</span>),<span class="hljs-params">l</span>.<span class="hljs-params">accessToken</span>||<span class="hljs-params">this</span>.<span class="hljs-params">_listenForAuthEvents</span><span class="hljs-params">()</span>}<span class="hljs-params">get</span> <span class="hljs-params">functions</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">I</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.functionsUrl.href,{headers:<span class="hljs-keyword">this</span>.headers,customFetch:<span class="hljs-keyword">this</span>.fetch}</span>)}<span class="hljs-params">from</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">rest</span>.<span class="hljs-params">from</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">schema</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">rest</span>.<span class="hljs-params">schema</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">rpc</span>(<span class="hljs-params">e,t={},r={head:!<span class="hljs-number">1</span>,get:!<span class="hljs-number">1</span>,count:<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>}</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">rest</span>.<span class="hljs-params">rpc</span>(<span class="hljs-params">e,t,r</span>)}<span class="hljs-params">channel</span>(<span class="hljs-params">e,t={config:{}}</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">realtime</span>.<span class="hljs-params">channel</span>(<span class="hljs-params">e,t</span>)}<span class="hljs-params">getChannels</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">realtime</span>.<span class="hljs-params">getChannels</span><span class="hljs-params">()</span>}<span class="hljs-params">removeChannel</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">realtime</span>.<span class="hljs-params">removeChannel</span>(<span class="hljs-params">e</span>)}<span class="hljs-params">removeAllChannels</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">realtime</span>.<span class="hljs-params">removeAllChannels</span><span class="hljs-params">()</span>}<span class="hljs-params">async</span> <span class="hljs-params">_getAccessToken</span><span class="hljs-params">()</span>{<span class="hljs-params">var</span> <span class="hljs-params">e</span>,<span class="hljs-params">t</span>;<span class="hljs-params">if</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.accessToken</span>)<span class="hljs-params">return</span> <span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">accessToken</span><span class="hljs-params">()</span>;<span class="hljs-params">let</span>{<span class="hljs-params">data</span>:<span class="hljs-params">r</span>}=<span class="hljs-params">await</span> <span class="hljs-params">this</span>.<span class="hljs-params">auth</span>.<span class="hljs-params">getSession</span><span class="hljs-params">()</span>;<span class="hljs-params">return</span> <span class="hljs-params">null</span>!=(<span class="hljs-params">t=<span class="hljs-literal">null</span>==(e=r.session</span>)?<span class="hljs-params">void</span> 0:<span class="hljs-params">e</span>.<span class="hljs-params">access_token</span>)?<span class="hljs-params">t</span>:<span class="hljs-params">this</span>.<span class="hljs-params">supabaseKey</span>}<span class="hljs-params">_initSupabaseAuthClient</span>(<span class="hljs-params">{autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:n,flowType:a,lock:o,debug:l,throwOnError:h},u,c</span>){<span class="hljs-params">let</span> <span class="hljs-params">d</span>={<span class="hljs-params">Authorization</span>:`<span class="hljs-params">Bearer</span> <span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">supabaseKey</span>}`,<span class="hljs-params">apikey</span>:`<span class="hljs-params">$</span>{<span class="hljs-params">this</span>.<span class="hljs-params">supabaseKey</span>}`};<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">t8</span>(<span class="hljs-params">{url:<span class="hljs-keyword">this</span>.authUrl.href,headers:<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},d</span>),<span class="hljs-params">u</span>),<span class="hljs-params">storageKey</span>:<span class="hljs-params">n</span>,<span class="hljs-params">autoRefreshToken</span>:<span class="hljs-params">e</span>,<span class="hljs-params">persistSession</span>:<span class="hljs-params">t</span>,<span class="hljs-params">detectSessionInUrl</span>:<span class="hljs-params">r</span>,<span class="hljs-params">storage</span>:<span class="hljs-params">s</span>,<span class="hljs-params">userStorage</span>:<span class="hljs-params">i</span>,<span class="hljs-params">flowType</span>:<span class="hljs-params">a</span>,<span class="hljs-params">lock</span>:<span class="hljs-params">o</span>,<span class="hljs-params">debug</span>:<span class="hljs-params">l</span>,<span class="hljs-params">throwOnError</span>:<span class="hljs-params">h</span>,<span class="hljs-params">fetch</span>:<span class="hljs-params">c</span>,<span class="hljs-params">hasCustomAuthorizationHeader</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">keys</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.headers</span>).<span class="hljs-params">some</span>(<span class="hljs-params">e=&gt;<span class="hljs-string">"authorization"</span>===e.toLowerCase(</span>))})}<span class="hljs-params">_initRealtimeClient</span>(<span class="hljs-params">e</span>){<span class="hljs-params">return</span> <span class="hljs-params">new</span> <span class="hljs-params">en</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.realtimeUrl.href,<span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">Object</span>.assign({},e</span>),{<span class="hljs-params">params</span>:<span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{apikey:<span class="hljs-keyword">this</span>.supabaseKey},<span class="hljs-literal">null</span>==e?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:e.params</span>)}))}<span class="hljs-params">_listenForAuthEvents</span><span class="hljs-params">()</span>{<span class="hljs-params">return</span> <span class="hljs-params">this</span>.<span class="hljs-params">auth</span>.<span class="hljs-params">onAuthStateChange</span>(<span class="hljs-params">(e,t</span>)=&gt;</span>{<span class="hljs-keyword">this</span>._handleTokenChanged(e,<span class="hljs-string">"CLIENT"</span>,<span class="hljs-literal">null</span>==t?<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>:t.access_token)})}_handleTokenChanged(e,t,r){(<span class="hljs-string">"TOKEN_REFRESHED"</span>===e||<span class="hljs-string">"SIGNED_IN"</span>===e)&amp;&amp;<span class="hljs-keyword">this</span>.changedAccessToken!==r?(<span class="hljs-keyword">this</span>.changedAccessToken=r,<span class="hljs-keyword">this</span>.realtime.setAuth(r)):<span class="hljs-string">"SIGNED_OUT"</span>===e&amp;&amp;(<span class="hljs-keyword">this</span>.realtime.setAuth(),<span class="hljs-string">"STORAGE"</span>==t&amp;&amp;<span class="hljs-keyword">this</span>.auth.signOut(),<span class="hljs-keyword">this</span>.changedAccessToken=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>)}}(<span class="hljs-string">"https://szktmfshrduqvvzyigrb.supabase.co"</span>,t,{<span class="hljs-attr">auth</span>:{<span class="hljs-attr">autoRefreshToken</span>:!<span class="hljs-number">1</span>,<span class="hljs-attr">persistSession</span>:!<span class="hljs-number">1</span>}}));e.s([<span class="hljs-string">"supabaseAdmin"</span>,<span class="hljs-number">0</span>,t2],<span class="hljs-number">1950</span>)}];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="sourcemappingurl8ae89d56..js.map">
  <h1>
    <a href="#sourcemappingurl8ae89d56..js.map" name="sourcemappingurl8ae89d56..js.map" class="pilcrow"></a>
sourceMappingURL=<em>8ae89d56.</em>.js.map
  </h1>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"></pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
